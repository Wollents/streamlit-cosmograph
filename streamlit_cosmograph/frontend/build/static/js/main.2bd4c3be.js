/*! For license information please see main.2bd4c3be.js.LICENSE.txt */
(()=>{"use strict";var t={43:(t,e,n)=>{t.exports=n(202)},123:t=>{var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(r){return!1}}()?Object.assign:function(t,r){for(var o,s,a=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){for(var l in o=Object(arguments[u]))n.call(o,l)&&(a[l]=o[l]);if(e){s=e(o);for(var c=0;c<s.length;c++)i.call(o,s[c])&&(a[s[c]]=o[s[c]])}}return a}},202:(t,e,n)=>{var i=n(123),r="function"===typeof Symbol&&Symbol.for,o=r?Symbol.for("react.element"):60103,s=r?Symbol.for("react.portal"):60106,a=r?Symbol.for("react.fragment"):60107,u=r?Symbol.for("react.strict_mode"):60108,l=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,h=r?Symbol.for("react.context"):60110,f=r?Symbol.for("react.forward_ref"):60112,d=r?Symbol.for("react.suspense"):60113,p=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,y="function"===typeof Symbol&&Symbol.iterator;function v(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g={};function x(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||b}function w(){}function _(t,e,n){this.props=t,this.context=e,this.refs=g,this.updater=n||b}x.prototype.isReactComponent={},x.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error(v(85));this.updater.enqueueSetState(this,t,e,"setState")},x.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},w.prototype=x.prototype;var S=_.prototype=new w;S.constructor=_,i(S,x.prototype),S.isPureReactComponent=!0;var A={current:null},T=Object.prototype.hasOwnProperty,I={key:!0,ref:!0,__self:!0,__source:!0};function C(t,e,n){var i,r={},s=null,a=null;if(null!=e)for(i in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)T.call(e,i)&&!I.hasOwnProperty(i)&&(r[i]=e[i]);var u=arguments.length-2;if(1===u)r.children=n;else if(1<u){for(var l=Array(u),c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in u=t.defaultProps)void 0===r[i]&&(r[i]=u[i]);return{$$typeof:o,type:t,key:s,ref:a,props:r,_owner:A.current}}function P(t){return"object"===typeof t&&null!==t&&t.$$typeof===o}var k=/\/+/g,z=[];function D(t,e,n,i){if(z.length){var r=z.pop();return r.result=t,r.keyPrefix=e,r.func=n,r.context=i,r.count=0,r}return{result:t,keyPrefix:e,func:n,context:i,count:0}}function O(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>z.length&&z.push(t)}function F(t,e,n,i){var r=typeof t;"undefined"!==r&&"boolean"!==r||(t=null);var a=!1;if(null===t)a=!0;else switch(r){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case o:case s:a=!0}}if(a)return n(i,t,""===e?"."+B(t,0):e),1;if(a=0,e=""===e?".":e+":",Array.isArray(t))for(var u=0;u<t.length;u++){var l=e+B(r=t[u],u);a+=F(r,l,n,i)}else if(null===t||"object"!==typeof t?l=null:l="function"===typeof(l=y&&t[y]||t["@@iterator"])?l:null,"function"===typeof l)for(t=l.call(t),u=0;!(r=t.next()).done;)a+=F(r=r.value,l=e+B(r,u++),n,i);else if("object"===r)throw n=""+t,Error(v(31,"[object Object]"===n?"object with keys {"+Object.keys(t).join(", ")+"}":n,""));return a}function M(t,e,n){return null==t?0:F(t,"",e,n)}function B(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))}(t.key):e.toString(36)}function E(t,e){t.func.call(t.context,e,t.count++)}function L(t,e,n){var i=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?N(t,i,n,(function(t){return t})):null!=t&&(P(t)&&(t=function(t,e){return{$$typeof:o,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(k,"$&/")+"/")+n)),i.push(t))}function N(t,e,n,i,r){var o="";null!=n&&(o=(""+n).replace(k,"$&/")+"/"),M(t,L,e=D(e,o,i,r)),O(e)}var j={current:null};function R(){var t=j.current;if(null===t)throw Error(v(321));return t}var V={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:A,IsSomeRendererActing:{current:!1},assign:i};e.PureComponent=_},219:(t,e,n)=>{var i=n(763),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function u(t){return i.isMemo(t)?s:a[t.$$typeof]||r}a[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[i.Memo]=s;var l=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;t.exports=function t(e,n,i){if("string"!==typeof n){if(p){var r=d(n);r&&r!==p&&t(e,r,i)}var s=c(n);h&&(s=s.concat(h(n)));for(var a=u(e),m=u(n),y=0;y<s.length;++y){var v=s[y];if(!o[v]&&(!i||!i[v])&&(!m||!m[v])&&(!a||!a[v])){var b=f(n,v);try{l(e,v,b)}catch(g){}}}}return e}},763:(t,e,n)=>{t.exports=n(983)},983:(t,e)=>{var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,y=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,b=n?Symbol.for("react.fundamental"):60117,g=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case i:switch(t=t.type){case c:case h:case o:case a:case s:case d:return t;default:switch(t=t&&t.$$typeof){case l:case f:case y:case m:case u:return t;default:return e}}case r:return e}}}function _(t){return w(t)===h}e.AsyncMode=c,e.ConcurrentMode=h,e.ContextConsumer=l,e.ContextProvider=u,e.Element=i,e.ForwardRef=f,e.Fragment=o,e.Lazy=y,e.Memo=m,e.Portal=r,e.Profiler=a,e.StrictMode=s,e.Suspense=d,e.isAsyncMode=function(t){return _(t)||w(t)===c},e.isConcurrentMode=_,e.isContextConsumer=function(t){return w(t)===l},e.isContextProvider=function(t){return w(t)===u},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===i},e.isForwardRef=function(t){return w(t)===f},e.isFragment=function(t){return w(t)===o},e.isLazy=function(t){return w(t)===y},e.isMemo=function(t){return w(t)===m},e.isPortal=function(t){return w(t)===r},e.isProfiler=function(t){return w(t)===a},e.isStrictMode=function(t){return w(t)===s},e.isSuspense=function(t){return w(t)===d},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===o||t===h||t===a||t===s||t===d||t===p||"object"===typeof t&&null!==t&&(t.$$typeof===y||t.$$typeof===m||t.$$typeof===u||t.$$typeof===l||t.$$typeof===f||t.$$typeof===b||t.$$typeof===g||t.$$typeof===x||t.$$typeof===v)},e.typeOf=w}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}var i="http://www.w3.org/1999/xhtml";const r={svg:"http://www.w3.org/2000/svg",xhtml:i,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function o(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),r.hasOwnProperty(e)?{space:r[e],local:t}:t}function s(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===i&&e.documentElement.namespaceURI===i?e.createElement(t):e.createElementNS(n,t)}}function a(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function u(t){var e=o(t);return(e.local?a:s)(e)}function l(){}function c(t){return null==t?l:function(){return this.querySelector(t)}}function h(){return[]}function f(t){return null==t?h:function(){return this.querySelectorAll(t)}}function d(t){return function(){return function(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}function p(t){return function(){return this.matches(t)}}function m(t){return function(e){return e.matches(t)}}var y=Array.prototype.find;function v(){return this.firstElementChild}var b=Array.prototype.filter;function g(){return Array.from(this.children)}function x(t){return new Array(t.length)}function w(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function _(t,e,n,i,r,o){for(var s,a=0,u=e.length,l=o.length;a<l;++a)(s=e[a])?(s.__data__=o[a],i[a]=s):n[a]=new w(t,o[a]);for(;a<u;++a)(s=e[a])&&(r[a]=s)}function S(t,e,n,i,r,o,s){var a,u,l,c=new Map,h=e.length,f=o.length,d=new Array(h);for(a=0;a<h;++a)(u=e[a])&&(d[a]=l=s.call(u,u.__data__,a,e)+"",c.has(l)?r[a]=u:c.set(l,u));for(a=0;a<f;++a)l=s.call(t,o[a],a,o)+"",(u=c.get(l))?(i[a]=u,u.__data__=o[a],c.delete(l)):n[a]=new w(t,o[a]);for(a=0;a<h;++a)(u=e[a])&&c.get(d[a])===u&&(r[a]=u)}function A(t){return t.__data__}function T(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function I(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function C(t){return function(){this.removeAttribute(t)}}function P(t){return function(){this.removeAttributeNS(t.space,t.local)}}function k(t,e){return function(){this.setAttribute(t,e)}}function z(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function D(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function O(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function F(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function M(t){return function(){this.style.removeProperty(t)}}function B(t,e,n){return function(){this.style.setProperty(t,e,n)}}function E(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function L(t,e){return t.style.getPropertyValue(e)||F(t).getComputedStyle(t,null).getPropertyValue(e)}function N(t){return function(){delete this[t]}}function j(t,e){return function(){this[t]=e}}function R(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function V(t){return t.trim().split(/^|\s+/)}function U(t){return t.classList||new $(t)}function $(t){this._node=t,this._names=V(t.getAttribute("class")||"")}function W(t,e){for(var n=U(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function q(t,e){for(var n=U(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function G(t){return function(){W(this,t)}}function H(t){return function(){q(this,t)}}function Y(t,e){return function(){(e.apply(this,arguments)?W:q)(this,t)}}function X(){this.textContent=""}function Z(t){return function(){this.textContent=t}}function K(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Q(){this.innerHTML=""}function J(t){return function(){this.innerHTML=t}}function tt(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function et(){this.nextSibling&&this.parentNode.appendChild(this)}function nt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function it(){return null}function rt(){var t=this.parentNode;t&&t.removeChild(this)}function ot(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function st(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function at(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.options);++r?e.length=r:delete this.__on}}}function ut(t,e,n){return function(){var i,r=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(r)for(var s=0,a=r.length;s<a;++s)if((i=r[s]).type===t.type&&i.name===t.name)return this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),void(i.value=e);this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function lt(t,e,n){var i=F(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function ct(t,e){return function(){return lt(this,t,e)}}function ht(t,e){return function(){return lt(this,t,e.apply(this,arguments))}}w.prototype={constructor:w,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},$.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var ft=[null];function dt(t,e){this._groups=t,this._parents=e}function pt(){return new dt([[document.documentElement]],ft)}function mt(t){return"string"==typeof t?new dt([[document.querySelector(t)]],[document.documentElement]):new dt([[t]],ft)}function yt(t,e){if(t=function(t){let e;for(;e=t.sourceEvent;)t=e;return t}(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}dt.prototype=pt.prototype={constructor:dt,select:function(t){"function"!=typeof t&&(t=c(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s,a=e[r],u=a.length,l=i[r]=new Array(u),h=0;h<u;++h)(o=a[h])&&(s=t.call(o,o.__data__,h,a))&&("__data__"in o&&(s.__data__=o.__data__),l[h]=s);return new dt(i,this._parents)},selectAll:function(t){t="function"==typeof t?d(t):f(t);for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var s,a=e[o],u=a.length,l=0;l<u;++l)(s=a[l])&&(i.push(t.call(s,s.__data__,l,a)),r.push(s));return new dt(i,r)},selectChild:function(t){return this.select(null==t?v:function(t){return function(){return y.call(this.children,t)}}("function"==typeof t?t:m(t)))},selectChildren:function(t){return this.selectAll(null==t?g:function(t){return function(){return b.call(this.children,t)}}("function"==typeof t?t:m(t)))},filter:function(t){"function"!=typeof t&&(t=p(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,u=i[r]=[],l=0;l<a;++l)(o=s[l])&&t.call(o,o.__data__,l,s)&&u.push(o);return new dt(i,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,A);var n=e?S:_,i=this._parents,r=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=r.length,s=new Array(o),a=new Array(o),u=new Array(o),l=0;l<o;++l){var c=i[l],h=r[l],f=h.length,d=T(t.call(c,c&&c.__data__,l,i)),p=d.length,m=a[l]=new Array(p),y=s[l]=new Array(p);n(c,h,m,y,u[l]=new Array(f),d,e);for(var v,b,g=0,x=0;g<p;++g)if(v=m[g]){for(g>=x&&(x=g+1);!(b=y[x])&&++x<p;);v._next=b||null}}return(s=new dt(s,i))._enter=a,s._exit=u,s},enter:function(){return new dt(this._enter||this._groups.map(x),this._parents)},exit:function(){return new dt(this._exit||this._groups.map(x),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit();return"function"==typeof t?(i=t(i))&&(i=i.selection()):i=i.append(t+""),null!=e&&((r=e(r))&&(r=r.selection())),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,o=i.length,s=Math.min(r,o),a=new Array(r),u=0;u<s;++u)for(var l,c=n[u],h=i[u],f=c.length,d=a[u]=new Array(f),p=0;p<f;++p)(l=c[p]||h[p])&&(d[p]=l);for(;u<r;++u)a[u]=n[u];return new dt(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,s=r[o];--o>=0;)(i=r[o])&&(s&&4^i.compareDocumentPosition(s)&&s.parentNode.insertBefore(i,s),s=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=I);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var s,a=n[o],u=a.length,l=r[o]=new Array(u),c=0;c<u;++c)(s=a[c])&&(l[c]=s);l.sort(e)}return new dt(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],s=0,a=o.length;s<a;++s)(r=o[s])&&t.call(r,r.__data__,s,o);return this},attr:function(t,e){var n=o(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?P:C:"function"==typeof e?n.local?O:D:n.local?z:k)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?M:"function"==typeof e?E:B)(t,e,n??"")):L(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?N:"function"==typeof e?R:j)(t,e)):this.node()[t]},classed:function(t,e){var n=V(t+"");if(arguments.length<2){for(var i=U(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?Y:e?G:H)(n,e))},text:function(t){return arguments.length?this.each(null==t?X:("function"==typeof t?K:Z)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Q:("function"==typeof t?tt:J)(t)):this.node().innerHTML},raise:function(){return this.each(et)},lower:function(){return this.each(nt)},append:function(t){var e="function"==typeof t?t:u(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:u(t),i=null==e?it:"function"==typeof e?e:c(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(rt)},clone:function(t){return this.select(t?st:ot)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?ut:at,i=0;i<s;++i)this.each(a(o[i],e,n));return this}var a=this.node().__on;if(a)for(var u,l=0,c=a.length;l<c;++l)for(i=0,u=a[l];i<s;++i)if((r=o[i]).type===u.type&&r.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?ht:ct)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i,r=t[e],o=0,s=r.length;o<s;++o)(i=r[o])&&(yield i)}};var vt={value:()=>{}};function bt(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new gt(i)}function gt(t){this._=t}function xt(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function wt(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=vt,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}gt.prototype=bt.prototype={constructor:gt,on:function(t,e){var n,i=this._,r=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}(t+"",i),o=-1,s=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=r[o]).type)i[n]=wt(i[n],t.name,e);else if(null==e)for(n in i)i[n]=wt(i[n],t.name,null);return this}for(;++o<s;)if((n=(t=r[o]).type)&&(n=xt(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new gt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var _t,St,At=0,Tt=0,It=0,Ct=0,Pt=0,kt=0,zt="object"==typeof performance&&performance.now?performance:Date,Dt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ot(){return Pt||(Dt(Ft),Pt=zt.now()+kt)}function Ft(){Pt=0}function Mt(){this._call=this._time=this._next=null}function Bt(t,e,n){var i=new Mt;return i.restart(t,e,n),i}function Et(){Pt=(Ct=zt.now())+kt,At=Tt=0;try{!function(){Ot(),++At;for(var t,e=_t;e;)(t=Pt-e._time)>=0&&e._call.call(null,t),e=e._next;--At}()}finally{At=0,function(){for(var t,e,n=_t,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:_t=e);St=t,Nt(i)}(),Pt=0}}function Lt(){var t=zt.now(),e=t-Ct;e>1e3&&(kt-=e,Ct=t)}function Nt(t){At||(Tt&&(Tt=clearTimeout(Tt)),t-Pt>24?(t<1/0&&(Tt=setTimeout(Et,t-zt.now()-kt)),It&&(It=clearInterval(It))):(It||(Ct=zt.now(),It=setInterval(Lt,1e3)),At=1,Dt(Et)))}function jt(t,e,n){var i=new Mt;return e=null==e?0:+e,i.restart((n=>{i.stop(),t(n+e)}),e,n),i}Mt.prototype=Bt.prototype={constructor:Mt,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Ot():+n)+(null==e?0:+e),!this._next&&St!==this&&(St?St._next=this:_t=this,St=this),this._call=t,this._time=n,Nt()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nt())}};var Rt=bt("start","end","cancel","interrupt"),Vt=[];function Ut(t,e,n,i,r,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function o(t){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=t&&s(t-n.delay)}function s(o){var l,c,h,f;if(1!==n.state)return u();for(l in r)if((f=r[l]).name===n.name){if(3===f.state)return jt(s);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete r[l]):+l<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete r[l])}if(jt((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(o))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),l=0,c=-1;l<h;++l)(f=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++c]=f);i.length=c+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(u),n.state=5,1),o=-1,s=i.length;++o<s;)i[o].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=Bt(o,0,n.time)}(t,n,{name:e,index:i,group:r,on:Rt,tween:Vt,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function $t(t,e){var n=qt(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Wt(t,e){var n=qt(t,e);if(n.state>3)throw new Error("too late; already running");return n}function qt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Gt(t,e){var n,i,r,o=t.__transition,s=!0;if(o){for(r in e=null==e?null:e+"",o)(n=o[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[r]):s=!1;s&&delete t.__transition}}function Ht(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Yt(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Xt(){}var Zt=.7,Kt=1/Zt,Qt="\\s*([+-]?\\d+)\\s*",Jt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",te="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ee=/^#([0-9a-f]{3,8})$/,ne=new RegExp(`^rgb\\(${Qt},${Qt},${Qt}\\)$`),ie=new RegExp(`^rgb\\(${te},${te},${te}\\)$`),re=new RegExp(`^rgba\\(${Qt},${Qt},${Qt},${Jt}\\)$`),oe=new RegExp(`^rgba\\(${te},${te},${te},${Jt}\\)$`),se=new RegExp(`^hsl\\(${Jt},${te},${te}\\)$`),ae=new RegExp(`^hsla\\(${Jt},${te},${te},${Jt}\\)$`),ue={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function le(){return this.rgb().formatHex()}function ce(){return this.rgb().formatRgb()}function he(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ee.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?fe(e):3===n?new me(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?de(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?de(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=ne.exec(t))?new me(e[1],e[2],e[3],1):(e=ie.exec(t))?new me(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=re.exec(t))?de(e[1],e[2],e[3],e[4]):(e=oe.exec(t))?de(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=se.exec(t))?we(e[1],e[2]/100,e[3]/100,1):(e=ae.exec(t))?we(e[1],e[2]/100,e[3]/100,e[4]):ue.hasOwnProperty(t)?fe(ue[t]):"transparent"===t?new me(NaN,NaN,NaN,0):null}function fe(t){return new me(t>>16&255,t>>8&255,255&t,1)}function de(t,e,n,i){return i<=0&&(t=e=n=NaN),new me(t,e,n,i)}function pe(t,e,n,i){return 1===arguments.length?function(t){return t instanceof Xt||(t=he(t)),t?new me((t=t.rgb()).r,t.g,t.b,t.opacity):new me}(t):new me(t,e,n,i??1)}function me(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function ye(){return`#${xe(this.r)}${xe(this.g)}${xe(this.b)}`}function ve(){const t=be(this.opacity);return`${1===t?"rgb(":"rgba("}${ge(this.r)}, ${ge(this.g)}, ${ge(this.b)}${1===t?")":`, ${t})`}`}function be(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ge(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function xe(t){return((t=ge(t))<16?"0":"")+t.toString(16)}function we(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Se(t,e,n,i)}function _e(t){if(t instanceof Se)return new Se(t.h,t.s,t.l,t.opacity);if(t instanceof Xt||(t=he(t)),!t)return new Se;if(t instanceof Se)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),s=NaN,a=o-r,u=(o+r)/2;return a?(s=e===o?(n-i)/a+6*(n<i):n===o?(i-e)/a+2:(e-n)/a+4,a/=u<.5?o+r:2-o-r,s*=60):a=u>0&&u<1?0:s,new Se(s,a,u,t.opacity)}function Se(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ae(t){return(t=(t||0)%360)<0?t+360:t}function Te(t){return Math.max(0,Math.min(1,t||0))}function Ie(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Ht(Xt,he,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:le,formatHex:le,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return _e(this).formatHsl()},formatRgb:ce,toString:ce}),Ht(me,pe,Yt(Xt,{brighter(t){return t=null==t?Kt:Math.pow(Kt,t),new me(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Zt:Math.pow(Zt,t),new me(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new me(ge(this.r),ge(this.g),ge(this.b),be(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ye,formatHex:ye,formatHex8:function(){return`#${xe(this.r)}${xe(this.g)}${xe(this.b)}${xe(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:ve,toString:ve})),Ht(Se,(function(t,e,n,i){return 1===arguments.length?_e(t):new Se(t,e,n,i??1)}),Yt(Xt,{brighter(t){return t=null==t?Kt:Math.pow(Kt,t),new Se(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Zt:Math.pow(Zt,t),new Se(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new me(Ie(t>=240?t-240:t+120,r,i),Ie(t,r,i),Ie(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new Se(Ae(this.h),Te(this.s),Te(this.l),be(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=be(this.opacity);return`${1===t?"hsl(":"hsla("}${Ae(this.h)}, ${100*Te(this.s)}%, ${100*Te(this.l)}%${1===t?")":`, ${t})`}`}}));const Ce=t=>()=>t;function Pe(t){return 1==(t=+t)?ke:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):Ce(isNaN(e)?n:e)}}function ke(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):Ce(isNaN(t)?e:t)}const ze=function t(e){var n=Pe(e);function i(t,e){var i=n((t=pe(t)).r,(e=pe(e)).r),r=n(t.g,e.g),o=n(t.b,e.b),s=ke(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=o(e),t.opacity=s(e),t+""}}return i.gamma=t,i}(1);function De(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(o){for(n=0;n<i;++n)r[n]=t[n]*(1-o)+e[n]*o;return r}}function Oe(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),s=new Array(i);for(n=0;n<r;++n)o[n]=je(t[n],e[n]);for(;n<i;++n)s[n]=e[n];return function(t){for(n=0;n<r;++n)s[n]=o[n](t);return s}}function Fe(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Me(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Be(t,e){var n,i={},r={};for(n in(null===t||"object"!=typeof t)&&(t={}),(null===e||"object"!=typeof e)&&(e={}),e)n in t?i[n]=je(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var Ee=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Le=new RegExp(Ee.source,"g");function Ne(t,e){var n,i,r,o=Ee.lastIndex=Le.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(n=Ee.exec(t))&&(i=Le.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),a[s]?a[s]+=r:a[++s]=r),(n=n[0])===(i=i[0])?a[s]?a[s]+=i:a[++s]=i:(a[++s]=null,u.push({i:s,x:Me(n,i)})),o=Le.lastIndex;return o<e.length&&(r=e.slice(o),a[s]?a[s]+=r:a[++s]=r),a.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,i=0;i<e;++i)a[(n=u[i]).i]=n.x(t);return a.join("")})}function je(t,e){var n,i=typeof e;return null==e||"boolean"===i?Ce(e):("number"===i?Me:"string"===i?(n=he(e))?(e=n,ze):Ne:e instanceof he?ze:e instanceof Date?Fe:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}(e)?De:Array.isArray(e)?Oe:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Be:Me)(t,e)}function Re(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Ve,Ue=180/Math.PI,$e={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function We(t,e,n,i,r,o){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*i)&&(n-=t*u,i-=e*u),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,u/=a),t*i<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*Ue,skewX:Math.atan(u)*Ue,scaleX:s,scaleY:a}}function qe(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],u=[];return o=t(o),s=t(s),function(t,i,r,o,s,a){if(t!==r||i!==o){var u=s.push("translate(",null,e,null,n);a.push({i:u-4,x:Me(t,r)},{i:u-2,x:Me(i,o)})}else(r||o)&&s.push("translate("+r+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:Me(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(o.rotate,s.rotate,a,u),function(t,e,n,o){t!==e?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:Me(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(o.skewX,s.skewX,a,u),function(t,e,n,i,o,s){if(t!==n||e!==i){var a=o.push(r(o)+"scale(",null,",",null,")");s.push({i:a-4,x:Me(t,n)},{i:a-2,x:Me(e,i)})}else(1!==n||1!==i)&&o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,u),o=s=null,function(t){for(var e,n=-1,i=u.length;++n<i;)a[(e=u[n]).i]=e.x(t);return a.join("")}}}var Ge=qe((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?$e:We(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),He=qe((function(t){return null!=t&&(Ve||(Ve=document.createElementNS("http://www.w3.org/2000/svg","g")),Ve.setAttribute("transform",t),t=Ve.transform.baseVal.consolidate())?We((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):$e}),", ",")",")");function Ye(t){return((t=Math.exp(t))+1/t)/2}const Xe=function t(e,n,i){function r(t,r){var o,s,a=t[0],u=t[1],l=t[2],c=r[0],h=r[1],f=r[2],d=c-a,p=h-u,m=d*d+p*p;if(m<1e-12)s=Math.log(f/l)/e,o=function(t){return[a+t*d,u+t*p,l*Math.exp(e*t*s)]};else{var y=Math.sqrt(m),v=(f*f-l*l+i*m)/(2*l*n*y),b=(f*f-l*l-i*m)/(2*f*n*y),g=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(b*b+1)-b);s=(x-g)/e,o=function(t){var i=t*s,r=Ye(g),o=l/(n*y)*(r*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*i+g)-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[a+o*d,u+o*p,l*r/Ye(e*i+g)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return r.rho=function(e){var n=Math.max(.001,+e),i=n*n;return t(n,i,i*i)},r}(Math.SQRT2,2,4);function Ze(t,e){var n,i;return function(){var r=Wt(this,t),o=r.tween;if(o!==n)for(var s=0,a=(i=n=o).length;s<a;++s)if(i[s].name===e){(i=i.slice()).splice(s,1);break}r.tween=i}}function Ke(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=Wt(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:e,value:n},u=0,l=r.length;u<l;++u)if(r[u].name===e){r[u]=a;break}u===l&&r.push(a)}o.tween=r}}function Qe(t,e,n){var i=t._id;return t.each((function(){var t=Wt(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return qt(t,i).value[e]}}function Je(t,e){var n;return("number"==typeof e?Me:e instanceof he?ze:(n=he(e))?(e=n,ze):Ne)(t,e)}function tn(t){return function(){this.removeAttribute(t)}}function en(t){return function(){this.removeAttributeNS(t.space,t.local)}}function nn(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===i?r:r=e(i=s,n)}}function rn(t,e,n){var i,r,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===i?r:r=e(i=s,n)}}function on(t,e,n){var i,r,o;return function(){var s,a,u=n(this);return null==u?void this.removeAttribute(t):(s=this.getAttribute(t))===(a=u+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,u))}}function sn(t,e,n){var i,r,o;return function(){var s,a,u=n(this);return null==u?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local))===(a=u+"")?null:s===i&&a===r?o:(r=a,o=e(i=s,u))}}function an(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,r)),n}return r._value=e,r}function un(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,r)),n}return r._value=e,r}function ln(t,e){return function(){$t(this,t).delay=+e.apply(this,arguments)}}function cn(t,e){return e=+e,function(){$t(this,t).delay=e}}function hn(t,e){return function(){Wt(this,t).duration=+e.apply(this,arguments)}}function fn(t,e){return e=+e,function(){Wt(this,t).duration=e}}var dn=pt.prototype.constructor;function pn(t){return function(){this.style.removeProperty(t)}}var mn=0;function yn(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function vn(){return++mn}var bn=pt.prototype;function gn(t){return t*t}function xn(t){return t*(2-t)}function wn(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}yn.prototype={constructor:yn,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=c(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a,u,l=i[s],h=l.length,f=o[s]=new Array(h),d=0;d<h;++d)(a=l[d])&&(u=t.call(a,a.__data__,d,l))&&("__data__"in a&&(u.__data__=a.__data__),f[d]=u,Ut(f[d],e,n,d,f,qt(a,n)));return new yn(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=f(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var u,l=i[a],c=l.length,h=0;h<c;++h)if(u=l[h]){for(var d,p=t.call(u,u.__data__,h,l),m=qt(u,n),y=0,v=p.length;y<v;++y)(d=p[y])&&Ut(d,e,n,y,p,m);o.push(p),s.push(u)}return new yn(o,s,e,n)},selectChild:bn.selectChild,selectChildren:bn.selectChildren,filter:function(t){"function"!=typeof t&&(t=p(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,s=e[r],a=s.length,u=i[r]=[],l=0;l<a;++l)(o=s[l])&&t.call(o,o.__data__,l,s)&&u.push(o);return new yn(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var u,l=e[a],c=n[a],h=l.length,f=s[a]=new Array(h),d=0;d<h;++d)(u=l[d]||c[d])&&(f[d]=u);for(;a<i;++a)s[a]=e[a];return new yn(s,this._parents,this._name,this._id)},selection:function(){return new dn(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=vn(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],u=a.length,l=0;l<u;++l)if(s=a[l]){var c=qt(s,e);Ut(s,t,n,l,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new yn(i,this._parents,t,n)},call:bn.call,nodes:bn.nodes,node:bn.node,size:bn.size,empty:bn.empty,each:bn.each,on:function(t,e){var n=this._id;return arguments.length<2?qt(this.node(),n).on.on(t):this.each(function(t,e,n){var i,r,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?$t:Wt;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(e,n),s.on=r}}(n,t,e))},attr:function(t,e){var n=o(t),i="transform"===n?He:Je;return this.attrTween(t,"function"==typeof e?(n.local?sn:on)(n,i,Qe(this,"attr."+t,e)):null==e?(n.local?en:tn)(n):(n.local?rn:nn)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=o(t);return this.tween(n,(i.local?an:un)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?Ge:Je;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var o=L(this,t),s=(this.style.removeProperty(t),L(this,t));return o===s?null:o===n&&s===i?r:r=e(n=o,i=s)}}(t,i)).on("end.style."+t,pn(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,o;return function(){var s=L(this,t),a=n(this),u=a+"";return null==a&&(this.style.removeProperty(t),u=a=L(this,t)),s===u?null:s===i&&u===r?o:(r=u,o=e(i=s,a))}}(t,i,Qe(this,"style."+t,e))).each(function(t,e){var n,i,r,o,s="style."+e,a="end."+s;return function(){var u=Wt(this,t),l=u.on,c=null==u.value[s]?o||(o=pn(e)):void 0;(l!==n||r!==c)&&(i=(n=l).copy()).on(a,r=c),u.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,o=n+"";return function(){var s=L(this,t);return s===o?null:s===i?r:r=e(i=s,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,function(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&function(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}(t,o,n)),i}return o._value=e,o}(t,e,n??""))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=e??""}}(Qe(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&function(t){return function(e){this.textContent=t.call(this,e)}}(i)),e}return i._value=t,i}(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=qt(this.node(),n).tween,o=0,s=r.length;o<s;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?Ze:Ke)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ln:cn)(e,t)):qt(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?hn:fn)(e,t)):qt(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Wt(this,t).ease=e}}(e,t)):qt(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;Wt(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(o,s){var a={value:s},u={value:function(){0===--r&&o()}};n.each((function(){var n=Wt(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),n.on=e})),0===r&&o()}))},[Symbol.iterator]:bn[Symbol.iterator]};var _n={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function Sn(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}pt.prototype.interrupt=function(t){return this.each((function(){Gt(this,t)}))},pt.prototype.transition=function(t){var e,n;t instanceof yn?(e=t._id,t=t._name):(e=vn(),(n=_n).time=Ot(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s,a=i[o],u=a.length,l=0;l<u;++l)(s=a[l])&&Ut(s,t,e,l,a,n||Sn(s,e));return new yn(i,this._parents,t,e)};var An=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function In(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var n=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})})),n}var Cn={exports:{}};Cn.exports=function(){var t=function(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array||t instanceof Uint8ClampedArray},e=function(t,e){for(var n=Object.keys(e),i=0;i<n.length;++i)t[n[i]]=e[n[i]];return t},n="\n";function i(t){return typeof atob<"u"?atob(t):"base64:"+t}function r(t){var e=new Error("(regl) "+t);throw console.error(e),e}function o(t,e){t||r(e)}function s(t){return t?": "+t:""}function a(t,e,n){t in e||r("unknown parameter ("+t+")"+s(n)+". possible values: "+Object.keys(e).join())}function u(e,n){t(e)||r("invalid parameter type"+s(n)+". must be a typed array")}function l(t,e){switch(e){case"number":return"number"==typeof t;case"object":return"object"==typeof t;case"string":return"string"==typeof t;case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"undefined":return typeof t>"u";case"symbol":return"symbol"==typeof t}}function c(t,e,n){l(t,e)||r("invalid parameter type"+s(n)+". expected "+e+", got "+typeof t)}function h(t,e){t>=0&&(0|t)===t||r("invalid parameter type, ("+t+")"+s(e)+". must be a nonnegative integer")}function f(t,e,n){e.indexOf(t)<0&&r("invalid value"+s(n)+". must be one of: "+e)}var d=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function p(t){Object.keys(t).forEach((function(t){d.indexOf(t)<0&&r('invalid regl constructor argument "'+t+'". must be one of '+d)}))}function m(t,e){for(t+="";t.length<e;)t=" "+t;return t}function y(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function v(t,e){this.number=t,this.line=e,this.errors=[]}function b(t,e,n){this.file=t,this.line=e,this.message=n}function g(){var t=new Error,e=(t.stack||t).toString(),n=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(e);if(n)return n[1];var i=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(e);return i?i[1]:"unknown"}function x(){var t=new Error,e=(t.stack||t).toString(),n=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(e);if(n)return n[1];var i=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(e);return i?i[1]:"unknown"}function w(t,e){var n=t.split("\n"),r=1,o=0,s={unknown:new y,0:new y};s.unknown.name=s[0].name=e||g(),s.unknown.lines.push(new v(0,""));for(var a=0;a<n.length;++a){var u=n[a],l=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(u);if(l)switch(l[1]){case"line":var c=/(\d+)(\s+\d+)?/.exec(l[2]);c&&(r=0|c[1],c[2]&&((o=0|c[2])in s||(s[o]=new y)));break;case"define":var h=/SHADER_NAME(_B64)?\s+(.*)$/.exec(l[2]);h&&(s[o].name=h[1]?i(h[2]):h[2])}s[o].lines.push(new v(r++,u))}return Object.keys(s).forEach((function(t){var e=s[t];e.lines.forEach((function(t){e.index[t.number]=t}))})),s}function _(t){var e=[];return t.split("\n").forEach((function(t){if(!(t.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(t);n?e.push(new b(0|n[1],0|n[2],n[3].trim())):t.length>0&&e.push(new b("unknown",0,t))}})),e}function S(t,e){e.forEach((function(e){var n=t[e.file];if(n){var i=n.index[e.line];if(i)return i.errors.push(e),void(n.hasErrors=!0)}t.unknown.hasErrors=!0,t.unknown.lines[0].errors.push(e)}))}function A(t,e,i,r,s){if(!t.getShaderParameter(e,t.COMPILE_STATUS)){var a=t.getShaderInfoLog(e),u=r===t.FRAGMENT_SHADER?"fragment":"vertex";D(i,"string",u+" shader source must be a string",s);var l=w(i,s),c=_(a);S(l,c),Object.keys(l).forEach((function(t){var e=l[t];if(e.hasErrors){var i=[""],r=[""];o("file number "+t+": "+e.name+"\n","color:red;text-decoration:underline;font-weight:bold"),e.lines.forEach((function(t){if(t.errors.length>0){o(m(t.number,4)+"|  ","background-color:yellow; font-weight:bold"),o(t.line+n,"color:red; background-color:yellow; font-weight:bold");var e=0;t.errors.forEach((function(i){var r=i.message,s=/^\s*'(.*)'\s*:\s*(.*)$/.exec(r);if(s){var a=s[1];"assign"===(r=s[2],a)&&(a="="),e=Math.max(t.line.indexOf(a,e),0)}else e=0;o(m("| ",6)),o(m("^^^",e+3)+n,"font-weight:bold"),o(m("| ",6)),o(r+n,"font-weight:bold")})),o(m("| ",6)+n)}else o(m(t.number,4)+"|  "),o(t.line+n,"color:red")})),typeof document<"u"&&!window.chrome?(r[0]=i.join("%c"),console.log.apply(console,r)):console.log(i.join(""))}function o(t,e){i.push(t),r.push(e||"")}})),o.raise("Error compiling "+u+" shader, "+l[0].name)}}function T(t,e,i,r,s){if(!t.getProgramParameter(e,t.LINK_STATUS)){var a=t.getProgramInfoLog(e),u=w(i,s),l='Error linking program with vertex shader, "'+w(r,s)[0].name+'", and fragment shader "'+u[0].name+'"';typeof document<"u"?console.log("%c"+l+n+"%c"+a,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(l+n+a),o.raise(l)}}function I(t){t._commandRef=g()}function C(t,e,n,i){function r(t){return t?i.id(t):0}function o(t,e){Object.keys(e).forEach((function(e){t[i.id(e)]=!0}))}I(t),t._fragId=r(t.static.frag),t._vertId=r(t.static.vert);var s=t._uniformSet={};o(s,e.static),o(s,e.dynamic);var a=t._attributeSet={};o(a,n.static),o(a,n.dynamic),t._hasCount="count"in t.static||"count"in t.dynamic||"elements"in t.static||"elements"in t.dynamic}function P(t,e){var n=x();r(t+" in command "+(e||g())+("unknown"===n?"":" called from "+n))}function k(t,e,n){t||P(e,n||g())}function z(t,e,n,i){t in e||P("unknown parameter ("+t+")"+s(n)+". possible values: "+Object.keys(e).join(),i||g())}function D(t,e,n,i){l(t,e)||P("invalid parameter type"+s(n)+". expected "+e+", got "+typeof t,i||g())}function O(t){t()}function F(t,e,n){t.texture?f(t.texture._texture.internalformat,e,"unsupported texture format for attachment"):f(t.renderbuffer._renderbuffer.format,n,"unsupported renderbuffer format for attachment")}var M=33071,B=9728,E=9984,L=9985,N=9986,j=9987,R=5121,V=5122,U=5123,$=5124,W=5125,q=5126,G=32819,H=32820,Y=33635,X=34042,Z=36193,K={};function Q(t,e){return t===H||t===G||t===Y?2:t===X?4:K[t]*e}function J(t){return!(t&t-1)&&!!t}function tt(t,e,n){var i,r=e.width,s=e.height,a=e.channels;o(r>0&&r<=n.maxTextureSize&&s>0&&s<=n.maxTextureSize,"invalid texture shape"),(t.wrapS!==M||t.wrapT!==M)&&o(J(r)&&J(s),"incompatible wrap mode for texture, both width and height must be power of 2"),1===e.mipmask?1!==r&&1!==s&&o(t.minFilter!==E&&t.minFilter!==N&&t.minFilter!==L&&t.minFilter!==j,"min filter requires mipmap"):(o(J(r)&&J(s),"texture must be a square power of 2 to support mipmapping"),o(e.mipmask===(r<<1)-1,"missing or incomplete mipmap data")),e.type===q&&(n.extensions.indexOf("oes_texture_float_linear")<0&&o(t.minFilter===B&&t.magFilter===B,"filter not supported, must enable oes_texture_float_linear"),o(!t.genMipmaps,"mipmap generation not supported with float textures"));var u=e.images;for(i=0;i<16;++i)if(u[i]){var l=r>>i,c=s>>i;o(e.mipmask&1<<i,"missing mipmap data");var h=u[i];if(o(h.width===l&&h.height===c,"invalid shape for mip images"),o(h.format===e.format&&h.internalformat===e.internalformat&&h.type===e.type,"incompatible type for mip image"),!h.compressed)if(h.data){var f=Math.ceil(Q(h.type,a)*l/h.unpackAlignment)*h.unpackAlignment;o(h.data.byteLength===f*c,"invalid data for image, buffer size is inconsistent with image format")}else h.element||h.copy}else t.genMipmaps||o(0===(e.mipmask&1<<i),"extra mipmap data");e.compressed&&o(!t.genMipmaps,"mipmap generation for compressed images not supported")}function et(t,e,n,i){var r=t.width,s=t.height,a=t.channels;o(r>0&&r<=i.maxTextureSize&&s>0&&s<=i.maxTextureSize,"invalid texture shape"),o(r===s,"cube map must be square"),o(e.wrapS===M&&e.wrapT===M,"wrap mode not supported by cube map");for(var u=0;u<n.length;++u){var l=n[u];o(l.width===r&&l.height===s,"inconsistent cube map face shape"),e.genMipmaps&&(o(!l.compressed,"can not generate mipmap for compressed textures"),o(1===l.mipmask,"can not specify mipmaps and generate mipmaps"));for(var c=l.images,h=0;h<16;++h){var f=c[h];if(f){var d=r>>h,p=s>>h;o(l.mipmask&1<<h,"missing mipmap data"),o(f.width===d&&f.height===p,"invalid shape for mip images"),o(f.format===t.format&&f.internalformat===t.internalformat&&f.type===t.type,"incompatible type for mip image"),f.compressed||(f.data?o(f.data.byteLength===d*p*Math.max(Q(f.type,a),f.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):f.element||f.copy)}}}}K[5120]=K[R]=1,K[V]=K[U]=K[Z]=K[Y]=K[G]=K[H]=2,K[$]=K[W]=K[q]=K[X]=4;var nt=e(o,{optional:O,raise:r,commandRaise:P,command:k,parameter:a,commandParameter:z,constructor:p,type:c,commandType:D,isTypedArray:u,nni:h,oneOf:f,shaderError:A,linkError:T,callSite:x,saveCommandRef:I,saveDrawInfo:C,framebufferFormat:F,guessCommand:g,texture2D:tt,textureCube:et}),it=0,rt=0,ot=5,st=6;function at(t,e){this.id=it++,this.type=t,this.data=e}function ut(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function lt(t){if(0===t.length)return[];var e=t.charAt(0),n=t.charAt(t.length-1);if(t.length>1&&e===n&&('"'===e||"'"===e))return['"'+ut(t.substr(1,t.length-2))+'"'];var i=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(t);if(i)return lt(t.substr(0,i.index)).concat(lt(i[1])).concat(lt(t.substr(i.index+i[0].length)));var r=t.split(".");if(1===r.length)return['"'+ut(t)+'"'];for(var o=[],s=0;s<r.length;++s)o=o.concat(lt(r[s]));return o}function ct(t){return"["+lt(t).join("][")+"]"}function ht(t,e){return new at(t,ct(e+""))}function ft(t){return"function"==typeof t&&!t._reglType||t instanceof at}function dt(t,e){return"function"==typeof t?new at(rt,t):"number"==typeof t||"boolean"==typeof t?new at(ot,t):Array.isArray(t)?new at(st,t.map((function(t,n){return dt(t,e+"["+n+"]")}))):t instanceof at?t:void nt(!1,"invalid option type in uniform "+e)}var pt={DynamicVariable:at,define:ht,isDynamic:ft,unbox:dt,accessor:ct},mt={next:"function"==typeof requestAnimationFrame?function(t){return requestAnimationFrame(t)}:function(t){return setTimeout(t,16)},cancel:"function"==typeof cancelAnimationFrame?function(t){return cancelAnimationFrame(t)}:clearTimeout},yt=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function vt(){var t={"":0},e=[""];return{id:function(n){var i=t[n];return i||(i=t[n]=e.length,e.push(n),i)},str:function(t){return e[t]}}}function bt(t,n,i){var r,o=document.createElement("canvas");function s(){var e=window.innerWidth,n=window.innerHeight;if(t!==document.body){var r=o.getBoundingClientRect();e=r.right-r.left,n=r.bottom-r.top}o.width=i*e,o.height=i*n}function a(){r?r.disconnect():window.removeEventListener("resize",s),t.removeChild(o)}return e(o.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),t.appendChild(o),t===document.body&&(o.style.position="absolute",e(t.style,{margin:0,padding:0})),t!==document.body&&"function"==typeof ResizeObserver?(r=new ResizeObserver((function(){setTimeout(s)}))).observe(t):window.addEventListener("resize",s,!1),s(),{canvas:o,onDestroy:a}}function gt(t,e){function n(n){try{return t.getContext(n,e)}catch{return null}}return n("webgl")||n("experimental-webgl")||n("webgl-experimental")}function xt(t){return"string"==typeof t.nodeName&&"function"==typeof t.appendChild&&"function"==typeof t.getBoundingClientRect}function wt(t){return"function"==typeof t.drawArrays||"function"==typeof t.drawElements}function _t(t){return"string"==typeof t?t.split():(nt(Array.isArray(t),"invalid extension array"),t)}function St(t){return"string"==typeof t?(nt(typeof document<"u","not supported outside of DOM"),document.querySelector(t)):t}function At(t){var e,n,i,r,o=t||{},s={},a=[],u=[],l=typeof window>"u"?1:window.devicePixelRatio,c=!1,h=function(t){t&&nt.raise(t)},f=function(){};if("string"==typeof o?(nt(typeof document<"u","selector queries only supported in DOM enviroments"),e=document.querySelector(o),nt(e,"invalid query string for element")):"object"==typeof o?xt(o)?e=o:wt(o)?i=(r=o).canvas:(nt.constructor(o),"gl"in o?r=o.gl:"canvas"in o?i=St(o.canvas):"container"in o&&(n=St(o.container)),"attributes"in o&&(s=o.attributes,nt.type(s,"object","invalid context attributes")),"extensions"in o&&(a=_t(o.extensions)),"optionalExtensions"in o&&(u=_t(o.optionalExtensions)),"onDone"in o&&(nt.type(o.onDone,"function","invalid or missing onDone callback"),h=o.onDone),"profile"in o&&(c=!!o.profile),"pixelRatio"in o&&(l=+o.pixelRatio,nt(l>0,"invalid pixel ratio"))):nt.raise("invalid arguments to regl"),e&&("canvas"===e.nodeName.toLowerCase()?i=e:n=e),!r){if(!i){nt(typeof document<"u","must manually specify webgl context outside of DOM environments");var d=bt(n||document.body,h,l);if(!d)return null;i=d.canvas,f=d.onDestroy}void 0===s.premultipliedAlpha&&(s.premultipliedAlpha=!0),r=gt(i,s)}return r?{gl:r,canvas:i,container:n,extensions:a,optionalExtensions:u,pixelRatio:l,profile:c,onDone:h,onDestroy:f}:(f(),h("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Tt(t,e){var n={};function i(e){nt.type(e,"string","extension name must be string");var i,r=e.toLowerCase();try{i=n[r]=t.getExtension(r)}catch{}return!!i}for(var r=0;r<e.extensions.length;++r){var o=e.extensions[r];if(!i(o))return e.onDestroy(),e.onDone('"'+o+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return e.optionalExtensions.forEach(i),{extensions:n,restore:function(){Object.keys(n).forEach((function(t){if(n[t]&&!i(t))throw new Error("(regl): error restoring extension "+t)}))}}}function It(t,e){for(var n=Array(t),i=0;i<t;++i)n[i]=e(i);return n}var Ct=5120,Pt=5121,kt=5122,zt=5123,Dt=5124,Ot=5125,Ft=5126;function Mt(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function Bt(t){var e,n;return e=(t>65535)<<4,e|=n=((t>>>=e)>255)<<3,e|=n=((t>>>=n)>15)<<2,(e|=n=((t>>>=n)>3)<<1)|(t>>>=n)>>1}function Et(){var t=It(8,(function(){return[]}));function e(e){var n=Mt(e),i=t[Bt(n)>>2];return i.length>0?i.pop():new ArrayBuffer(n)}function n(e){t[Bt(e.byteLength)>>2].push(e)}function i(t,n){var i=null;switch(t){case Ct:i=new Int8Array(e(n),0,n);break;case Pt:i=new Uint8Array(e(n),0,n);break;case kt:i=new Int16Array(e(2*n),0,n);break;case zt:i=new Uint16Array(e(2*n),0,n);break;case Dt:i=new Int32Array(e(4*n),0,n);break;case Ot:i=new Uint32Array(e(4*n),0,n);break;case Ft:i=new Float32Array(e(4*n),0,n);break;default:return null}return i.length!==n?i.subarray(0,n):i}function r(t){n(t.buffer)}return{alloc:e,free:n,allocType:i,freeType:r}}var Lt=Et();Lt.zero=Et();var Nt=3408,jt=3410,Rt=3411,Vt=3412,Ut=3413,$t=3414,Wt=3415,qt=33901,Gt=33902,Ht=3379,Yt=3386,Xt=34921,Zt=36347,Kt=36348,Qt=35661,Jt=35660,te=34930,ee=36349,ne=34076,ie=34024,re=7936,oe=7937,se=7938,ae=35724,ue=34047,le=36063,ce=34852,he=3553,fe=34067,de=34069,pe=33984,me=6408,ye=5126,ve=5121,be=36160,ge=36053,xe=36064,we=16384,_e=function(t,e){var n=1;e.ext_texture_filter_anisotropic&&(n=t.getParameter(ue));var i=1,r=1;e.webgl_draw_buffers&&(i=t.getParameter(ce),r=t.getParameter(le));var o=!!e.oes_texture_float;if(o){var s=t.createTexture();t.bindTexture(he,s),t.texImage2D(he,0,me,1,1,0,me,ye,null);var a=t.createFramebuffer();if(t.bindFramebuffer(be,a),t.framebufferTexture2D(be,xe,he,s,0),t.bindTexture(he,null),t.checkFramebufferStatus(be)!==ge)o=!1;else{t.viewport(0,0,1,1),t.clearColor(1,0,0,1),t.clear(we);var u=Lt.allocType(ye,4);t.readPixels(0,0,1,1,me,ye,u),t.getError()?o=!1:(t.deleteFramebuffer(a),t.deleteTexture(s),o=1===u[0]),Lt.freeType(u)}}var l=!0;if(!(typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)))){var c=t.createTexture(),h=Lt.allocType(ve,36);t.activeTexture(pe),t.bindTexture(fe,c),t.texImage2D(de,0,me,3,3,0,me,ve,h),Lt.freeType(h),t.bindTexture(fe,null),t.deleteTexture(c),l=!t.getError()}return{colorBits:[t.getParameter(jt),t.getParameter(Rt),t.getParameter(Vt),t.getParameter(Ut)],depthBits:t.getParameter($t),stencilBits:t.getParameter(Wt),subpixelBits:t.getParameter(Nt),extensions:Object.keys(e).filter((function(t){return!!e[t]})),maxAnisotropic:n,maxDrawbuffers:i,maxColorAttachments:r,pointSizeDims:t.getParameter(qt),lineWidthDims:t.getParameter(Gt),maxViewportDims:t.getParameter(Yt),maxCombinedTextureUnits:t.getParameter(Qt),maxCubeMapSize:t.getParameter(ne),maxRenderbufferSize:t.getParameter(ie),maxTextureUnits:t.getParameter(te),maxTextureSize:t.getParameter(Ht),maxAttributes:t.getParameter(Xt),maxVertexUniforms:t.getParameter(Zt),maxVertexTextureUnits:t.getParameter(Jt),maxVaryingVectors:t.getParameter(Kt),maxFragmentUniforms:t.getParameter(ee),glsl:t.getParameter(ae),renderer:t.getParameter(oe),vendor:t.getParameter(re),version:t.getParameter(se),readFloat:o,npotTextureCube:l}};function Se(e){return!!e&&"object"==typeof e&&Array.isArray(e.shape)&&Array.isArray(e.stride)&&"number"==typeof e.offset&&e.shape.length===e.stride.length&&(Array.isArray(e.data)||t(e.data))}var Ae=function(t){return Object.keys(t).map((function(e){return t[e]}))},Te={shape:De,flatten:ze};function Ie(t,e,n){for(var i=0;i<e;++i)n[i]=t[i]}function Ce(t,e,n,i){for(var r=0,o=0;o<e;++o)for(var s=t[o],a=0;a<n;++a)i[r++]=s[a]}function Pe(t,e,n,i,r,o){for(var s=o,a=0;a<e;++a)for(var u=t[a],l=0;l<n;++l)for(var c=u[l],h=0;h<i;++h)r[s++]=c[h]}function ke(t,e,n,i,r){for(var o=1,s=n+1;s<e.length;++s)o*=e[s];var a=e[n];if(e.length-n===4){var u=e[n+1],l=e[n+2],c=e[n+3];for(s=0;s<a;++s)Pe(t[s],u,l,c,i,r),r+=o}else for(s=0;s<a;++s)ke(t[s],e,n+1,i,r),r+=o}function ze(t,e,n,i){var r=1;if(e.length)for(var o=0;o<e.length;++o)r*=e[o];else r=0;var s=i||Lt.allocType(n,r);switch(e.length){case 0:break;case 1:Ie(t,e[0],s);break;case 2:Ce(t,e[0],e[1],s);break;case 3:Pe(t,e[0],e[1],e[2],s,0);break;default:ke(t,e,0,s,0)}return s}function De(t){for(var e=[],n=t;n.length;n=n[0])e.push(n.length);return e}var Oe={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Fe={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Me=35040,Be={dynamic:35048,stream:Me,static:35044},Ee=Te.flatten,Le=Te.shape,Ne=35044,je=35040,Re=5121,Ve=5126,Ue=[];function $e(t){return 0|Oe[Object.prototype.toString.call(t)]}function We(t,e){for(var n=0;n<e.length;++n)t[n]=e[n]}function qe(t,e,n,i,r,o,s){for(var a=0,u=0;u<n;++u)for(var l=0;l<i;++l)t[a++]=e[r*u+o*l+s]}function Ge(e,n,i,r){var o=0,s={};function a(t){this.id=o++,this.buffer=e.createBuffer(),this.type=t,this.usage=Ne,this.byteLength=0,this.dimension=1,this.dtype=Re,this.persistentData=null,i.profile&&(this.stats={size:0})}a.prototype.bind=function(){e.bindBuffer(this.type,this.buffer)},a.prototype.destroy=function(){d(this)};var u=[];function l(t,e){var n=u.pop();return n||(n=new a(t)),n.bind(),f(n,e,je,0,1,!1),n}function c(t){u.push(t)}function h(t,n,i){t.byteLength=n.byteLength,e.bufferData(t.type,n,i)}function f(e,n,i,r,o,s){var a,u;if(e.usage=i,Array.isArray(n)){if(e.dtype=r||Ve,n.length>0)if(Array.isArray(n[0])){a=Le(n);for(var l=1,c=1;c<a.length;++c)l*=a[c];e.dimension=l,h(e,u=Ee(n,a,e.dtype),i),s?e.persistentData=u:Lt.freeType(u)}else if("number"==typeof n[0]){e.dimension=o;var f=Lt.allocType(e.dtype,n.length);We(f,n),h(e,f,i),s?e.persistentData=f:Lt.freeType(f)}else t(n[0])?(e.dimension=n[0].length,e.dtype=r||$e(n[0])||Ve,h(e,u=Ee(n,[n.length,n[0].length],e.dtype),i),s?e.persistentData=u:Lt.freeType(u)):nt.raise("invalid buffer data")}else if(t(n))e.dtype=r||$e(n),e.dimension=o,h(e,n,i),s&&(e.persistentData=new Uint8Array(new Uint8Array(n.buffer)));else if(Se(n)){a=n.shape;var d=n.stride,p=n.offset,m=0,y=0,v=0,b=0;1===a.length?(m=a[0],y=1,v=d[0],b=0):2===a.length?(m=a[0],y=a[1],v=d[0],b=d[1]):nt.raise("invalid shape"),e.dtype=r||$e(n.data)||Ve,e.dimension=y;var g=Lt.allocType(e.dtype,m*y);qe(g,n.data,m,y,v,b,p),h(e,g,i),s?e.persistentData=g:Lt.freeType(g)}else n instanceof ArrayBuffer?(e.dtype=Re,e.dimension=o,h(e,n,i),s&&(e.persistentData=new Uint8Array(new Uint8Array(n)))):nt.raise("invalid buffer data")}function d(t){n.bufferCount--,r(t);var i=t.buffer;nt(i,"buffer must not be deleted already"),e.deleteBuffer(i),t.buffer=null,delete s[t.id]}function p(r,o,u,l){n.bufferCount++;var c=new a(o);function h(n){var r=Ne,o=null,s=0,a=0,u=1;return Array.isArray(n)||t(n)||Se(n)||n instanceof ArrayBuffer?o=n:"number"==typeof n?s=0|n:n&&(nt.type(n,"object","buffer arguments must be an object, a number or an array"),"data"in n&&(nt(null===o||Array.isArray(o)||t(o)||Se(o),"invalid data for buffer"),o=n.data),"usage"in n&&(nt.parameter(n.usage,Be,"invalid buffer usage"),r=Be[n.usage]),"type"in n&&(nt.parameter(n.type,Fe,"invalid buffer type"),a=Fe[n.type]),"dimension"in n&&(nt.type(n.dimension,"number","invalid dimension"),u=0|n.dimension),"length"in n&&(nt.nni(s,"buffer length must be a nonnegative integer"),s=0|n.length)),c.bind(),o?f(c,o,r,a,u,l):(s&&e.bufferData(c.type,s,r),c.dtype=a||Re,c.usage=r,c.dimension=u,c.byteLength=s),i.profile&&(c.stats.size=c.byteLength*Ue[c.dtype]),h}function p(t,n){nt(n+t.byteLength<=c.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+t.byteLength+" starting from offset "+n+" to a buffer of size "+c.byteLength),e.bufferSubData(c.type,n,t)}function m(e,n){var i,r=0|(n||0);if(c.bind(),t(e)||e instanceof ArrayBuffer)p(e,r);else if(Array.isArray(e)){if(e.length>0)if("number"==typeof e[0]){var o=Lt.allocType(c.dtype,e.length);We(o,e),p(o,r),Lt.freeType(o)}else if(Array.isArray(e[0])||t(e[0])){i=Le(e);var s=Ee(e,i,c.dtype);p(s,r),Lt.freeType(s)}else nt.raise("invalid buffer data")}else if(Se(e)){i=e.shape;var a=e.stride,u=0,l=0,f=0,d=0;1===i.length?(u=i[0],l=1,f=a[0],d=0):2===i.length?(u=i[0],l=i[1],f=a[0],d=a[1]):nt.raise("invalid shape");var m=Array.isArray(e.data)?c.dtype:$e(e.data),y=Lt.allocType(m,u*l);qe(y,e.data,u,l,f,d,e.offset),p(y,r),Lt.freeType(y)}else nt.raise("invalid data for buffer subdata");return h}return s[c.id]=c,u||h(r),h._reglType="buffer",h._buffer=c,h.subdata=m,i.profile&&(h.stats=c.stats),h.destroy=function(){d(c)},h}function m(){Ae(s).forEach((function(t){t.buffer=e.createBuffer(),e.bindBuffer(t.type,t.buffer),e.bufferData(t.type,t.persistentData||t.byteLength,t.usage)}))}return i.profile&&(n.getTotalBufferSize=function(){var t=0;return Object.keys(s).forEach((function(e){t+=s[e].stats.size})),t}),{create:p,createStream:l,destroyStream:c,clear:function(){Ae(s).forEach(d),u.forEach(d)},getBuffer:function(t){return t&&t._buffer instanceof a?t._buffer:null},restore:m,_initBuffer:f}}Ue[5120]=1,Ue[5122]=2,Ue[5124]=4,Ue[5121]=1,Ue[5123]=2,Ue[5125]=4,Ue[5126]=4;var He={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Ye=0,Xe=1,Ze=4,Ke=5120,Qe=5121,Je=5122,tn=5123,en=5124,nn=5125,rn=34963,on=35040,sn=35044;function an(e,n,i,r){var o={},s=0,a={uint8:Qe,uint16:tn};function u(t){this.id=s++,o[this.id]=this,this.buffer=t,this.primType=Ze,this.vertCount=0,this.type=0}n.oes_element_index_uint&&(a.uint32=nn),u.prototype.bind=function(){this.buffer.bind()};var l=[];function c(t){var e=l.pop();return e||(e=new u(i.create(null,rn,!0,!1)._buffer)),f(e,t,on,-1,-1,0,0),e}function h(t){l.push(t)}function f(r,o,s,a,u,l,c){var h;if(r.buffer.bind(),o){var f=c;!c&&(!t(o)||Se(o)&&!t(o.data))&&(f=n.oes_element_index_uint?nn:tn),i._initBuffer(r.buffer,o,s,f,3)}else e.bufferData(rn,l,s),r.buffer.dtype=h||Qe,r.buffer.usage=s,r.buffer.dimension=3,r.buffer.byteLength=l;if(h=c,!c){switch(r.buffer.dtype){case Qe:case Ke:h=Qe;break;case tn:case Je:h=tn;break;case nn:case en:h=nn;break;default:nt.raise("unsupported type for element array")}r.buffer.dtype=h}r.type=h,nt(h!==nn||!!n.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var d=u;d<0&&(d=r.buffer.byteLength,h===tn?d>>=1:h===nn&&(d>>=2)),r.vertCount=d;var p=a;if(a<0){p=Ze;var m=r.buffer.dimension;1===m&&(p=Ye),2===m&&(p=Xe),3===m&&(p=Ze)}r.primType=p}function d(t){r.elementsCount--,nt(null!==t.buffer,"must not double destroy elements"),delete o[t.id],t.buffer.destroy(),t.buffer=null}function p(e,n){var o=i.create(null,rn,!0),s=new u(o._buffer);function l(e){if(e)if("number"==typeof e)o(e),s.primType=Ze,s.vertCount=0|e,s.type=Qe;else{var n=null,i=sn,r=-1,u=-1,c=0,h=0;Array.isArray(e)||t(e)||Se(e)?n=e:(nt.type(e,"object","invalid arguments for elements"),"data"in e&&(n=e.data,nt(Array.isArray(n)||t(n)||Se(n),"invalid data for element buffer")),"usage"in e&&(nt.parameter(e.usage,Be,"invalid element buffer usage"),i=Be[e.usage]),"primitive"in e&&(nt.parameter(e.primitive,He,"invalid element buffer primitive"),r=He[e.primitive]),"count"in e&&(nt("number"==typeof e.count&&e.count>=0,"invalid vertex count for elements"),u=0|e.count),"type"in e&&(nt.parameter(e.type,a,"invalid buffer type"),h=a[e.type]),"length"in e?c=0|e.length:(c=u,h===tn||h===Je?c*=2:(h===nn||h===en)&&(c*=4))),f(s,n,i,r,u,c,h)}else o(),s.primType=Ze,s.vertCount=0,s.type=Qe;return l}return r.elementsCount++,l(e),l._reglType="elements",l._elements=s,l.subdata=function(t,e){return o.subdata(t,e),l},l.destroy=function(){d(s)},l}return{create:p,createStream:c,destroyStream:h,getElements:function(t){return"function"==typeof t&&t._elements instanceof u?t._elements:null},clear:function(){Ae(o).forEach(d)}}}var un=new Float32Array(1),ln=new Uint32Array(un.buffer),cn=5123;function hn(t){for(var e=Lt.allocType(cn,t.length),n=0;n<t.length;++n)if(isNaN(t[n]))e[n]=65535;else if(t[n]===1/0)e[n]=31744;else if(t[n]===-1/0)e[n]=64512;else{un[0]=t[n];var i=ln[0],r=i>>>31<<15,o=(i<<1>>>24)-127,s=i>>13&1023;if(o<-24)e[n]=r;else if(o<-14){var a=-14-o;e[n]=r+(s+1024>>a)}else e[n]=o>15?r+31744:r+(o+15<<10)+s}return e}function fn(e){return Array.isArray(e)||t(e)}var dn=function(t){return!(t&t-1)&&!!t},pn=34467,mn=3553,yn=34067,vn=34069,bn=6408,gn=6406,xn=6407,wn=6409,_n=6410,Sn=32854,An=32855,Tn=36194,In=32819,Cn=32820,Pn=33635,kn=34042,zn=6402,Dn=34041,On=35904,Fn=35906,Mn=36193,Bn=33776,En=33777,Ln=33778,Nn=33779,jn=35986,Rn=35987,Vn=34798,Un=35840,$n=35841,Wn=35842,qn=35843,Gn=36196,Hn=5121,Yn=5123,Xn=5125,Zn=5126,Kn=10242,Qn=10243,Jn=10497,ti=33071,ei=33648,ni=10240,ii=10241,ri=9728,oi=9729,si=9984,ai=9985,ui=9986,li=9987,ci=33170,hi=4352,fi=4353,di=4354,pi=34046,mi=3317,yi=37440,vi=37441,bi=37443,gi=37444,xi=33984,wi=[si,ui,ai,li],_i=[0,wn,_n,xn,bn],Si={};function Ai(t){return"[object "+t+"]"}Si[wn]=Si[gn]=Si[zn]=1,Si[Dn]=Si[_n]=2,Si[xn]=Si[On]=3,Si[bn]=Si[Fn]=4;var Ti=Ai("HTMLCanvasElement"),Ii=Ai("OffscreenCanvas"),Ci=Ai("CanvasRenderingContext2D"),Pi=Ai("ImageBitmap"),ki=Ai("HTMLImageElement"),zi=Ai("HTMLVideoElement"),Di=Object.keys(Oe).concat([Ti,Ii,Ci,Pi,ki,zi]),Oi=[];Oi[Hn]=1,Oi[Zn]=4,Oi[Mn]=2,Oi[Yn]=2,Oi[Xn]=4;var Fi=[];function Mi(t){return Array.isArray(t)&&(0===t.length||"number"==typeof t[0])}function Bi(t){return!!Array.isArray(t)&&!(0===t.length||!fn(t[0]))}function Ei(t){return Object.prototype.toString.call(t)}function Li(t){return Ei(t)===Ti}function Ni(t){return Ei(t)===Ii}function ji(t){return Ei(t)===Ci}function Ri(t){return Ei(t)===Pi}function Vi(t){return Ei(t)===ki}function Ui(t){return Ei(t)===zi}function $i(t){if(!t)return!1;var e=Ei(t);return Di.indexOf(e)>=0||Mi(t)||Bi(t)||Se(t)}function Wi(t){return 0|Oe[Object.prototype.toString.call(t)]}function qi(t,e){var n=e.length;switch(t.type){case Hn:case Yn:case Xn:case Zn:var i=Lt.allocType(t.type,n);i.set(e),t.data=i;break;case Mn:t.data=hn(e);break;default:nt.raise("unsupported texture type, must specify a typed array")}}function Gi(t,e){return Lt.allocType(t.type===Mn?Zn:t.type,e)}function Hi(t,e){t.type===Mn?(t.data=hn(e),Lt.freeType(e)):t.data=e}function Yi(t,e,n,i,r,o){for(var s=t.width,a=t.height,u=t.channels,l=Gi(t,s*a*u),c=0,h=0;h<a;++h)for(var f=0;f<s;++f)for(var d=0;d<u;++d)l[c++]=e[n*f+i*h+r*d+o];Hi(t,l)}function Xi(t,e,n,i,r,o){var s;if(s=typeof Fi[t]<"u"?Fi[t]:Si[t]*Oi[e],o&&(s*=6),r){for(var a=0,u=n;u>=1;)a+=s*u*u,u/=2;return a}return s*n*i}function Zi(n,i,r,o,s,a,u){var l={"don't care":hi,"dont care":hi,nice:di,fast:fi},c={repeat:Jn,clamp:ti,mirror:ei},h={nearest:ri,linear:oi},f=e({mipmap:li,"nearest mipmap nearest":si,"linear mipmap nearest":ai,"nearest mipmap linear":ui,"linear mipmap linear":li},h),d={none:0,browser:gi},p={uint8:Hn,rgba4:In,rgb565:Pn,"rgb5 a1":Cn},m={alpha:gn,luminance:wn,"luminance alpha":_n,rgb:xn,rgba:bn,rgba4:Sn,"rgb5 a1":An,rgb565:Tn},y={};i.ext_srgb&&(m.srgb=On,m.srgba=Fn),i.oes_texture_float&&(p.float32=p.float=Zn),i.oes_texture_half_float&&(p.float16=p["half float"]=Mn),i.webgl_depth_texture&&(e(m,{depth:zn,"depth stencil":Dn}),e(p,{uint16:Yn,uint32:Xn,"depth stencil":kn})),i.webgl_compressed_texture_s3tc&&e(y,{"rgb s3tc dxt1":Bn,"rgba s3tc dxt1":En,"rgba s3tc dxt3":Ln,"rgba s3tc dxt5":Nn}),i.webgl_compressed_texture_atc&&e(y,{"rgb atc":jn,"rgba atc explicit alpha":Rn,"rgba atc interpolated alpha":Vn}),i.webgl_compressed_texture_pvrtc&&e(y,{"rgb pvrtc 4bppv1":Un,"rgb pvrtc 2bppv1":$n,"rgba pvrtc 4bppv1":Wn,"rgba pvrtc 2bppv1":qn}),i.webgl_compressed_texture_etc1&&(y["rgb etc1"]=Gn);var v=Array.prototype.slice.call(n.getParameter(pn));Object.keys(y).forEach((function(t){var e=y[t];v.indexOf(e)>=0&&(m[t]=e)}));var b=Object.keys(m);r.textureFormats=b;var g=[];Object.keys(m).forEach((function(t){var e=m[t];g[e]=t}));var x=[];Object.keys(p).forEach((function(t){var e=p[t];x[e]=t}));var w=[];Object.keys(h).forEach((function(t){var e=h[t];w[e]=t}));var _=[];Object.keys(f).forEach((function(t){var e=f[t];_[e]=t}));var S=[];Object.keys(c).forEach((function(t){var e=c[t];S[e]=t}));var A=b.reduce((function(t,e){var n=m[e];return n===wn||n===gn||n===wn||n===_n||n===zn||n===Dn||i.ext_srgb&&(n===On||n===Fn)?t[n]=n:n===An||e.indexOf("rgba")>=0?t[n]=bn:t[n]=xn,t}),{});function T(){this.internalformat=bn,this.format=bn,this.type=Hn,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=gi,this.width=0,this.height=0,this.channels=0}function I(t,e){t.internalformat=e.internalformat,t.format=e.format,t.type=e.type,t.compressed=e.compressed,t.premultiplyAlpha=e.premultiplyAlpha,t.flipY=e.flipY,t.unpackAlignment=e.unpackAlignment,t.colorSpace=e.colorSpace,t.width=e.width,t.height=e.height,t.channels=e.channels}function C(t,e){if("object"==typeof e&&e){if("premultiplyAlpha"in e&&(nt.type(e.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),t.premultiplyAlpha=e.premultiplyAlpha),"flipY"in e&&(nt.type(e.flipY,"boolean","invalid texture flip"),t.flipY=e.flipY),"alignment"in e&&(nt.oneOf(e.alignment,[1,2,4,8],"invalid texture unpack alignment"),t.unpackAlignment=e.alignment),"colorSpace"in e&&(nt.parameter(e.colorSpace,d,"invalid colorSpace"),t.colorSpace=d[e.colorSpace]),"type"in e){var n=e.type;nt(i.oes_texture_float||!("float"===n||"float32"===n),"you must enable the OES_texture_float extension in order to use floating point textures."),nt(i.oes_texture_half_float||!("half float"===n||"float16"===n),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),nt(i.webgl_depth_texture||!("uint16"===n||"uint32"===n||"depth stencil"===n),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),nt.parameter(n,p,"invalid texture type"),t.type=p[n]}var o=t.width,s=t.height,a=t.channels,u=!1;"shape"in e?(nt(Array.isArray(e.shape)&&e.shape.length>=2,"shape must be an array"),o=e.shape[0],s=e.shape[1],3===e.shape.length&&(a=e.shape[2],nt(a>0&&a<=4,"invalid number of channels"),u=!0),nt(o>=0&&o<=r.maxTextureSize,"invalid width"),nt(s>=0&&s<=r.maxTextureSize,"invalid height")):("radius"in e&&(o=s=e.radius,nt(o>=0&&o<=r.maxTextureSize,"invalid radius")),"width"in e&&(o=e.width,nt(o>=0&&o<=r.maxTextureSize,"invalid width")),"height"in e&&(s=e.height,nt(s>=0&&s<=r.maxTextureSize,"invalid height")),"channels"in e&&(a=e.channels,nt(a>0&&a<=4,"invalid number of channels"),u=!0)),t.width=0|o,t.height=0|s,t.channels=0|a;var l=!1;if("format"in e){var c=e.format;nt(i.webgl_depth_texture||!("depth"===c||"depth stencil"===c),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),nt.parameter(c,m,"invalid texture format");var h=t.internalformat=m[c];t.format=A[h],c in p&&("type"in e||(t.type=p[c])),c in y&&(t.compressed=!0),l=!0}!u&&l?t.channels=Si[t.format]:u&&!l?t.channels!==_i[t.format]&&(t.format=t.internalformat=_i[t.channels]):l&&u&&nt(t.channels===Si[t.format],"number of channels inconsistent with specified format")}}function P(t){n.pixelStorei(yi,t.flipY),n.pixelStorei(vi,t.premultiplyAlpha),n.pixelStorei(bi,t.colorSpace),n.pixelStorei(mi,t.unpackAlignment)}function k(){T.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function z(e,n){var i=null;if($i(n)?i=n:n&&(nt.type(n,"object","invalid pixel data type"),C(e,n),"x"in n&&(e.xOffset=0|n.x),"y"in n&&(e.yOffset=0|n.y),$i(n.data)&&(i=n.data)),nt(!e.compressed||i instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),n.copy){nt(!i,"can not specify copy and data field for the same texture");var o=s.viewportWidth,a=s.viewportHeight;e.width=e.width||o-e.xOffset,e.height=e.height||a-e.yOffset,e.needsCopy=!0,nt(e.xOffset>=0&&e.xOffset<o&&e.yOffset>=0&&e.yOffset<a&&e.width>0&&e.width<=o&&e.height>0&&e.height<=a,"copy texture read out of bounds")}else if(i){if(t(i))e.channels=e.channels||4,e.data=i,!("type"in n)&&e.type===Hn&&(e.type=Wi(i));else if(Mi(i))e.channels=e.channels||4,qi(e,i),e.alignment=1,e.needsFree=!0;else if(Se(i)){var u=i.data;!Array.isArray(u)&&e.type===Hn&&(e.type=Wi(u));var l,c,h,f,d,p,m=i.shape,y=i.stride;3===m.length?(h=m[2],p=y[2]):(nt(2===m.length,"invalid ndarray pixel data, must be 2 or 3D"),h=1,p=1),l=m[0],c=m[1],f=y[0],d=y[1],e.alignment=1,e.width=l,e.height=c,e.channels=h,e.format=e.internalformat=_i[h],e.needsFree=!0,Yi(e,u,f,d,p,i.offset)}else if(Li(i)||Ni(i)||ji(i))Li(i)||Ni(i)?e.element=i:e.element=i.canvas,e.width=e.element.width,e.height=e.element.height,e.channels=4;else if(Ri(i))e.element=i,e.width=i.width,e.height=i.height,e.channels=4;else if(Vi(i))e.element=i,e.width=i.naturalWidth,e.height=i.naturalHeight,e.channels=4;else if(Ui(i))e.element=i,e.width=i.videoWidth,e.height=i.videoHeight,e.channels=4;else if(Bi(i)){var v=e.width||i[0].length,b=e.height||i.length,g=e.channels;g=fn(i[0][0])?g||i[0][0].length:g||1;for(var x=Te.shape(i),w=1,_=0;_<x.length;++_)w*=x[_];var S=Gi(e,w);Te.flatten(i,x,"",S),Hi(e,S),e.alignment=1,e.width=v,e.height=b,e.channels=g,e.format=e.internalformat=_i[g],e.needsFree=!0}}else e.width=e.width||1,e.height=e.height||1,e.channels=e.channels||4;e.type===Zn?nt(r.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):e.type===Mn&&nt(r.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function D(t,e,i){var r=t.element,s=t.data,a=t.internalformat,u=t.format,l=t.type,c=t.width,h=t.height;P(t),r?n.texImage2D(e,i,u,u,l,r):t.compressed?n.compressedTexImage2D(e,i,a,c,h,0,s):t.needsCopy?(o(),n.copyTexImage2D(e,i,u,t.xOffset,t.yOffset,c,h,0)):n.texImage2D(e,i,u,c,h,0,u,l,s||null)}function O(t,e,i,r,s){var a=t.element,u=t.data,l=t.internalformat,c=t.format,h=t.type,f=t.width,d=t.height;P(t),a?n.texSubImage2D(e,s,i,r,c,h,a):t.compressed?n.compressedTexSubImage2D(e,s,i,r,l,f,d,u):t.needsCopy?(o(),n.copyTexSubImage2D(e,s,i,r,t.xOffset,t.yOffset,f,d)):n.texSubImage2D(e,s,i,r,f,d,c,h,u)}var F=[];function M(){return F.pop()||new k}function B(t){t.needsFree&&Lt.freeType(t.data),k.call(t),F.push(t)}function E(){T.call(this),this.genMipmaps=!1,this.mipmapHint=hi,this.mipmask=0,this.images=Array(16)}function L(t,e,n){var i=t.images[0]=M();t.mipmask=1,i.width=t.width=e,i.height=t.height=n,i.channels=t.channels=4}function N(t,e){var n=null;if($i(e))I(n=t.images[0]=M(),t),z(n,e),t.mipmask=1;else if(C(t,e),Array.isArray(e.mipmap))for(var i=e.mipmap,r=0;r<i.length;++r)I(n=t.images[r]=M(),t),n.width>>=r,n.height>>=r,z(n,i[r]),t.mipmask|=1<<r;else I(n=t.images[0]=M(),t),z(n,e),t.mipmask=1;I(t,t.images[0]),t.compressed&&(t.internalformat===Bn||t.internalformat===En||t.internalformat===Ln||t.internalformat===Nn)&&nt(t.width%4===0&&t.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function j(t,e){for(var n=t.images,i=0;i<n.length;++i){if(!n[i])return;D(n[i],e,i)}}var R=[];function V(){var t=R.pop()||new E;T.call(t),t.mipmask=0;for(var e=0;e<16;++e)t.images[e]=null;return t}function U(t){for(var e=t.images,n=0;n<e.length;++n)e[n]&&B(e[n]),e[n]=null;R.push(t)}function $(){this.minFilter=ri,this.magFilter=ri,this.wrapS=ti,this.wrapT=ti,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=hi}function W(t,e){if("min"in e){var n=e.min;nt.parameter(n,f),t.minFilter=f[n],wi.indexOf(t.minFilter)>=0&&!("faces"in e)&&(t.genMipmaps=!0)}if("mag"in e){var i=e.mag;nt.parameter(i,h),t.magFilter=h[i]}var o=t.wrapS,s=t.wrapT;if("wrap"in e){var a=e.wrap;"string"==typeof a?(nt.parameter(a,c),o=s=c[a]):Array.isArray(a)&&(nt.parameter(a[0],c),nt.parameter(a[1],c),o=c[a[0]],s=c[a[1]])}else{if("wrapS"in e){var u=e.wrapS;nt.parameter(u,c),o=c[u]}if("wrapT"in e){var d=e.wrapT;nt.parameter(d,c),s=c[d]}}if(t.wrapS=o,t.wrapT=s,"anisotropic"in e){var p=e.anisotropic;nt("number"==typeof p&&p>=1&&p<=r.maxAnisotropic,"aniso samples must be between 1 and "),t.anisotropic=e.anisotropic}if("mipmap"in e){var m=!1;switch(typeof e.mipmap){case"string":nt.parameter(e.mipmap,l,"invalid mipmap hint"),t.mipmapHint=l[e.mipmap],t.genMipmaps=!0,m=!0;break;case"boolean":m=t.genMipmaps=e.mipmap;break;case"object":nt(Array.isArray(e.mipmap),"invalid mipmap type"),t.genMipmaps=!1,m=!0;break;default:nt.raise("invalid mipmap type")}m&&!("min"in e)&&(t.minFilter=si)}}function q(t,e){n.texParameteri(e,ii,t.minFilter),n.texParameteri(e,ni,t.magFilter),n.texParameteri(e,Kn,t.wrapS),n.texParameteri(e,Qn,t.wrapT),i.ext_texture_filter_anisotropic&&n.texParameteri(e,pi,t.anisotropic),t.genMipmaps&&(n.hint(ci,t.mipmapHint),n.generateMipmap(e))}var G=0,H={},Y=r.maxTextureUnits,X=Array(Y).map((function(){return null}));function Z(t){T.call(this),this.mipmask=0,this.internalformat=bn,this.id=G++,this.refCount=1,this.target=t,this.texture=n.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new $,u.profile&&(this.stats={size:0})}function K(t){n.activeTexture(xi),n.bindTexture(t.target,t.texture)}function Q(){var t=X[0];t?n.bindTexture(t.target,t.texture):n.bindTexture(mn,null)}function J(t){var e=t.texture;nt(e,"must not double destroy texture");var i=t.unit,r=t.target;i>=0&&(n.activeTexture(xi+i),n.bindTexture(r,null),X[i]=null),n.deleteTexture(e),t.texture=null,t.params=null,t.pixels=null,t.refCount=0,delete H[t.id],a.textureCount--}function tt(t,e){var i=new Z(mn);function o(t,e){var n=i.texInfo;$.call(n);var s=V();return"number"==typeof t?L(s,0|t,"number"==typeof e?0|e:0|t):t?(nt.type(t,"object","invalid arguments to regl.texture"),W(n,t),N(s,t)):L(s,1,1),n.genMipmaps&&(s.mipmask=(s.width<<1)-1),i.mipmask=s.mipmask,I(i,s),nt.texture2D(n,s,r),i.internalformat=s.internalformat,o.width=s.width,o.height=s.height,K(i),j(s,mn),q(n,mn),Q(),U(s),u.profile&&(i.stats.size=Xi(i.internalformat,i.type,s.width,s.height,n.genMipmaps,!1)),o.format=g[i.internalformat],o.type=x[i.type],o.mag=w[n.magFilter],o.min=_[n.minFilter],o.wrapS=S[n.wrapS],o.wrapT=S[n.wrapT],o}function s(t,e,n,r){nt(!!t,"must specify image data");var s=0|e,a=0|n,u=0|r,l=M();return I(l,i),l.width=0,l.height=0,z(l,t),l.width=l.width||(i.width>>u)-s,l.height=l.height||(i.height>>u)-a,nt(i.type===l.type&&i.format===l.format&&i.internalformat===l.internalformat,"incompatible format for texture.subimage"),nt(s>=0&&a>=0&&s+l.width<=i.width&&a+l.height<=i.height,"texture.subimage write out of bounds"),nt(i.mipmask&1<<u,"missing mipmap data"),nt(l.data||l.element||l.needsCopy,"missing image data"),K(i),O(l,mn,s,a,u),Q(),B(l),o}function l(t,e){var r=0|t,s=0|e||r;if(r===i.width&&s===i.height)return o;o.width=i.width=r,o.height=i.height=s,K(i);for(var a=0;i.mipmask>>a;++a){var l=r>>a,c=s>>a;if(!l||!c)break;n.texImage2D(mn,a,i.format,l,c,0,i.format,i.type,null)}return Q(),u.profile&&(i.stats.size=Xi(i.internalformat,i.type,r,s,!1,!1)),o}return H[i.id]=i,a.textureCount++,o(t,e),o.subimage=s,o.resize=l,o._reglType="texture2d",o._texture=i,u.profile&&(o.stats=i.stats),o.destroy=function(){i.decRef()},o}function et(t,e,i,o,s,l){var c=new Z(yn);H[c.id]=c,a.cubeCount++;var h=new Array(6);function f(t,e,n,i,o,s){var a,l=c.texInfo;for($.call(l),a=0;a<6;++a)h[a]=V();if("number"!=typeof t&&t)if("object"==typeof t)if(e)N(h[0],t),N(h[1],e),N(h[2],n),N(h[3],i),N(h[4],o),N(h[5],s);else if(W(l,t),C(c,t),"faces"in t){var d=t.faces;for(nt(Array.isArray(d)&&6===d.length,"cube faces must be a length 6 array"),a=0;a<6;++a)nt("object"==typeof d[a]&&!!d[a],"invalid input for cube map face"),I(h[a],c),N(h[a],d[a])}else for(a=0;a<6;++a)N(h[a],t);else nt.raise("invalid arguments to cube map");else{var p=0|t||1;for(a=0;a<6;++a)L(h[a],p,p)}for(I(c,h[0]),nt.optional((function(){r.npotTextureCube||nt(dn(c.width)&&dn(c.height),"your browser does not support non power or two texture dimensions")})),l.genMipmaps?c.mipmask=(h[0].width<<1)-1:c.mipmask=h[0].mipmask,nt.textureCube(c,l,h,r),c.internalformat=h[0].internalformat,f.width=h[0].width,f.height=h[0].height,K(c),a=0;a<6;++a)j(h[a],vn+a);for(q(l,yn),Q(),u.profile&&(c.stats.size=Xi(c.internalformat,c.type,f.width,f.height,l.genMipmaps,!0)),f.format=g[c.internalformat],f.type=x[c.type],f.mag=w[l.magFilter],f.min=_[l.minFilter],f.wrapS=S[l.wrapS],f.wrapT=S[l.wrapT],a=0;a<6;++a)U(h[a]);return f}function d(t,e,n,i,r){nt(!!e,"must specify image data"),nt("number"==typeof t&&t===(0|t)&&t>=0&&t<6,"invalid face");var o=0|n,s=0|i,a=0|r,u=M();return I(u,c),u.width=0,u.height=0,z(u,e),u.width=u.width||(c.width>>a)-o,u.height=u.height||(c.height>>a)-s,nt(c.type===u.type&&c.format===u.format&&c.internalformat===u.internalformat,"incompatible format for texture.subimage"),nt(o>=0&&s>=0&&o+u.width<=c.width&&s+u.height<=c.height,"texture.subimage write out of bounds"),nt(c.mipmask&1<<a,"missing mipmap data"),nt(u.data||u.element||u.needsCopy,"missing image data"),K(c),O(u,vn+t,o,s,a),Q(),B(u),f}function p(t){var e=0|t;if(e!==c.width){f.width=c.width=e,f.height=c.height=e,K(c);for(var i=0;i<6;++i)for(var r=0;c.mipmask>>r;++r)n.texImage2D(vn+i,r,c.format,e>>r,e>>r,0,c.format,c.type,null);return Q(),u.profile&&(c.stats.size=Xi(c.internalformat,c.type,f.width,f.height,!1,!0)),f}}return f(t,e,i,o,s,l),f.subimage=d,f.resize=p,f._reglType="textureCube",f._texture=c,u.profile&&(f.stats=c.stats),f.destroy=function(){c.decRef()},f}function it(){for(var t=0;t<Y;++t)n.activeTexture(xi+t),n.bindTexture(mn,null),X[t]=null;Ae(H).forEach(J),a.cubeCount=0,a.textureCount=0}function rt(){for(var t=0;t<Y;++t){var e=X[t];e&&(e.bindCount=0,e.unit=-1,X[t]=null)}Ae(H).forEach((function(t){t.texture=n.createTexture(),n.bindTexture(t.target,t.texture);for(var e=0;e<32;++e)if(t.mipmask&1<<e)if(t.target===mn)n.texImage2D(mn,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);else for(var i=0;i<6;++i)n.texImage2D(vn+i,e,t.internalformat,t.width>>e,t.height>>e,0,t.internalformat,t.type,null);q(t.texInfo,t.target)}))}function ot(){for(var t=0;t<Y;++t){var e=X[t];e&&(e.bindCount=0,e.unit=-1,X[t]=null),n.activeTexture(xi+t),n.bindTexture(mn,null),n.bindTexture(yn,null)}}return e(Z.prototype,{bind:function(){var t=this;t.bindCount+=1;var e=t.unit;if(e<0){for(var i=0;i<Y;++i){var r=X[i];if(r){if(r.bindCount>0)continue;r.unit=-1}X[i]=t,e=i;break}e>=Y&&nt.raise("insufficient number of texture units"),u.profile&&a.maxTextureUnits<e+1&&(a.maxTextureUnits=e+1),t.unit=e,n.activeTexture(xi+e),n.bindTexture(t.target,t.texture)}return e},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&J(this)}}),u.profile&&(a.getTotalTextureSize=function(){var t=0;return Object.keys(H).forEach((function(e){t+=H[e].stats.size})),t}),{create2D:tt,createCube:et,clear:it,getTexture:function(t){return null},restore:rt,refresh:ot}}Fi[Sn]=2,Fi[An]=2,Fi[Tn]=2,Fi[Dn]=4,Fi[Bn]=.5,Fi[En]=.5,Fi[Ln]=1,Fi[Nn]=1,Fi[jn]=.5,Fi[Rn]=1,Fi[Vn]=1,Fi[Un]=.5,Fi[$n]=.25,Fi[Wn]=.5,Fi[qn]=.25,Fi[Gn]=.5;var Ki=36161,Qi=32854,Ji=32855,tr=36194,er=33189,nr=36168,ir=34041,rr=35907,or=34836,sr=34842,ar=34843,ur=[];function lr(t,e,n){return ur[t]*e*n}ur[Qi]=2,ur[Ji]=2,ur[tr]=2,ur[er]=2,ur[nr]=1,ur[ir]=4,ur[rr]=4,ur[or]=16,ur[sr]=8,ur[ar]=6;var cr=function(t,e,n,i,r){var o={rgba4:Qi,rgb565:tr,"rgb5 a1":Ji,depth:er,stencil:nr,"depth stencil":ir};e.ext_srgb&&(o.srgba=rr),e.ext_color_buffer_half_float&&(o.rgba16f=sr,o.rgb16f=ar),e.webgl_color_buffer_float&&(o.rgba32f=or);var s=[];Object.keys(o).forEach((function(t){var e=o[t];s[e]=t}));var a=0,u={};function l(t){this.id=a++,this.refCount=1,this.renderbuffer=t,this.format=Qi,this.width=0,this.height=0,r.profile&&(this.stats={size:0})}function c(e){var n=e.renderbuffer;nt(n,"must not double destroy renderbuffer"),t.bindRenderbuffer(Ki,null),t.deleteRenderbuffer(n),e.renderbuffer=null,e.refCount=0,delete u[e.id],i.renderbufferCount--}function h(e,a){var c=new l(t.createRenderbuffer());function h(e,i){var a=0,u=0,l=Qi;if("object"==typeof e&&e){var f=e;if("shape"in f){var d=f.shape;nt(Array.isArray(d)&&d.length>=2,"invalid renderbuffer shape"),a=0|d[0],u=0|d[1]}else"radius"in f&&(a=u=0|f.radius),"width"in f&&(a=0|f.width),"height"in f&&(u=0|f.height);"format"in f&&(nt.parameter(f.format,o,"invalid renderbuffer format"),l=o[f.format])}else"number"==typeof e?(a=0|e,u="number"==typeof i?0|i:a):e?nt.raise("invalid arguments to renderbuffer constructor"):a=u=1;if(nt(a>0&&u>0&&a<=n.maxRenderbufferSize&&u<=n.maxRenderbufferSize,"invalid renderbuffer size"),a!==c.width||u!==c.height||l!==c.format)return h.width=c.width=a,h.height=c.height=u,c.format=l,t.bindRenderbuffer(Ki,c.renderbuffer),t.renderbufferStorage(Ki,l,a,u),nt(0===t.getError(),"invalid render buffer format"),r.profile&&(c.stats.size=lr(c.format,c.width,c.height)),h.format=s[c.format],h}function f(e,i){var o=0|e,s=0|i||o;return o===c.width&&s===c.height||(nt(o>0&&s>0&&o<=n.maxRenderbufferSize&&s<=n.maxRenderbufferSize,"invalid renderbuffer size"),h.width=c.width=o,h.height=c.height=s,t.bindRenderbuffer(Ki,c.renderbuffer),t.renderbufferStorage(Ki,c.format,o,s),nt(0===t.getError(),"invalid render buffer format"),r.profile&&(c.stats.size=lr(c.format,c.width,c.height))),h}return u[c.id]=c,i.renderbufferCount++,h(e,a),h.resize=f,h._reglType="renderbuffer",h._renderbuffer=c,r.profile&&(h.stats=c.stats),h.destroy=function(){c.decRef()},h}function f(){Ae(u).forEach((function(e){e.renderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(Ki,e.renderbuffer),t.renderbufferStorage(Ki,e.format,e.width,e.height)})),t.bindRenderbuffer(Ki,null)}return l.prototype.decRef=function(){--this.refCount<=0&&c(this)},r.profile&&(i.getTotalRenderbufferSize=function(){var t=0;return Object.keys(u).forEach((function(e){t+=u[e].stats.size})),t}),{create:h,clear:function(){Ae(u).forEach(c)},restore:f}},hr=36160,fr=36161,dr=3553,pr=34069,mr=36064,yr=36096,vr=36128,br=33306,gr=36053,xr=36054,wr=36055,_r=36057,Sr=36061,Ar=36193,Tr=5121,Ir=5126,Cr=6407,Pr=6408,kr=6402,zr=[Cr,Pr],Dr=[];Dr[Pr]=4,Dr[Cr]=3;var Or=[];Or[Tr]=1,Or[Ir]=4,Or[Ar]=2;var Fr=33189,Mr=36168,Br=34041,Er=[32854,32855,36194,35907,34842,34843,34836],Lr={};function Nr(t,n,i,r,o,s){var a={cur:null,next:null,dirty:!1,setFBO:null},u=["rgba"],l=["rgba4","rgb565","rgb5 a1"];n.ext_srgb&&l.push("srgba"),n.ext_color_buffer_half_float&&l.push("rgba16f","rgb16f"),n.webgl_color_buffer_float&&l.push("rgba32f");var c=["uint8"];function h(t,e,n){this.target=t,this.texture=e,this.renderbuffer=n;var i=0,r=0;e?(i=e.width,r=e.height):n&&(i=n.width,r=n.height),this.width=i,this.height=r}function f(t){t&&(t.texture&&t.texture._texture.decRef(),t.renderbuffer&&t.renderbuffer._renderbuffer.decRef())}function d(t,e,n){if(t)if(t.texture){var i=t.texture._texture,r=Math.max(1,i.width),o=Math.max(1,i.height);nt(r===e&&o===n,"inconsistent width/height for supplied texture"),i.refCount+=1}else{var s=t.renderbuffer._renderbuffer;nt(s.width===e&&s.height===n,"inconsistent width/height for renderbuffer"),s.refCount+=1}}function p(e,n){n&&(n.texture?t.framebufferTexture2D(hr,e,n.target,n.texture._texture.texture,0):t.framebufferRenderbuffer(hr,e,fr,n.renderbuffer._renderbuffer.renderbuffer))}function m(t){var e=dr,n=null,i=null,r=t;"object"==typeof t&&(r=t.data,"target"in t&&(e=0|t.target)),nt.type(r,"function","invalid attachment data");var o=r._reglType;return"texture2d"===o?(n=r,nt(e===dr)):"textureCube"===o?(n=r,nt(e>=pr&&e<pr+6,"invalid cube map target")):"renderbuffer"===o?(i=r,e=fr):nt.raise("invalid regl object for attachment"),new h(e,n,i)}function y(t,e,n,i,s){if(n){var a=r.create2D({width:t,height:e,format:i,type:s});return a._texture.refCount=0,new h(dr,a,null)}var u=o.create({width:t,height:e,format:i});return u._renderbuffer.refCount=0,new h(fr,null,u)}function v(t){return t&&(t.texture||t.renderbuffer)}function b(t,e,n){t&&(t.texture?t.texture.resize(e,n):t.renderbuffer&&t.renderbuffer.resize(e,n),t.width=e,t.height=n)}n.oes_texture_half_float&&c.push("half float","float16"),n.oes_texture_float&&c.push("float","float32");var g=0,x={};function w(){this.id=g++,x[this.id]=this,this.framebuffer=t.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function _(t){t.colorAttachments.forEach(f),f(t.depthAttachment),f(t.stencilAttachment),f(t.depthStencilAttachment)}function S(e){var n=e.framebuffer;nt(n,"must not double destroy framebuffer"),t.deleteFramebuffer(n),e.framebuffer=null,s.framebufferCount--,delete x[e.id]}function A(e){var n;t.bindFramebuffer(hr,e.framebuffer);var r=e.colorAttachments;for(n=0;n<r.length;++n)p(mr+n,r[n]);for(n=r.length;n<i.maxColorAttachments;++n)t.framebufferTexture2D(hr,mr+n,dr,null,0);t.framebufferTexture2D(hr,br,dr,null,0),t.framebufferTexture2D(hr,yr,dr,null,0),t.framebufferTexture2D(hr,vr,dr,null,0),p(yr,e.depthAttachment),p(vr,e.stencilAttachment),p(br,e.depthStencilAttachment);var o=t.checkFramebufferStatus(hr);!t.isContextLost()&&o!==gr&&nt.raise("framebuffer configuration not supported, status = "+Lr[o]),t.bindFramebuffer(hr,a.next?a.next.framebuffer:null),a.cur=a.next,t.getError()}function T(t,r){var o=new w;function h(t,e){var r;nt(a.next!==o,"can not update framebuffer which is currently in use");var s=0,f=0,p=!0,b=!0,g=null,x=!0,w="rgba",S="uint8",T=1,I=null,C=null,P=null,k=!1;if("number"==typeof t)s=0|t,f=0|e||s;else if(t){nt.type(t,"object","invalid arguments for framebuffer");var z=t;if("shape"in z){var D=z.shape;nt(Array.isArray(D)&&D.length>=2,"invalid shape for framebuffer"),s=D[0],f=D[1]}else"radius"in z&&(s=f=z.radius),"width"in z&&(s=z.width),"height"in z&&(f=z.height);("color"in z||"colors"in z)&&(g=z.color||z.colors,Array.isArray(g)&&nt(1===g.length||n.webgl_draw_buffers,"multiple render targets not supported")),g||("colorCount"in z&&(T=0|z.colorCount,nt(T>0,"invalid color buffer count")),"colorTexture"in z&&(x=!!z.colorTexture,w="rgba4"),"colorType"in z&&(S=z.colorType,x?(nt(n.oes_texture_float||!("float"===S||"float32"===S),"you must enable OES_texture_float in order to use floating point framebuffer objects"),nt(n.oes_texture_half_float||!("half float"===S||"float16"===S),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===S||"float16"===S?(nt(n.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),w="rgba16f"):("float"===S||"float32"===S)&&(nt(n.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),w="rgba32f"),nt.oneOf(S,c,"invalid color type")),"colorFormat"in z&&(w=z.colorFormat,u.indexOf(w)>=0?x=!0:l.indexOf(w)>=0?x=!1:nt.optional((function(){x?nt.oneOf(z.colorFormat,u,"invalid color format for texture"):nt.oneOf(z.colorFormat,l,"invalid color format for renderbuffer")})))),("depthTexture"in z||"depthStencilTexture"in z)&&(k=!(!z.depthTexture&&!z.depthStencilTexture),nt(!k||n.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in z&&("boolean"==typeof z.depth?p=z.depth:(I=z.depth,b=!1)),"stencil"in z&&("boolean"==typeof z.stencil?b=z.stencil:(C=z.stencil,p=!1)),"depthStencil"in z&&("boolean"==typeof z.depthStencil?p=b=z.depthStencil:(P=z.depthStencil,p=!1,b=!1))}else s=f=1;var O=null,F=null,M=null,B=null;if(Array.isArray(g))O=g.map(m);else if(g)O=[m(g)];else for(O=new Array(T),r=0;r<T;++r)O[r]=y(s,f,x,w,S);nt(n.webgl_draw_buffers||O.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),nt(O.length<=i.maxColorAttachments,"too many color attachments, not supported"),s=s||O[0].width,f=f||O[0].height,I?F=m(I):p&&!b&&(F=y(s,f,k,"depth","uint32")),C?M=m(C):b&&!p&&(M=y(s,f,!1,"stencil","uint8")),P?B=m(P):!I&&!C&&b&&p&&(B=y(s,f,k,"depth stencil","depth stencil")),nt(!!I+!!C+!!P<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var E=null;for(r=0;r<O.length;++r)if(d(O[r],s,f),nt(!O[r]||O[r].texture&&zr.indexOf(O[r].texture._texture.format)>=0||O[r].renderbuffer&&Er.indexOf(O[r].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+r+" is invalid"),O[r]&&O[r].texture){var L=Dr[O[r].texture._texture.format]*Or[O[r].texture._texture.type];null===E?E=L:nt(E===L,"all color attachments much have the same number of bits per pixel.")}return d(F,s,f),nt(!F||F.texture&&F.texture._texture.format===kr||F.renderbuffer&&F.renderbuffer._renderbuffer.format===Fr,"invalid depth attachment for framebuffer object"),d(M,s,f),nt(!M||M.renderbuffer&&M.renderbuffer._renderbuffer.format===Mr,"invalid stencil attachment for framebuffer object"),d(B,s,f),nt(!B||B.texture&&B.texture._texture.format===Br||B.renderbuffer&&B.renderbuffer._renderbuffer.format===Br,"invalid depth-stencil attachment for framebuffer object"),_(o),o.width=s,o.height=f,o.colorAttachments=O,o.depthAttachment=F,o.stencilAttachment=M,o.depthStencilAttachment=B,h.color=O.map(v),h.depth=v(F),h.stencil=v(M),h.depthStencil=v(B),h.width=o.width,h.height=o.height,A(o),h}function f(t,e){nt(a.next!==o,"can not resize a framebuffer which is currently in use");var n=Math.max(0|t,1),i=Math.max(0|e||n,1);if(n===o.width&&i===o.height)return h;for(var r=o.colorAttachments,s=0;s<r.length;++s)b(r[s],n,i);return b(o.depthAttachment,n,i),b(o.stencilAttachment,n,i),b(o.depthStencilAttachment,n,i),o.width=h.width=n,o.height=h.height=i,A(o),h}return s.framebufferCount++,h(t,r),e(h,{resize:f,_reglType:"framebuffer",_framebuffer:o,destroy:function(){S(o),_(o)},use:function(t){a.setFBO({framebuffer:h},t)}})}function I(t){var o=Array(6);function s(t){var i;nt(o.indexOf(a.next)<0,"can not update framebuffer which is currently in use");var l,h={color:null},f=0,d=null,p="rgba",m="uint8",y=1;if("number"==typeof t)f=0|t;else if(t){nt.type(t,"object","invalid arguments for framebuffer");var v=t;if("shape"in v){var b=v.shape;nt(Array.isArray(b)&&b.length>=2,"invalid shape for framebuffer"),nt(b[0]===b[1],"cube framebuffer must be square"),f=b[0]}else"radius"in v&&(f=0|v.radius),"width"in v?(f=0|v.width,"height"in v&&nt(v.height===f,"must be square")):"height"in v&&(f=0|v.height);("color"in v||"colors"in v)&&(d=v.color||v.colors,Array.isArray(d)&&nt(1===d.length||n.webgl_draw_buffers,"multiple render targets not supported")),d||("colorCount"in v&&(y=0|v.colorCount,nt(y>0,"invalid color buffer count")),"colorType"in v&&(nt.oneOf(v.colorType,c,"invalid color type"),m=v.colorType),"colorFormat"in v&&(p=v.colorFormat,nt.oneOf(v.colorFormat,u,"invalid color format for texture"))),"depth"in v&&(h.depth=v.depth),"stencil"in v&&(h.stencil=v.stencil),"depthStencil"in v&&(h.depthStencil=v.depthStencil)}else f=1;if(d)if(Array.isArray(d))for(l=[],i=0;i<d.length;++i)l[i]=d[i];else l=[d];else{l=Array(y);var g={radius:f,format:p,type:m};for(i=0;i<y;++i)l[i]=r.createCube(g)}for(h.color=Array(l.length),i=0;i<l.length;++i){var x=l[i];nt("function"==typeof x&&"textureCube"===x._reglType,"invalid cube map"),f=f||x.width,nt(x.width===f&&x.height===f,"invalid cube map shape"),h.color[i]={target:pr,data:l[i]}}for(i=0;i<6;++i){for(var w=0;w<l.length;++w)h.color[w].target=pr+i;i>0&&(h.depth=o[0].depth,h.stencil=o[0].stencil,h.depthStencil=o[0].depthStencil),o[i]?o[i](h):o[i]=T(h)}return e(s,{width:f,height:f,color:l})}function l(t){var e,n=0|t;if(nt(n>0&&n<=i.maxCubeMapSize,"invalid radius for cube fbo"),n===s.width)return s;var r=s.color;for(e=0;e<r.length;++e)r[e].resize(n);for(e=0;e<6;++e)o[e].resize(n);return s.width=s.height=n,s}return s(t),e(s,{faces:o,resize:l,_reglType:"framebufferCube",destroy:function(){o.forEach((function(t){t.destroy()}))}})}function C(){a.cur=null,a.next=null,a.dirty=!0,Ae(x).forEach((function(e){e.framebuffer=t.createFramebuffer(),A(e)}))}return e(a,{getFramebuffer:function(t){if("function"==typeof t&&"framebuffer"===t._reglType){var e=t._framebuffer;if(e instanceof w)return e}return null},create:T,createCube:I,clear:function(){Ae(x).forEach(S)},restore:C})}Lr[gr]="complete",Lr[xr]="incomplete attachment",Lr[_r]="incomplete dimensions",Lr[wr]="incomplete, missing attachment",Lr[Sr]="unsupported";var jr=5126,Rr=34962,Vr=34963,Ur=["attributes","elements","offset","count","primitive","instances"];function $r(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=jr,this.offset=0,this.stride=0,this.divisor=0}function Wr(e,n,i,r,o,s,a){for(var u=i.maxAttributes,l=new Array(u),c=0;c<u;++c)l[c]=new $r;var h=0,f={},d={Record:$r,scope:{},state:l,currentVAO:null,targetVAO:null,restore:m()?_:function(){},createVAO:S,getVAO:v,destroyBuffer:p,setVAO:m()?b:g,clear:m()?x:function(){}};function p(t){for(var n=0;n<l.length;++n){var i=l[n];i.buffer===t&&(e.disableVertexAttribArray(n),i.buffer=null)}}function m(){return n.oes_vertex_array_object}function y(){return n.angle_instanced_arrays}function v(t){return"function"==typeof t&&t._vao?t._vao:null}function b(t){if(t!==d.currentVAO){var e=m();t?e.bindVertexArrayOES(t.vao):e.bindVertexArrayOES(null),d.currentVAO=t}}function g(t){if(t!==d.currentVAO){if(t)t.bindAttrs();else{for(var n=y(),i=0;i<l.length;++i){var r=l[i];r.buffer?(e.enableVertexAttribArray(i),r.buffer.bind(),e.vertexAttribPointer(i,r.size,r.type,r.normalized,r.stride,r.offfset),n&&r.divisor&&n.vertexAttribDivisorANGLE(i,r.divisor)):(e.disableVertexAttribArray(i),e.vertexAttrib4f(i,r.x,r.y,r.z,r.w))}a.elements?e.bindBuffer(Vr,a.elements.buffer.buffer):e.bindBuffer(Vr,null)}d.currentVAO=t}}function x(){Ae(f).forEach((function(t){t.destroy()}))}function w(){this.id=++h,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var t=m();this.vao=t?t.createVertexArrayOES():null,f[this.id]=this,this.buffers=[]}function _(){m()&&Ae(f).forEach((function(t){t.refresh()}))}function S(e){var i=new w;function a(e){var r;if(Array.isArray(e))r=e,i.elements&&i.ownsElements&&i.elements.destroy(),i.elements=null,i.ownsElements=!1,i.offset=0,i.count=0,i.instances=-1,i.primitive=4;else{if(nt("object"==typeof e,"invalid arguments for create vao"),nt("attributes"in e,"must specify attributes for vao"),e.elements){var l=e.elements;i.ownsElements?"function"==typeof l&&"elements"===l._reglType?(i.elements.destroy(),i.ownsElements=!1):(i.elements(l),i.ownsElements=!1):s.getElements(e.elements)?(i.elements=e.elements,i.ownsElements=!1):(i.elements=s.create(e.elements),i.ownsElements=!0)}else i.elements=null,i.ownsElements=!1;r=e.attributes,i.offset=0,i.count=-1,i.instances=-1,i.primitive=4,i.elements&&(i.count=i.elements._elements.vertCount,i.primitive=i.elements._elements.primType),"offset"in e&&(i.offset=0|e.offset),"count"in e&&(i.count=0|e.count),"instances"in e&&(i.instances=0|e.instances),"primitive"in e&&(nt(e.primitive in He,"bad primitive type: "+e.primitive),i.primitive=He[e.primitive]),nt.optional((()=>{for(var t=Object.keys(e),n=0;n<t.length;++n)nt(Ur.indexOf(t[n])>=0,'invalid option for vao: "'+t[n]+'" valid options are '+Ur)})),nt(Array.isArray(r),"attributes must be an array")}nt(r.length<u,"too many attributes"),nt(r.length>0,"must specify at least one attribute");var c={},h=i.attributes;h.length=r.length;for(var f=0;f<r.length;++f){var d,p=r[f],m=h[f]=new $r,y=p.data||p;Array.isArray(y)||t(y)||Se(y)?(i.buffers[f]&&(d=i.buffers[f],t(y)&&d._buffer.byteLength>=y.byteLength?d.subdata(y):(d.destroy(),i.buffers[f]=null)),i.buffers[f]||(d=i.buffers[f]=o.create(p,Rr,!1,!0)),m.buffer=o.getBuffer(d),m.size=0|m.buffer.dimension,m.normalized=!1,m.type=m.buffer.dtype,m.offset=0,m.stride=0,m.divisor=0,m.state=1,c[f]=1):o.getBuffer(p)?(m.buffer=o.getBuffer(p),m.size=0|m.buffer.dimension,m.normalized=!1,m.type=m.buffer.dtype,m.offset=0,m.stride=0,m.divisor=0,m.state=1):o.getBuffer(p.buffer)?(m.buffer=o.getBuffer(p.buffer),m.size=0|(+p.size||m.buffer.dimension),m.normalized=!!p.normalized||!1,"type"in p?(nt.parameter(p.type,Fe,"invalid buffer type"),m.type=Fe[p.type]):m.type=m.buffer.dtype,m.offset=0|(p.offset||0),m.stride=0|(p.stride||0),m.divisor=0|(p.divisor||0),m.state=1,nt(m.size>=1&&m.size<=4,"size must be between 1 and 4"),nt(m.offset>=0,"invalid offset"),nt(m.stride>=0&&m.stride<=255,"stride must be between 0 and 255"),nt(m.divisor>=0,"divisor must be positive"),nt(!m.divisor||!!n.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in p?(nt(f>0,"first attribute must not be a constant"),m.x=+p.x||0,m.y=+p.y||0,m.z=+p.z||0,m.w=+p.w||0,m.state=2):nt(!1,"invalid attribute spec for location "+f)}for(var v=0;v<i.buffers.length;++v)!c[v]&&i.buffers[v]&&(i.buffers[v].destroy(),i.buffers[v]=null);return i.refresh(),a}return r.vaoCount+=1,a.destroy=function(){for(var t=0;t<i.buffers.length;++t)i.buffers[t]&&i.buffers[t].destroy();i.buffers.length=0,i.ownsElements&&(i.elements.destroy(),i.elements=null,i.ownsElements=!1),i.destroy()},a._vao=i,a._reglType="vao",a(e)}return w.prototype.bindAttrs=function(){for(var t=y(),n=this.attributes,i=0;i<n.length;++i){var r=n[i];r.buffer?(e.enableVertexAttribArray(i),e.bindBuffer(Rr,r.buffer.buffer),e.vertexAttribPointer(i,r.size,r.type,r.normalized,r.stride,r.offset),t&&r.divisor&&t.vertexAttribDivisorANGLE(i,r.divisor)):(e.disableVertexAttribArray(i),e.vertexAttrib4f(i,r.x,r.y,r.z,r.w))}for(var o=n.length;o<u;++o)e.disableVertexAttribArray(o);var a=s.getElements(this.elements);a?e.bindBuffer(Vr,a.buffer.buffer):e.bindBuffer(Vr,null)},w.prototype.refresh=function(){var t=m();t&&(t.bindVertexArrayOES(this.vao),this.bindAttrs(),d.currentVAO=null,t.bindVertexArrayOES(null))},w.prototype.destroy=function(){if(this.vao){var t=m();this===d.currentVAO&&(d.currentVAO=null,t.bindVertexArrayOES(null)),t.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),f[this.id]&&(delete f[this.id],r.vaoCount-=1)},d}var qr=35632,Gr=35633,Hr=35718,Yr=35721;function Xr(t,n,i,r){var o={},s={};function a(t,e,n,i){this.name=t,this.id=e,this.location=n,this.info=i}function u(t,e){for(var n=0;n<t.length;++n)if(t[n].id===e.id)return void(t[n].location=e.location);t.push(e)}function l(e,i,r){var a=e===qr?o:s,u=a[i];if(!u){var l=n.str(i);u=t.createShader(e),t.shaderSource(u,l),t.compileShader(u),nt.shaderError(t,u,l,e,r),a[i]=u}return u}var c={},h=[],f=0;function d(t,e){this.id=f++,this.fragId=t,this.vertId=e,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,r.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function p(e,i,o){var s,c,h=l(qr,e.fragId),f=l(Gr,e.vertId),d=e.program=t.createProgram();if(t.attachShader(d,h),t.attachShader(d,f),o)for(s=0;s<o.length;++s){var p=o[s];t.bindAttribLocation(d,p[0],p[1])}t.linkProgram(d),nt.linkError(t,d,n.str(e.fragId),n.str(e.vertId),i);var m=t.getProgramParameter(d,Hr);r.profile&&(e.stats.uniformsCount=m);var y=e.uniforms;for(s=0;s<m;++s)if(c=t.getActiveUniform(d,s)){if(c.size>1)for(var v=0;v<c.size;++v){var b=c.name.replace("[0]","["+v+"]");u(y,new a(b,n.id(b),t.getUniformLocation(d,b),c))}var g=c.name;c.size>1&&(g=g.replace("[0]","")),u(y,new a(g,n.id(g),t.getUniformLocation(d,g),c))}var x=t.getProgramParameter(d,Yr);r.profile&&(e.stats.attributesCount=x);var w=e.attributes;for(s=0;s<x;++s)(c=t.getActiveAttrib(d,s))&&u(w,new a(c.name,n.id(c.name),t.getAttribLocation(d,c.name),c))}function m(){o={},s={};for(var t=0;t<h.length;++t)p(h[t],null,h[t].attributes.map((function(t){return[t.location,t.name]})))}return r.profile&&(i.getMaxUniformsCount=function(){var t=0;return h.forEach((function(e){e.stats.uniformsCount>t&&(t=e.stats.uniformsCount)})),t},i.getMaxAttributesCount=function(){var t=0;return h.forEach((function(e){e.stats.attributesCount>t&&(t=e.stats.attributesCount)})),t}),{clear:function(){var e=t.deleteShader.bind(t);Ae(o).forEach(e),o={},Ae(s).forEach(e),s={},h.forEach((function(e){t.deleteProgram(e.program)})),h.length=0,c={},i.shaderCount=0},program:function(n,r,a,u){nt.command(n>=0,"missing vertex shader",a),nt.command(r>=0,"missing fragment shader",a);var l=c[r];l||(l=c[r]={});var f=l[n];if(f&&(f.refCount++,!u))return f;var m=new d(r,n);return i.shaderCount++,p(m,a,u),f||(l[n]=m),h.push(m),e(m,{destroy:function(){if(m.refCount--,m.refCount<=0){t.deleteProgram(m.program);var e=h.indexOf(m);h.splice(e,1),i.shaderCount--}l[m.vertId].refCount<=0&&(t.deleteShader(s[m.vertId]),delete s[m.vertId],delete c[m.fragId][m.vertId]),Object.keys(c[m.fragId]).length||(t.deleteShader(o[m.fragId]),delete o[m.fragId],delete c[m.fragId])}})},restore:m,shader:l,frag:-1,vert:-1}}var Zr=6408,Kr=5121,Qr=3333,Jr=5126;function to(e,n,i,r,o,s,a){function u(u){var l;null===n.next?(nt(o.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),l=Kr):(nt(null!==n.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),l=n.next.colorAttachments[0].texture._texture.type,nt.optional((function(){s.oes_texture_float?(nt(l===Kr||l===Jr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),l===Jr&&nt(a.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):nt(l===Kr,"Reading from a framebuffer is only allowed for the type 'uint8'")})));var c=0,h=0,f=r.framebufferWidth,d=r.framebufferHeight,p=null;t(u)?p=u:u&&(nt.type(u,"object","invalid arguments to regl.read()"),c=0|u.x,h=0|u.y,nt(c>=0&&c<r.framebufferWidth,"invalid x offset for regl.read"),nt(h>=0&&h<r.framebufferHeight,"invalid y offset for regl.read"),f=0|(u.width||r.framebufferWidth-c),d=0|(u.height||r.framebufferHeight-h),p=u.data||null),p&&(l===Kr?nt(p instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):l===Jr&&nt(p instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),nt(f>0&&f+c<=r.framebufferWidth,"invalid width for read pixels"),nt(d>0&&d+h<=r.framebufferHeight,"invalid height for read pixels"),i();var m=f*d*4;return p||(l===Kr?p=new Uint8Array(m):l===Jr&&(p=p||new Float32Array(m))),nt.isTypedArray(p,"data buffer for regl.read() must be a typedarray"),nt(p.byteLength>=m,"data buffer for regl.read() too small"),e.pixelStorei(Qr,4),e.readPixels(c,h,f,d,Zr,l,p),p}function l(t){var e;return n.setFBO({framebuffer:t.framebuffer},(function(){e=u(t)})),e}function c(t){return t&&"framebuffer"in t?l(t):u(t)}return c}function eo(t){return Array.prototype.slice.call(t)}function no(t){return eo(t).join("")}function io(){var t=0,n=[],i=[];function r(e){for(var r=0;r<i.length;++r)if(i[r]===e)return n[r];var o="g"+t++;return n.push(o),i.push(e),o}function o(){var n=[];function i(){n.push.apply(n,eo(arguments))}var r=[];function o(){var e="v"+t++;return r.push(e),arguments.length>0&&(n.push(e,"="),n.push.apply(n,eo(arguments)),n.push(";")),e}return e(i,{def:o,toString:function(){return no([r.length>0?"var "+r.join(",")+";":"",no(n)])}})}function s(){var t=o(),n=o(),i=t.toString,r=n.toString;function s(e,i){n(e,i,"=",t.def(e,i),";")}return e((function(){t.apply(t,eo(arguments))}),{def:t.def,entry:t,exit:n,save:s,set:function(e,n,i){s(e,n),t(e,n,"=",i,";")},toString:function(){return i()+r()}})}function a(){var t=no(arguments),n=s(),i=s(),r=n.toString,o=i.toString;return e(n,{then:function(){return n.apply(n,eo(arguments)),this},else:function(){return i.apply(i,eo(arguments)),this},toString:function(){var e=o();return e&&(e="else{"+e+"}"),no(["if(",t,"){",r(),"}",e])}})}var u=o(),l={};function c(t,n){var i=[];function r(){var t="a"+i.length;return i.push(t),t}n=n||0;for(var o=0;o<n;++o)r();var a=s(),u=a.toString;return l[t]=e(a,{arg:r,toString:function(){return no(["function(",i.join(),"){",u(),"}"])}})}function h(){var t=['"use strict";',u,"return {"];Object.keys(l).forEach((function(e){t.push('"',e,'":',l[e].toString(),",")})),t.push("}");var e=no(t).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,n.concat(e)).apply(null,i)}return{global:u,link:r,block:o,proc:c,scope:s,cond:a,compile:h}}var ro="xyzw".split(""),oo=5121,so=1,ao=2,uo=0,lo=1,co=2,ho=3,fo=4,po=5,mo=6,yo="dither",vo="blend.enable",bo="blend.color",go="blend.equation",xo="blend.func",wo="depth.enable",_o="depth.func",So="depth.range",Ao="depth.mask",To="colorMask",Io="cull.enable",Co="cull.face",Po="frontFace",ko="lineWidth",zo="polygonOffset.enable",Do="polygonOffset.offset",Oo="sample.alpha",Fo="sample.enable",Mo="sample.coverage",Bo="stencil.enable",Eo="stencil.mask",Lo="stencil.func",No="stencil.opFront",jo="stencil.opBack",Ro="scissor.enable",Vo="scissor.box",Uo="viewport",$o="profile",Wo="framebuffer",qo="vert",Go="frag",Ho="elements",Yo="primitive",Xo="count",Zo="offset",Ko="instances",Qo="vao",Jo="Width",ts="Height",es=Wo+Jo,ns=Wo+ts,is=Uo+Jo,rs=Uo+ts,os="drawingBuffer",ss=os+Jo,as=os+ts,us=[xo,go,Lo,No,jo,Mo,Uo,Vo,Do],ls=34962,cs=34963,hs=3553,fs=34067,ds=2884,ps=3042,ms=3024,ys=2960,vs=2929,bs=3089,gs=32823,xs=32926,ws=32928,_s=5126,Ss=35664,As=35665,Ts=35666,Is=5124,Cs=35667,Ps=35668,ks=35669,zs=35670,Ds=35671,Os=35672,Fs=35673,Ms=35674,Bs=35675,Es=35676,Ls=35678,Ns=35680,js=4,Rs=1028,Vs=1029,Us=2304,$s=2305,Ws=32775,qs=32776,Gs=519,Hs=7680,Ys=0,Xs=1,Zs=32774,Ks=513,Qs=36160,Js=36064,ta={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ea=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],na={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ia={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},ra={frag:35632,vert:35633},oa={cw:Us,ccw:$s};function sa(e){return Array.isArray(e)||t(e)||Se(e)}function aa(t){return t.sort((function(t,e){return t===Uo?-1:e===Uo?1:t<e?-1:1}))}function ua(t,e,n,i){this.thisDep=t,this.contextDep=e,this.propDep=n,this.append=i}function la(t){return t&&!(t.thisDep||t.contextDep||t.propDep)}function ca(t){return new ua(!1,!1,!1,t)}function ha(t,e){var n=t.type;if(n===uo){var i=t.data.length;return new ua(!0,i>=1,i>=2,e)}if(n===fo){var r=t.data;return new ua(r.thisDep,r.contextDep,r.propDep,e)}if(n===po)return new ua(!1,!1,!1,e);if(n===mo){for(var o=!1,s=!1,a=!1,u=0;u<t.data.length;++u){var l=t.data[u];if(l.type===lo)a=!0;else if(l.type===co)s=!0;else if(l.type===ho)o=!0;else if(l.type===uo){o=!0;var c=l.data;c>=1&&(s=!0),c>=2&&(a=!0)}else l.type===fo&&(o=o||l.data.thisDep,s=s||l.data.contextDep,a=a||l.data.propDep)}return new ua(o,s,a,e)}return new ua(n===ho,n===co,n===lo,e)}var fa=new ua(!1,!1,!1,(function(){}));function da(t,n,i,r,o,s,a,u,l,c,h,f,d,p,m){var y=c.Record,v={add:32774,subtract:32778,"reverse subtract":32779};i.ext_blend_minmax&&(v.min=Ws,v.max=qs);var b=i.angle_instanced_arrays,g=i.webgl_draw_buffers,x=i.oes_vertex_array_object,w={dirty:!0,profile:m.profile},_={},S=[],A={},T={};function I(t){return t.replace(".","_")}function C(t,e,n){var i=I(t);S.push(t),_[i]=w[i]=!!n,A[i]=e}function P(t,e,n){var i=I(t);S.push(t),Array.isArray(n)?(w[i]=n.slice(),_[i]=n.slice()):w[i]=_[i]=n,T[i]=e}C(yo,ms),C(vo,ps),P(bo,"blendColor",[0,0,0,0]),P(go,"blendEquationSeparate",[Zs,Zs]),P(xo,"blendFuncSeparate",[Xs,Ys,Xs,Ys]),C(wo,vs,!0),P(_o,"depthFunc",Ks),P(So,"depthRange",[0,1]),P(Ao,"depthMask",!0),P(To,To,[!0,!0,!0,!0]),C(Io,ds),P(Co,"cullFace",Vs),P(Po,Po,$s),P(ko,ko,1),C(zo,gs),P(Do,"polygonOffset",[0,0]),C(Oo,xs),C(Fo,ws),P(Mo,"sampleCoverage",[1,!1]),C(Bo,ys),P(Eo,"stencilMask",-1),P(Lo,"stencilFunc",[Gs,0,-1]),P(No,"stencilOpSeparate",[Rs,Hs,Hs,Hs]),P(jo,"stencilOpSeparate",[Vs,Hs,Hs,Hs]),C(Ro,bs),P(Vo,"scissor",[0,0,t.drawingBufferWidth,t.drawingBufferHeight]),P(Uo,Uo,[0,0,t.drawingBufferWidth,t.drawingBufferHeight]);var k={gl:t,context:d,strings:n,next:_,current:w,draw:f,elements:s,buffer:o,shader:h,attributes:c.state,vao:c,uniforms:l,framebuffer:u,extensions:i,timer:p,isBufferArgs:sa},z={primTypes:He,compareFuncs:na,blendFuncs:ta,blendEquations:v,stencilOps:ia,glTypes:Fe,orientationType:oa};nt.optional((function(){k.isArrayLike=fn})),g&&(z.backBuffer=[Vs],z.drawBuffer=It(r.maxDrawbuffers,(function(t){return 0===t?[0]:It(t,(function(t){return Js+t}))})));var D=0;function O(){var t=io(),e=t.link,i=t.global;t.id=D++,t.batchId="0";var r=e(k),o=t.shared={props:"a0"};Object.keys(k).forEach((function(t){o[t]=i.def(r,".",t)})),nt.optional((function(){t.CHECK=e(nt),t.commandStr=nt.guessCommand(),t.command=e(t.commandStr),t.assert=function(t,n,i){t("if(!(",n,"))",this.CHECK,".commandRaise(",e(i),",",this.command,");")},z.invalidBlendCombinations=ea}));var s=t.next={},a=t.current={};Object.keys(T).forEach((function(t){Array.isArray(w[t])&&(s[t]=i.def(o.next,".",t),a[t]=i.def(o.current,".",t))}));var u=t.constants={};Object.keys(z).forEach((function(t){u[t]=i.def(JSON.stringify(z[t]))})),t.invoke=function(n,i){switch(i.type){case uo:var r=["this",o.context,o.props,t.batchId];return n.def(e(i.data),".call(",r.slice(0,Math.max(i.data.length+1,4)),")");case lo:return n.def(o.props,i.data);case co:return n.def(o.context,i.data);case ho:return n.def("this",i.data);case fo:return i.data.append(t,n),i.data.ref;case po:return i.data.toString();case mo:return i.data.map((function(e){return t.invoke(n,e)}))}},t.attribCache={};var l={};return t.scopeAttrib=function(t){var i=n.id(t);if(i in l)return l[i];var r=c.scope[i];return r||(r=c.scope[i]=new y),l[i]=e(r)},t}function F(t){var e,n=t.static,i=t.dynamic;if($o in n){var r=!!n[$o];(e=ca((function(t,e){return r}))).enable=r}else if($o in i){var o=i[$o];e=ha(o,(function(t,e){return t.invoke(e,o)}))}return e}function M(t,e){var n=t.static,i=t.dynamic;if(Wo in n){var r=n[Wo];return r?(r=u.getFramebuffer(r),nt.command(r,"invalid framebuffer object"),ca((function(t,e){var n=t.link(r),i=t.shared;e.set(i.framebuffer,".next",n);var o=i.context;return e.set(o,"."+es,n+".width"),e.set(o,"."+ns,n+".height"),n}))):ca((function(t,e){var n=t.shared;e.set(n.framebuffer,".next","null");var i=n.context;return e.set(i,"."+es,i+"."+ss),e.set(i,"."+ns,i+"."+as),"null"}))}if(Wo in i){var o=i[Wo];return ha(o,(function(t,e){var n=t.invoke(e,o),i=t.shared,r=i.framebuffer,s=e.def(r,".getFramebuffer(",n,")");nt.optional((function(){t.assert(e,"!"+n+"||"+s,"invalid framebuffer object")})),e.set(r,".next",s);var a=i.context;return e.set(a,"."+es,s+"?"+s+".width:"+a+"."+ss),e.set(a,"."+ns,s+"?"+s+".height:"+a+"."+as),s}))}return null}function B(t,e,n){var i=t.static,r=t.dynamic;function o(t){if(t in i){var o=i[t];nt.commandType(o,"object","invalid "+t,n.commandStr);var s,a,u=!0,l=0|o.x,c=0|o.y;return"width"in o?(s=0|o.width,nt.command(s>=0,"invalid "+t,n.commandStr)):u=!1,"height"in o?(a=0|o.height,nt.command(a>=0,"invalid "+t,n.commandStr)):u=!1,new ua(!u&&e&&e.thisDep,!u&&e&&e.contextDep,!u&&e&&e.propDep,(function(t,e){var n=t.shared.context,i=s;"width"in o||(i=e.def(n,".",es,"-",l));var r=a;return"height"in o||(r=e.def(n,".",ns,"-",c)),[l,c,i,r]}))}if(t in r){var h=r[t],f=ha(h,(function(e,n){var i=e.invoke(n,h);nt.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)}));var r=e.shared.context,o=n.def(i,".x|0"),s=n.def(i,".y|0"),a=n.def('"width" in ',i,"?",i,".width|0:","(",r,".",es,"-",o,")"),u=n.def('"height" in ',i,"?",i,".height|0:","(",r,".",ns,"-",s,")");return nt.optional((function(){e.assert(n,a+">=0&&"+u+">=0","invalid "+t)})),[o,s,a,u]}));return e&&(f.thisDep=f.thisDep||e.thisDep,f.contextDep=f.contextDep||e.contextDep,f.propDep=f.propDep||e.propDep),f}return e?new ua(e.thisDep,e.contextDep,e.propDep,(function(t,e){var n=t.shared.context;return[0,0,e.def(n,".",es),e.def(n,".",ns)]})):null}var s=o(Uo);if(s){var a=s;s=new ua(s.thisDep,s.contextDep,s.propDep,(function(t,e){var n=a.append(t,e),i=t.shared.context;return e.set(i,"."+is,n[2]),e.set(i,"."+rs,n[3]),n}))}return{viewport:s,scissor_box:o(Vo)}}function E(t,e){var n=t.static;if("string"==typeof n[Go]&&"string"==typeof n[qo]){if(Object.keys(e.dynamic).length>0)return null;var i=e.static,r=Object.keys(i);if(r.length>0&&"number"==typeof i[r[0]]){for(var o=[],s=0;s<r.length;++s)nt("number"==typeof i[r[s]],"must specify all vertex attribute locations when using vaos"),o.push([0|i[r[s]],r[s]]);return o}}return null}function L(t,e,i){var r=t.static,o=t.dynamic;function s(t){if(t in r){var e=n.id(r[t]);nt.optional((function(){h.shader(ra[t],e,nt.guessCommand())}));var i=ca((function(){return e}));return i.id=e,i}if(t in o){var s=o[t];return ha(s,(function(e,n){var i=e.invoke(n,s),r=n.def(e.shared.strings,".id(",i,")");return nt.optional((function(){n(e.shared.shader,".shader(",ra[t],",",r,",",e.command,");")})),r}))}return null}var a,u=s(Go),l=s(qo),c=null;return la(u)&&la(l)?(c=h.program(l.id,u.id,null,i),a=ca((function(t,e){return t.link(c)}))):a=new ua(u&&u.thisDep||l&&l.thisDep,u&&u.contextDep||l&&l.contextDep,u&&u.propDep||l&&l.propDep,(function(t,e){var n,i=t.shared.shader;n=u?u.append(t,e):e.def(i,".",Go);var r=i+".program("+(l?l.append(t,e):e.def(i,".",qo))+","+n;return nt.optional((function(){r+=","+t.command})),e.def(r+")")})),{frag:u,vert:l,progVar:a,program:c}}function N(t,e){var n=t.static,i=t.dynamic,r={},o=!1;function a(){if(Qo in n){var t=n[Qo];return null!==t&&null===c.getVAO(t)&&(t=c.createVAO(t)),o=!0,r.vao=t,ca((function(e){var n=c.getVAO(t);return n?e.link(n):"null"}))}if(Qo in i){o=!0;var e=i[Qo];return ha(e,(function(t,n){var i=t.invoke(n,e);return n.def(t.shared.vao+".getVAO("+i+")")}))}return null}var u=a(),l=!1;function h(){if(Ho in n){var t=n[Ho];if(r.elements=t,sa(t)){var a=r.elements=s.create(t,!0);t=s.getElements(a),l=!0}else t&&(t=s.getElements(t),l=!0,nt.command(t,"invalid elements",e.commandStr));var c=ca((function(e,n){if(t){var i=e.link(t);return e.ELEMENTS=i,i}return e.ELEMENTS=null,null}));return c.value=t,c}if(Ho in i){l=!0;var h=i[Ho];return ha(h,(function(t,e){var n=t.shared,i=n.isBufferArgs,r=n.elements,o=t.invoke(e,h),s=e.def("null"),a=e.def(i,"(",o,")"),u=t.cond(a).then(s,"=",r,".createStream(",o,");").else(s,"=",r,".getElements(",o,");");return nt.optional((function(){t.assert(u.else,"!"+o+"||"+s,"invalid elements")})),e.entry(u),e.exit(t.cond(a).then(r,".destroyStream(",s,");")),t.ELEMENTS=s,s}))}return o?new ua(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.elements+".getElements("+t.shared.vao+".currentVAO.elements):null")})):null}var f=h();function d(){if(Yo in n){var t=n[Yo];return r.primitive=t,nt.commandParameter(t,He,"invalid primitve",e.commandStr),ca((function(e,n){return He[t]}))}if(Yo in i){var s=i[Yo];return ha(s,(function(t,e){var n=t.constants.primTypes,i=t.invoke(e,s);return nt.optional((function(){t.assert(e,i+" in "+n,"invalid primitive, must be one of "+Object.keys(He))})),e.def(n,"[",i,"]")}))}return l?la(f)?f.value?ca((function(t,e){return e.def(t.ELEMENTS,".primType")})):ca((function(){return js})):new ua(f.thisDep,f.contextDep,f.propDep,(function(t,e){var n=t.ELEMENTS;return e.def(n,"?",n,".primType:",js)})):o?new ua(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.primitive:"+js)})):null}function p(t,s){if(t in n){var a=0|n[t];return s?r.offset=a:r.instances=a,nt.command(!s||a>=0,"invalid "+t,e.commandStr),ca((function(t,e){return s&&(t.OFFSET=a),a}))}if(t in i){var c=i[t];return ha(c,(function(e,n){var i=e.invoke(n,c);return s&&(e.OFFSET=i,nt.optional((function(){e.assert(n,i+">=0","invalid "+t)}))),i}))}if(s){if(l)return ca((function(t,e){return t.OFFSET=0,0}));if(o)return new ua(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.offset:0")}))}else if(o)return new ua(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao+".currentVAO?"+t.shared.vao+".currentVAO.instances:-1")}));return null}var m=p(Zo,!0);function y(){if(Xo in n){var t=0|n[Xo];return r.count=t,nt.command("number"==typeof t&&t>=0,"invalid vertex count",e.commandStr),ca((function(){return t}))}if(Xo in i){var s=i[Xo];return ha(s,(function(t,e){var n=t.invoke(e,s);return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">=0&&"+n+"===("+n+"|0)","invalid vertex count")})),n}))}if(l){if(la(f)){if(f)return m?new ua(m.thisDep,m.contextDep,m.propDep,(function(t,e){var n=e.def(t.ELEMENTS,".vertCount-",t.OFFSET);return nt.optional((function(){t.assert(e,n+">=0","invalid vertex offset/element buffer too small")})),n})):ca((function(t,e){return e.def(t.ELEMENTS,".vertCount")}));var a=ca((function(){return-1}));return nt.optional((function(){a.MISSING=!0})),a}var c=new ua(f.thisDep||m.thisDep,f.contextDep||m.contextDep,f.propDep||m.propDep,(function(t,e){var n=t.ELEMENTS;return t.OFFSET?e.def(n,"?",n,".vertCount-",t.OFFSET,":-1"):e.def(n,"?",n,".vertCount:-1")}));return nt.optional((function(){c.DYNAMIC=!0})),c}return o?new ua(u.thisDep,u.contextDep,u.propDep,(function(t,e){return e.def(t.shared.vao,".currentVAO?",t.shared.vao,".currentVAO.count:-1")})):null}var v=d(),b=y(),g=p(Ko,!1);return{elements:f,primitive:v,count:b,instances:g,offset:m,vao:u,vaoActive:o,elementsActive:l,static:r}}function j(t,e){var n=t.static,i=t.dynamic,o={};return S.forEach((function(t){var s=I(t);function a(e,r){if(t in n){var a=e(n[t]);o[s]=ca((function(){return a}))}else if(t in i){var u=i[t];o[s]=ha(u,(function(t,e){return r(t,e,t.invoke(e,u))}))}}switch(t){case Io:case vo:case yo:case Bo:case wo:case Ro:case zo:case Oo:case Fo:case Ao:return a((function(n){return nt.commandType(n,"boolean",t,e.commandStr),n}),(function(e,n,i){return nt.optional((function(){e.assert(n,"typeof "+i+'==="boolean"',"invalid flag "+t,e.commandStr)})),i}));case _o:return a((function(n){return nt.commandParameter(n,na,"invalid "+t,e.commandStr),na[n]}),(function(e,n,i){var r=e.constants.compareFuncs;return nt.optional((function(){e.assert(n,i+" in "+r,"invalid "+t+", must be one of "+Object.keys(na))})),n.def(r,"[",i,"]")}));case So:return a((function(t){return nt.command(fn(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&t[0]<=t[1],"depth range is 2d array",e.commandStr),t}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===2&&typeof "+n+'[0]==="number"&&typeof '+n+'[1]==="number"&&'+n+"[0]<="+n+"[1]","depth range must be a 2d array")})),[e.def("+",n,"[0]"),e.def("+",n,"[1]")]}));case xo:return a((function(t){nt.commandType(t,"object","blend.func",e.commandStr);var n="srcRGB"in t?t.srcRGB:t.src,i="srcAlpha"in t?t.srcAlpha:t.src,r="dstRGB"in t?t.dstRGB:t.dst,o="dstAlpha"in t?t.dstAlpha:t.dst;return nt.commandParameter(n,ta,s+".srcRGB",e.commandStr),nt.commandParameter(i,ta,s+".srcAlpha",e.commandStr),nt.commandParameter(r,ta,s+".dstRGB",e.commandStr),nt.commandParameter(o,ta,s+".dstAlpha",e.commandStr),nt.command(-1===ea.indexOf(n+", "+r),"unallowed blending combination (srcRGB, dstRGB) = ("+n+", "+r+")",e.commandStr),[ta[n],ta[r],ta[i],ta[o]]}),(function(e,n,i){var r=e.constants.blendFuncs;function o(o,s){var a=n.def('"',o,s,'" in ',i,"?",i,".",o,s,":",i,".",o);return nt.optional((function(){e.assert(n,a+" in "+r,"invalid "+t+"."+o+s+", must be one of "+Object.keys(ta))})),a}nt.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid blend func, must be an object")}));var s=o("src","RGB"),a=o("dst","RGB");nt.optional((function(){var t=e.constants.invalidBlendCombinations;e.assert(n,t+".indexOf("+s+'+", "+'+a+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")}));var u=n.def(r,"[",s,"]"),l=n.def(r,"[",o("src","Alpha"),"]");return[u,n.def(r,"[",a,"]"),l,n.def(r,"[",o("dst","Alpha"),"]")]}));case go:return a((function(n){return"string"==typeof n?(nt.commandParameter(n,v,"invalid "+t,e.commandStr),[v[n],v[n]]):"object"==typeof n?(nt.commandParameter(n.rgb,v,t+".rgb",e.commandStr),nt.commandParameter(n.alpha,v,t+".alpha",e.commandStr),[v[n.rgb],v[n.alpha]]):void nt.commandRaise("invalid blend.equation",e.commandStr)}),(function(e,n,i){var r=e.constants.blendEquations,o=n.def(),s=n.def(),a=e.cond("typeof ",i,'==="string"');return nt.optional((function(){function n(t,n,i){e.assert(t,i+" in "+r,"invalid "+n+", must be one of "+Object.keys(v))}n(a.then,t,i),e.assert(a.else,i+"&&typeof "+i+'==="object"',"invalid "+t),n(a.else,t+".rgb",i+".rgb"),n(a.else,t+".alpha",i+".alpha")})),a.then(o,"=",s,"=",r,"[",i,"];"),a.else(o,"=",r,"[",i,".rgb];",s,"=",r,"[",i,".alpha];"),n(a),[o,s]}));case bo:return a((function(t){return nt.command(fn(t)&&4===t.length,"blend.color must be a 4d array",e.commandStr),It(4,(function(e){return+t[e]}))}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","blend.color must be a 4d array")})),It(4,(function(t){return e.def("+",n,"[",t,"]")}))}));case Eo:return a((function(t){return nt.commandType(t,"number",s,e.commandStr),0|t}),(function(t,e,n){return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"',"invalid stencil.mask")})),e.def(n,"|0")}));case Lo:return a((function(n){nt.commandType(n,"object",s,e.commandStr);var i=n.cmp||"keep",r=n.ref||0,o="mask"in n?n.mask:-1;return nt.commandParameter(i,na,t+".cmp",e.commandStr),nt.commandType(r,"number",t+".ref",e.commandStr),nt.commandType(o,"number",t+".mask",e.commandStr),[na[i],r,o]}),(function(t,e,n){var i=t.constants.compareFuncs;return nt.optional((function(){function r(){t.assert(e,Array.prototype.join.call(arguments,""),"invalid stencil.func")}r(n+"&&typeof ",n,'==="object"'),r('!("cmp" in ',n,")||(",n,".cmp in ",i,")")})),[e.def('"cmp" in ',n,"?",i,"[",n,".cmp]",":",Hs),e.def(n,".ref|0"),e.def('"mask" in ',n,"?",n,".mask|0:-1")]}));case No:case jo:return a((function(n){nt.commandType(n,"object",s,e.commandStr);var i=n.fail||"keep",r=n.zfail||"keep",o=n.zpass||"keep";return nt.commandParameter(i,ia,t+".fail",e.commandStr),nt.commandParameter(r,ia,t+".zfail",e.commandStr),nt.commandParameter(o,ia,t+".zpass",e.commandStr),[t===jo?Vs:Rs,ia[i],ia[r],ia[o]]}),(function(e,n,i){var r=e.constants.stencilOps;function o(o){return nt.optional((function(){e.assert(n,'!("'+o+'" in '+i+")||("+i+"."+o+" in "+r+")","invalid "+t+"."+o+", must be one of "+Object.keys(ia))})),n.def('"',o,'" in ',i,"?",r,"[",i,".",o,"]:",Hs)}return nt.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)})),[t===jo?Vs:Rs,o("fail"),o("zfail"),o("zpass")]}));case Do:return a((function(t){nt.commandType(t,"object",s,e.commandStr);var n=0|t.factor,i=0|t.units;return nt.commandType(n,"number",s+".factor",e.commandStr),nt.commandType(i,"number",s+".units",e.commandStr),[n,i]}),(function(e,n,i){return nt.optional((function(){e.assert(n,i+"&&typeof "+i+'==="object"',"invalid "+t)})),[n.def(i,".factor|0"),n.def(i,".units|0")]}));case Co:return a((function(t){var n=0;return"front"===t?n=Rs:"back"===t&&(n=Vs),nt.command(!!n,s,e.commandStr),n}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+'==="front"||'+n+'==="back"',"invalid cull.face")})),e.def(n,'==="front"?',Rs,":",Vs)}));case ko:return a((function(t){return nt.command("number"==typeof t&&t>=r.lineWidthDims[0]&&t<=r.lineWidthDims[1],"invalid line width, must be a positive number between "+r.lineWidthDims[0]+" and "+r.lineWidthDims[1],e.commandStr),t}),(function(t,e,n){return nt.optional((function(){t.assert(e,"typeof "+n+'==="number"&&'+n+">="+r.lineWidthDims[0]+"&&"+n+"<="+r.lineWidthDims[1],"invalid line width")})),n}));case Po:return a((function(t){return nt.commandParameter(t,oa,s,e.commandStr),oa[t]}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+'==="cw"||'+n+'==="ccw"',"invalid frontFace, must be one of cw,ccw")})),e.def(n+'==="cw"?'+Us+":"+$s)}));case To:return a((function(t){return nt.command(fn(t)&&4===t.length,"color.mask must be length 4 array",e.commandStr),t.map((function(t){return!!t}))}),(function(t,e,n){return nt.optional((function(){t.assert(e,t.shared.isArrayLike+"("+n+")&&"+n+".length===4","invalid color.mask")})),It(4,(function(t){return"!!"+n+"["+t+"]"}))}));case Mo:return a((function(t){nt.command("object"==typeof t&&t,s,e.commandStr);var n="value"in t?t.value:1,i=!!t.invert;return nt.command("number"==typeof n&&n>=0&&n<=1,"sample.coverage.value must be a number between 0 and 1",e.commandStr),[n,i]}),(function(t,e,n){return nt.optional((function(){t.assert(e,n+"&&typeof "+n+'==="object"',"invalid sample.coverage")})),[e.def('"value" in ',n,"?+",n,".value:1"),e.def("!!",n,".invert")]}))}})),o}function R(t,e){var n=t.static,i=t.dynamic,r={};return Object.keys(n).forEach((function(t){var i,o=n[t];if("number"==typeof o||"boolean"==typeof o)i=ca((function(){return o}));else if("function"==typeof o){var s=o._reglType;"texture2d"===s||"textureCube"===s?i=ca((function(t){return t.link(o)})):"framebuffer"===s||"framebufferCube"===s?(nt.command(o.color.length>0,'missing color attachment for framebuffer sent to uniform "'+t+'"',e.commandStr),i=ca((function(t){return t.link(o.color[0])}))):nt.commandRaise('invalid data for uniform "'+t+'"',e.commandStr)}else fn(o)?i=ca((function(e){return e.global.def("[",It(o.length,(function(n){return nt.command("number"==typeof o[n]||"boolean"==typeof o[n],"invalid uniform "+t,e.commandStr),o[n]})),"]")})):nt.commandRaise('invalid or missing data for uniform "'+t+'"',e.commandStr);i.value=o,r[t]=i})),Object.keys(i).forEach((function(t){var e=i[t];r[t]=ha(e,(function(t,n){return t.invoke(n,e)}))})),r}function V(t,e){var i=t.static,r=t.dynamic,s={};return Object.keys(i).forEach((function(t){var r=i[t],a=n.id(t),u=new y;if(sa(r))u.state=so,u.buffer=o.getBuffer(o.create(r,ls,!1,!0)),u.type=0;else{var l=o.getBuffer(r);if(l)u.state=so,u.buffer=l,u.type=0;else if(nt.command("object"==typeof r&&r,"invalid data for attribute "+t,e.commandStr),"constant"in r){var c=r.constant;u.buffer="null",u.state=ao,"number"==typeof c?u.x=c:(nt.command(fn(c)&&c.length>0&&c.length<=4,"invalid constant for attribute "+t,e.commandStr),ro.forEach((function(t,e){e<c.length&&(u[t]=c[e])})))}else{l=sa(r.buffer)?o.getBuffer(o.create(r.buffer,ls,!1,!0)):o.getBuffer(r.buffer),nt.command(!!l,'missing buffer for attribute "'+t+'"',e.commandStr);var h=0|r.offset;nt.command(h>=0,'invalid offset for attribute "'+t+'"',e.commandStr);var f=0|r.stride;nt.command(f>=0&&f<256,'invalid stride for attribute "'+t+'", must be integer betweeen [0, 255]',e.commandStr);var d=0|r.size;nt.command(!("size"in r)||d>0&&d<=4,'invalid size for attribute "'+t+'", must be 1,2,3,4',e.commandStr);var p=!!r.normalized,m=0;"type"in r&&(nt.commandParameter(r.type,Fe,"invalid type for attribute "+t,e.commandStr),m=Fe[r.type]);var v=0|r.divisor;nt.optional((function(){"divisor"in r&&(nt.command(0===v||b,'cannot specify divisor for attribute "'+t+'", instancing not supported',e.commandStr),nt.command(v>=0,'invalid divisor for attribute "'+t+'"',e.commandStr));var n=e.commandStr,i=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(r).forEach((function(e){nt.command(i.indexOf(e)>=0,'unknown parameter "'+e+'" for attribute pointer "'+t+'" (valid parameters are '+i+")",n)}))})),u.buffer=l,u.state=so,u.size=d,u.normalized=p,u.type=m||l.dtype,u.offset=h,u.stride=f,u.divisor=v}}s[t]=ca((function(t,e){var n=t.attribCache;if(a in n)return n[a];var i={isStream:!1};return Object.keys(u).forEach((function(t){i[t]=u[t]})),u.buffer&&(i.buffer=t.link(u.buffer),i.type=i.type||i.buffer+".dtype"),n[a]=i,i}))})),Object.keys(r).forEach((function(t){var e=r[t];function n(n,i){var r=n.invoke(i,e),o=n.shared,s=n.constants,a=o.isBufferArgs,u=o.buffer;nt.optional((function(){n.assert(i,r+"&&(typeof "+r+'==="object"||typeof '+r+'==="function")&&('+a+"("+r+")||"+u+".getBuffer("+r+")||"+u+".getBuffer("+r+".buffer)||"+a+"("+r+'.buffer)||("constant" in '+r+"&&(typeof "+r+'.constant==="number"||'+o.isArrayLike+"("+r+".constant))))",'invalid dynamic attribute "'+t+'"')}));var l={isStream:i.def(!1)},c=new y;c.state=so,Object.keys(c).forEach((function(t){l[t]=i.def(""+c[t])}));var h=l.buffer,f=l.type;function d(t){i(l[t],"=",r,".",t,"|0;")}return i("if(",a,"(",r,")){",l.isStream,"=true;",h,"=",u,".createStream(",ls,",",r,");",f,"=",h,".dtype;","}else{",h,"=",u,".getBuffer(",r,");","if(",h,"){",f,"=",h,".dtype;",'}else if("constant" in ',r,"){",l.state,"=",ao,";","if(typeof "+r+'.constant === "number"){',l[ro[0]],"=",r,".constant;",ro.slice(1).map((function(t){return l[t]})).join("="),"=0;","}else{",ro.map((function(t,e){return l[t]+"="+r+".constant.length>"+e+"?"+r+".constant["+e+"]:0;"})).join(""),"}}else{","if(",a,"(",r,".buffer)){",h,"=",u,".createStream(",ls,",",r,".buffer);","}else{",h,"=",u,".getBuffer(",r,".buffer);","}",f,'="type" in ',r,"?",s.glTypes,"[",r,".type]:",h,".dtype;",l.normalized,"=!!",r,".normalized;"),d("size"),d("offset"),d("stride"),d("divisor"),i("}}"),i.exit("if(",l.isStream,"){",u,".destroyStream(",h,");","}"),l}s[t]=ha(e,n)})),s}function U(t){var e=t.static,n=t.dynamic,i={};return Object.keys(e).forEach((function(t){var n=e[t];i[t]=ca((function(t,e){return"number"==typeof n||"boolean"==typeof n?""+n:t.link(n)}))})),Object.keys(n).forEach((function(t){var e=n[t];i[t]=ha(e,(function(t,n){return t.invoke(n,e)}))})),i}function $(t,e,n,r,o){var s=t.static,a=t.dynamic;nt.optional((function(){var t=[Wo,qo,Go,Ho,Yo,Zo,Xo,Ko,$o,Qo].concat(S);function e(e){Object.keys(e).forEach((function(e){nt.command(t.indexOf(e)>=0,'unknown parameter "'+e+'"',o.commandStr)}))}e(s),e(a)}));var u=E(t,e),l=M(t),h=B(t,l,o),f=N(t,o),d=j(t,o),p=L(t,o,u);function m(t){var e=h[t];e&&(d[t]=e)}m(Uo),m(I(Vo));var y=Object.keys(d).length>0,v={framebuffer:l,draw:f,shader:p,state:d,dirty:y,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(v.profile=F(t),v.uniforms=R(n,o),v.drawVAO=v.scopeVAO=f.vao,!v.drawVAO&&p.program&&!u&&i.angle_instanced_arrays&&f.static.elements){var b=!0,g=p.program.attributes.map((function(t){var n=e.static[t];return b=b&&!!n,n}));if(b&&g.length>0){var x=c.getVAO(c.createVAO({attributes:g,elements:f.static.elements}));v.drawVAO=new ua(null,null,null,(function(t,e){return t.link(x)})),v.useVAO=!0}}return u?v.useVAO=!0:v.attributes=V(e,o),v.context=U(r),v}function W(t,e,n){var i=t.shared.context,r=t.scope();Object.keys(n).forEach((function(o){e.save(i,"."+o);var s=n[o].append(t,e);Array.isArray(s)?r(i,".",o,"=[",s.join(),"];"):r(i,".",o,"=",s,";")})),e(r)}function q(t,e,n,i){var r,o=t.shared,s=o.gl,a=o.framebuffer;g&&(r=e.def(o.extensions,".webgl_draw_buffers"));var u,l=t.constants,c=l.drawBuffer,h=l.backBuffer;u=n?n.append(t,e):e.def(a,".next"),i||e("if(",u,"!==",a,".cur){"),e("if(",u,"){",s,".bindFramebuffer(",Qs,",",u,".framebuffer);"),g&&e(r,".drawBuffersWEBGL(",c,"[",u,".colorAttachments.length]);"),e("}else{",s,".bindFramebuffer(",Qs,",null);"),g&&e(r,".drawBuffersWEBGL(",h,");"),e("}",a,".cur=",u,";"),i||e("}")}function G(t,e,n){var i=t.shared,r=i.gl,o=t.current,s=t.next,a=i.current,u=i.next,l=t.cond(a,".dirty");S.forEach((function(e){var i,c,h=I(e);if(!(h in n.state))if(h in s){i=s[h],c=o[h];var f=It(w[h].length,(function(t){return l.def(i,"[",t,"]")}));l(t.cond(f.map((function(t,e){return t+"!=="+c+"["+e+"]"})).join("||")).then(r,".",T[h],"(",f,");",f.map((function(t,e){return c+"["+e+"]="+t})).join(";"),";"))}else{i=l.def(u,".",h);var d=t.cond(i,"!==",a,".",h);l(d),h in A?d(t.cond(i).then(r,".enable(",A[h],");").else(r,".disable(",A[h],");"),a,".",h,"=",i,";"):d(r,".",T[h],"(",i,");",a,".",h,"=",i,";")}})),0===Object.keys(n.state).length&&l(a,".dirty=false;"),e(l)}function H(t,e,n,i){var r=t.shared,o=t.current,s=r.current,a=r.gl;aa(Object.keys(n)).forEach((function(r){var u=n[r];if(!i||i(u)){var l=u.append(t,e);if(A[r]){var c=A[r];la(u)?e(a,l?".enable(":".disable(",c,");"):e(t.cond(l).then(a,".enable(",c,");").else(a,".disable(",c,");")),e(s,".",r,"=",l,";")}else if(fn(l)){var h=o[r];e(a,".",T[r],"(",l,");",l.map((function(t,e){return h+"["+e+"]="+t})).join(";"),";")}else e(a,".",T[r],"(",l,");",s,".",r,"=",l,";")}}))}function Y(t,e){b&&(t.instancing=e.def(t.shared.extensions,".angle_instanced_arrays"))}function X(t,e,n,i,r){var o,s,a,u=t.shared,l=t.stats,c=u.current,h=u.timer,f=n.profile;function d(){return typeof performance>"u"?"Date.now()":"performance.now()"}function m(t){t(o=e.def(),"=",d(),";"),"string"==typeof r?t(l,".count+=",r,";"):t(l,".count++;"),p&&(i?t(s=e.def(),"=",h,".getNumPendingQueries();"):t(h,".beginQuery(",l,");"))}function y(t){t(l,".cpuTime+=",d(),"-",o,";"),p&&(i?t(h,".pushScopeStats(",s,",",h,".getNumPendingQueries(),",l,");"):t(h,".endQuery();"))}function v(t){var n=e.def(c,".profile");e(c,".profile=",t,";"),e.exit(c,".profile=",n,";")}if(f){if(la(f))return void(f.enable?(m(e),y(e.exit),v("true")):v("false"));v(a=f.append(t,e))}else a=e.def(c,".profile");var b=t.block();m(b),e("if(",a,"){",b,"}");var g=t.block();y(g),e.exit("if(",a,"){",g,"}")}function Z(t,e,n,i,r){var o=t.shared;function s(t){switch(t){case Ss:case Cs:case Ds:return 2;case As:case Ps:case Os:return 3;case Ts:case ks:case Fs:return 4;default:return 1}}function a(n,i,r){var s=o.gl,a=e.def(n,".location"),u=e.def(o.attributes,"[",a,"]"),l=r.state,c=r.buffer,h=[r.x,r.y,r.z,r.w],f=["buffer","normalized","offset","stride"];function d(){e("if(!",u,".buffer){",s,".enableVertexAttribArray(",a,");}");var n,o=r.type;if(n=r.size?e.def(r.size,"||",i):i,e("if(",u,".type!==",o,"||",u,".size!==",n,"||",f.map((function(t){return u+"."+t+"!=="+r[t]})).join("||"),"){",s,".bindBuffer(",ls,",",c,".buffer);",s,".vertexAttribPointer(",[a,n,o,r.normalized,r.stride,r.offset],");",u,".type=",o,";",u,".size=",n,";",f.map((function(t){return u+"."+t+"="+r[t]+";"})).join(""),"}"),b){var l=r.divisor;e("if(",u,".divisor!==",l,"){",t.instancing,".vertexAttribDivisorANGLE(",[a,l],");",u,".divisor=",l,";}")}}function p(){e("if(",u,".buffer){",s,".disableVertexAttribArray(",a,");",u,".buffer=null;","}if(",ro.map((function(t,e){return u+"."+t+"!=="+h[e]})).join("||"),"){",s,".vertexAttrib4f(",a,",",h,");",ro.map((function(t,e){return u+"."+t+"="+h[e]+";"})).join(""),"}")}l===so?d():l===ao?p():(e("if(",l,"===",so,"){"),d(),e("}else{"),p(),e("}"))}i.forEach((function(i){var o,u=i.name,l=n.attributes[u];if(l){if(!r(l))return;o=l.append(t,e)}else{if(!r(fa))return;var c=t.scopeAttrib(u);nt.optional((function(){t.assert(e,c+".state","missing attribute "+u)})),o={},Object.keys(new y).forEach((function(t){o[t]=e.def(c,".",t)}))}a(t.link(i),s(i.info.type),o)}))}function K(t,e,i,r,o,s){for(var a,u=t.shared,l=u.gl,c={},h=0;h<r.length;++h){var f=r[h],d=f.name,p=f.info.type,m=f.info.size,y=i.uniforms[d];if(m>1){if(!y)continue;var v=d.replace("[0]","");if(c[v])continue;c[v]=1}var b,g=t.link(f)+".location";if(y){if(!o(y))continue;if(la(y)){var x=y.value;if(nt.command(null!==x&&typeof x<"u",'missing uniform "'+d+'"',t.commandStr),p===Ls||p===Ns){nt.command("function"==typeof x&&(p===Ls&&("texture2d"===x._reglType||"framebuffer"===x._reglType)||p===Ns&&("textureCube"===x._reglType||"framebufferCube"===x._reglType)),"invalid texture for uniform "+d,t.commandStr);var w=t.link(x._texture||x.color[0]._texture);e(l,".uniform1i(",g,",",w+".bind());"),e.exit(w,".unbind();")}else if(p===Ms||p===Bs||p===Es){nt.optional((function(){nt.command(fn(x),"invalid matrix for uniform "+d,t.commandStr),nt.command(p===Ms&&4===x.length||p===Bs&&9===x.length||p===Es&&16===x.length,"invalid length for matrix uniform "+d,t.commandStr)}));var _=t.global.def("new Float32Array(["+Array.prototype.slice.call(x)+"])"),S=2;p===Bs?S=3:p===Es&&(S=4),e(l,".uniformMatrix",S,"fv(",g,",false,",_,");")}else{switch(p){case _s:1===m?nt.commandType(x,"number","uniform "+d,t.commandStr):nt.command(fn(x)&&x.length===m,"uniform "+d,t.commandStr),a="1f";break;case Ss:nt.command(fn(x)&&x.length&&x.length%2===0&&x.length<=2*m,"uniform "+d,t.commandStr),a="2f";break;case As:nt.command(fn(x)&&x.length&&x.length%3===0&&x.length<=3*m,"uniform "+d,t.commandStr),a="3f";break;case Ts:nt.command(fn(x)&&x.length&&x.length%4===0&&x.length<=4*m,"uniform "+d,t.commandStr),a="4f";break;case zs:1===m?nt.commandType(x,"boolean","uniform "+d,t.commandStr):nt.command(fn(x)&&x.length===m,"uniform "+d,t.commandStr),a="1i";break;case Is:1===m?nt.commandType(x,"number","uniform "+d,t.commandStr):nt.command(fn(x)&&x.length===m,"uniform "+d,t.commandStr),a="1i";break;case Ds:case Cs:nt.command(fn(x)&&x.length&&x.length%2===0&&x.length<=2*m,"uniform "+d,t.commandStr),a="2i";break;case Os:case Ps:nt.command(fn(x)&&x.length&&x.length%3===0&&x.length<=3*m,"uniform "+d,t.commandStr),a="3i";break;case Fs:case ks:nt.command(fn(x)&&x.length&&x.length%4===0&&x.length<=4*m,"uniform "+d,t.commandStr),a="4i"}m>1?(a+="v",x=t.global.def("["+Array.prototype.slice.call(x)+"]")):x=fn(x)?Array.prototype.slice.call(x):x,e(l,".uniform",a,"(",g,",",x,");")}continue}b=y.append(t,e)}else{if(!o(fa))continue;b=e.def(u.uniforms,"[",n.id(d),"]")}p===Ls?(nt(!Array.isArray(b),"must specify a scalar prop for textures"),e("if(",b,"&&",b,'._reglType==="framebuffer"){',b,"=",b,".color[0];","}")):p===Ns&&(nt(!Array.isArray(b),"must specify a scalar prop for cube maps"),e("if(",b,"&&",b,'._reglType==="framebufferCube"){',b,"=",b,".color[0];","}")),nt.optional((function(){function n(n,i){t.assert(e,n,'bad data or missing for uniform "'+d+'".  '+i)}function i(t,e){1===e&&nt(!Array.isArray(b),"must not specify an array type for uniform"),n("Array.isArray("+b+") && typeof "+b+'[0]===" '+t+'" || typeof '+b+'==="'+t+'"',"invalid type, expected "+t)}function r(e,i,r){Array.isArray(b)?nt(b.length&&b.length%e===0&&b.length<=e*r,"must have length of "+(1===r?"":"n * ")+e):n(u.isArrayLike+"("+b+")&&"+b+".length && "+b+".length % "+e+" === 0 && "+b+".length<="+e*r,"invalid vector, should have length of "+(1===r?"":"n * ")+e,t.commandStr)}function o(e){nt(!Array.isArray(b),"must not specify a value type"),n("typeof "+b+'==="function"&&'+b+'._reglType==="texture'+(e===hs?"2d":"Cube")+'"',"invalid texture type",t.commandStr)}switch(p){case Is:i("number",m);break;case Cs:r(2,"number",m);break;case Ps:r(3,"number",m);break;case ks:r(4,"number",m);break;case _s:i("number",m);break;case Ss:r(2,"number",m);break;case As:r(3,"number",m);break;case Ts:r(4,"number",m);break;case zs:i("boolean",m);break;case Ds:r(2,"boolean",m);break;case Os:r(3,"boolean",m);break;case Fs:r(4,"boolean",m);break;case Ms:r(4,"number",m);break;case Bs:r(9,"number",m);break;case Es:r(16,"number",m);break;case Ls:o(hs);break;case Ns:o(fs)}}));var A=1;switch(p){case Ls:case Ns:var T=e.def(b,"._texture");e(l,".uniform1i(",g,",",T,".bind());"),e.exit(T,".unbind();");continue;case Is:case zs:a="1i";break;case Cs:case Ds:a="2i",A=2;break;case Ps:case Os:a="3i",A=3;break;case ks:case Fs:a="4i",A=4;break;case _s:a="1f";break;case Ss:a="2f",A=2;break;case As:a="3f",A=3;break;case Ts:a="4f",A=4;break;case Ms:a="Matrix2fv";break;case Bs:a="Matrix3fv";break;case Es:a="Matrix4fv"}if(-1===a.indexOf("Matrix")&&m>1&&(a+="v",A=1),"M"===a.charAt(0)){e(l,".uniform",a,"(",g,",");var I=Math.pow(p-Ms+2,2),C=t.global.def("new Float32Array(",I,")");Array.isArray(b)?e("false,(",It(I,(function(t){return C+"["+t+"]="+b[t]})),",",C,")"):e("false,(Array.isArray(",b,")||",b," instanceof Float32Array)?",b,":(",It(I,(function(t){return C+"["+t+"]="+b+"["+t+"]"})),",",C,")"),e(");")}else if(A>1){for(var P=[],k=[],z=0;z<A;++z)Array.isArray(b)?k.push(b[z]):k.push(e.def(b+"["+z+"]")),s&&P.push(e.def());s&&e("if(!",t.batchId,"||",P.map((function(t,e){return t+"!=="+k[e]})).join("||"),"){",P.map((function(t,e){return t+"="+k[e]+";"})).join("")),e(l,".uniform",a,"(",g,",",k.join(","),");"),s&&e("}")}else{if(nt(!Array.isArray(b),"uniform value must not be an array"),s){var D=e.def();e("if(!",t.batchId,"||",D,"!==",b,"){",D,"=",b,";")}e(l,".uniform",a,"(",g,",",b,");"),s&&e("}")}}}function Q(t,e,n,i){var r=t.shared,o=r.gl,s=r.draw,a=i.draw;function u(){var u,l=a.elements,c=e;return l?((l.contextDep&&i.contextDynamic||l.propDep)&&(c=n),u=l.append(t,c),a.elementsActive&&c("if("+u+")"+o+".bindBuffer("+cs+","+u+".buffer.buffer);")):(u=c.def(),c(u,"=",s,".",Ho,";","if(",u,"){",o,".bindBuffer(",cs,",",u,".buffer.buffer);}","else if(",r.vao,".currentVAO){",u,"=",t.shared.elements+".getElements("+r.vao,".currentVAO.elements);",x?"":"if("+u+")"+o+".bindBuffer("+cs+","+u+".buffer.buffer);","}")),u}function l(){var r,o=a.count,u=e;return o?((o.contextDep&&i.contextDynamic||o.propDep)&&(u=n),r=o.append(t,u),nt.optional((function(){o.MISSING&&t.assert(e,"false","missing vertex count"),o.DYNAMIC&&t.assert(u,r+">=0","missing vertex count")}))):(r=u.def(s,".",Xo),nt.optional((function(){t.assert(u,r+">=0","missing vertex count")}))),r}var c=u();function h(r){var o=a[r];return o?o.contextDep&&i.contextDynamic||o.propDep?o.append(t,n):o.append(t,e):e.def(s,".",r)}var f,d,p=h(Yo),m=h(Zo),y=l();if("number"==typeof y){if(0===y)return}else n("if(",y,"){"),n.exit("}");b&&(f=h(Ko),d=t.instancing);var v=c+".type",g=a.elements&&la(a.elements)&&!a.vaoActive;function w(){function t(){n(d,".drawElementsInstancedANGLE(",[p,y,v,m+"<<(("+v+"-"+oo+")>>1)",f],");")}function e(){n(d,".drawArraysInstancedANGLE(",[p,m,y,f],");")}c&&"null"!==c?g?t():(n("if(",c,"){"),t(),n("}else{"),e(),n("}")):e()}function _(){function t(){n(o+".drawElements("+[p,y,v,m+"<<(("+v+"-"+oo+")>>1)"]+");")}function e(){n(o+".drawArrays("+[p,m,y]+");")}c&&"null"!==c?g?t():(n("if(",c,"){"),t(),n("}else{"),e(),n("}")):e()}b&&("number"!=typeof f||f>=0)?"string"==typeof f?(n("if(",f,">0){"),w(),n("}else if(",f,"<0){"),_(),n("}")):w():_()}function J(t,e,n,i,r){var o=O(),s=o.proc("body",r);return nt.optional((function(){o.commandStr=e.commandStr,o.command=o.link(e.commandStr)})),b&&(o.instancing=s.def(o.shared.extensions,".angle_instanced_arrays")),t(o,s,n,i),o.compile().body}function tt(t,e,n,i){Y(t,e),n.useVAO?n.drawVAO?e(t.shared.vao,".setVAO(",n.drawVAO.append(t,e),");"):e(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(e(t.shared.vao,".setVAO(null);"),Z(t,e,n,i.attributes,(function(){return!0}))),K(t,e,n,i.uniforms,(function(){return!0}),!1),Q(t,e,e,n)}function et(t,e){var n=t.proc("draw",1);Y(t,n),W(t,n,e.context),q(t,n,e.framebuffer),G(t,n,e),H(t,n,e.state),X(t,n,e,!1,!0);var i=e.shader.progVar.append(t,n);if(n(t.shared.gl,".useProgram(",i,".program);"),e.shader.program)tt(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var r=t.global.def("{}"),o=n.def(i,".id"),s=n.def(r,"[",o,"]");n(t.cond(s).then(s,".call(this,a0);").else(s,"=",r,"[",o,"]=",t.link((function(n){return J(tt,t,e,n,1)})),"(",i,");",s,".call(this,a0);"))}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}function it(t,e,n,i){function r(){return!0}t.batchId="a1",Y(t,e),Z(t,e,n,i.attributes,r),K(t,e,n,i.uniforms,r,!1),Q(t,e,e,n)}function rt(t,e,n,i){Y(t,e);var r=n.contextDep,o=e.def(),s="a0",a="a1",u=e.def();t.shared.props=u,t.batchId=o;var l=t.scope(),c=t.scope();function h(t){return t.contextDep&&r||t.propDep}function f(t){return!h(t)}if(e(l.entry,"for(",o,"=0;",o,"<",a,";++",o,"){",u,"=",s,"[",o,"];",c,"}",l.exit),n.needsContext&&W(t,c,n.context),n.needsFramebuffer&&q(t,c,n.framebuffer),H(t,c,n.state,h),n.profile&&h(n.profile)&&X(t,c,n,!1,!0),i)n.useVAO?n.drawVAO?h(n.drawVAO)?c(t.shared.vao,".setVAO(",n.drawVAO.append(t,c),");"):l(t.shared.vao,".setVAO(",n.drawVAO.append(t,l),");"):l(t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"):(l(t.shared.vao,".setVAO(null);"),Z(t,l,n,i.attributes,f),Z(t,c,n,i.attributes,h)),K(t,l,n,i.uniforms,f,!1),K(t,c,n,i.uniforms,h,!0),Q(t,l,c,n);else{var d=t.global.def("{}"),p=n.shader.progVar.append(t,c),m=c.def(p,".id"),y=c.def(d,"[",m,"]");c(t.shared.gl,".useProgram(",p,".program);","if(!",y,"){",y,"=",d,"[",m,"]=",t.link((function(e){return J(it,t,n,e,2)})),"(",p,");}",y,".call(this,a0[",o,"],",o,");")}}function ot(t,e){var n=t.proc("batch",2);t.batchId="0",Y(t,n);var i=!1,r=!0;Object.keys(e.context).forEach((function(t){i=i||e.context[t].propDep})),i||(W(t,n,e.context),r=!1);var o=e.framebuffer,s=!1;function a(t){return t.contextDep&&i||t.propDep}o?(o.propDep?i=s=!0:o.contextDep&&i&&(s=!0),s||q(t,n,o)):q(t,n,null),e.state.viewport&&e.state.viewport.propDep&&(i=!0),G(t,n,e),H(t,n,e.state,(function(t){return!a(t)})),(!e.profile||!a(e.profile))&&X(t,n,e,!1,"a1"),e.contextDep=i,e.needsContext=r,e.needsFramebuffer=s;var u=e.shader.progVar;if(u.contextDep&&i||u.propDep)rt(t,n,e,null);else{var l=u.append(t,n);if(n(t.shared.gl,".useProgram(",l,".program);"),e.shader.program)rt(t,n,e,e.shader.program);else{n(t.shared.vao,".setVAO(null);");var c=t.global.def("{}"),h=n.def(l,".id"),f=n.def(c,"[",h,"]");n(t.cond(f).then(f,".call(this,a0,a1);").else(f,"=",c,"[",h,"]=",t.link((function(n){return J(rt,t,e,n,2)})),"(",l,");",f,".call(this,a0,a1);"))}}Object.keys(e.state).length>0&&n(t.shared.current,".dirty=true;"),t.shared.vao&&n(t.shared.vao,".setVAO(null);")}function st(t,e){var i=t.proc("scope",3);t.batchId="a2";var r=t.shared,o=r.current;function s(n){var o=e.shader[n];o&&i.set(r.shader,"."+n,o.append(t,i))}W(t,i,e.context),e.framebuffer&&e.framebuffer.append(t,i),aa(Object.keys(e.state)).forEach((function(n){var o=e.state[n].append(t,i);fn(o)?o.forEach((function(e,r){i.set(t.next[n],"["+r+"]",e)})):i.set(r.next,"."+n,o)})),X(t,i,e,!0,!0),[Ho,Zo,Xo,Ko,Yo].forEach((function(n){var o=e.draw[n];o&&i.set(r.draw,"."+n,""+o.append(t,i))})),Object.keys(e.uniforms).forEach((function(o){var s=e.uniforms[o].append(t,i);Array.isArray(s)&&(s="["+s.join()+"]"),i.set(r.uniforms,"["+n.id(o)+"]",s)})),Object.keys(e.attributes).forEach((function(n){var r=e.attributes[n].append(t,i),o=t.scopeAttrib(n);Object.keys(new y).forEach((function(t){i.set(o,"."+t,r[t])}))})),e.scopeVAO&&i.set(r.vao,".targetVAO",e.scopeVAO.append(t,i)),s(qo),s(Go),Object.keys(e.state).length>0&&(i(o,".dirty=true;"),i.exit(o,".dirty=true;")),i("a1(",t.shared.context,",a0,",t.batchId,");")}function at(t){if("object"==typeof t&&!fn(t)){for(var e=Object.keys(t),n=0;n<e.length;++n)if(pt.isDynamic(t[e[n]]))return!0;return!1}}function ut(t,e,n){var i=e.static[n];if(i&&at(i)){var r=t.global,o=Object.keys(i),s=!1,a=!1,u=!1,l=t.global.def("{}");o.forEach((function(e){var n=i[e];if(pt.isDynamic(n)){"function"==typeof n&&(n=i[e]=pt.unbox(n));var o=ha(n,null);s=s||o.thisDep,u=u||o.propDep,a=a||o.contextDep}else{switch(r(l,".",e,"="),typeof n){case"number":r(n);break;case"string":r('"',n,'"');break;case"object":Array.isArray(n)&&r("[",n.join(),"]");break;default:r(t.link(n))}r(";")}})),e.dynamic[n]=new pt.DynamicVariable(fo,{thisDep:s,contextDep:a,propDep:u,ref:l,append:c}),delete e.static[n]}function c(t,e){o.forEach((function(n){var r=i[n];if(pt.isDynamic(r)){var o=t.invoke(e,r);e(l,".",n,"=",o,";")}}))}}function lt(t,n,i,r,o){var s=O();s.stats=s.link(o),Object.keys(n.static).forEach((function(t){ut(s,n,t)})),us.forEach((function(e){ut(s,t,e)}));var a=$(t,n,i,r,s);return et(s,a),st(s,a),ot(s,a),e(s.compile(),{destroy:function(){a.shader.program.destroy()}})}return{next:_,current:w,procs:function(){var t=O(),e=t.proc("poll"),n=t.proc("refresh"),o=t.block();e(o),n(o);var s,a=t.shared,u=a.gl,l=a.next,c=a.current;o(c,".dirty=false;"),q(t,e),q(t,n,null,!0),b&&(s=t.link(b)),i.oes_vertex_array_object&&n(t.link(i.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var h=0;h<r.maxAttributes;++h){var f=n.def(a.attributes,"[",h,"]"),d=t.cond(f,".buffer");d.then(u,".enableVertexAttribArray(",h,");",u,".bindBuffer(",ls,",",f,".buffer.buffer);",u,".vertexAttribPointer(",h,",",f,".size,",f,".type,",f,".normalized,",f,".stride,",f,".offset);").else(u,".disableVertexAttribArray(",h,");",u,".vertexAttrib4f(",h,",",f,".x,",f,".y,",f,".z,",f,".w);",f,".buffer=null;"),n(d),b&&n(s,".vertexAttribDivisorANGLE(",h,",",f,".divisor);")}return n(t.shared.vao,".currentVAO=null;",t.shared.vao,".setVAO(",t.shared.vao,".targetVAO);"),Object.keys(A).forEach((function(i){var r=A[i],s=o.def(l,".",i),a=t.block();a("if(",s,"){",u,".enable(",r,")}else{",u,".disable(",r,")}",c,".",i,"=",s,";"),n(a),e("if(",s,"!==",c,".",i,"){",a,"}")})),Object.keys(T).forEach((function(i){var r,s,a=T[i],h=w[i],f=t.block();if(f(u,".",a,"("),fn(h)){var d=h.length;r=t.global.def(l,".",i),s=t.global.def(c,".",i),f(It(d,(function(t){return r+"["+t+"]"})),");",It(d,(function(t){return s+"["+t+"]="+r+"["+t+"];"})).join("")),e("if(",It(d,(function(t){return r+"["+t+"]!=="+s+"["+t+"]"})).join("||"),"){",f,"}")}else r=o.def(l,".",i),s=o.def(c,".",i),f(r,");",c,".",i,"=",r,";"),e("if(",r,"!==",s,"){",f,"}");n(f)})),t.compile()}(),compile:lt}}function pa(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var ma=34918,ya=34919,va=35007,ba=function(t,e){if(!e.ext_disjoint_timer_query)return null;var n=[];function i(){return n.pop()||e.ext_disjoint_timer_query.createQueryEXT()}function r(t){n.push(t)}var o=[];function s(t){var n=i();e.ext_disjoint_timer_query.beginQueryEXT(va,n),o.push(n),d(o.length-1,o.length,t)}function a(){e.ext_disjoint_timer_query.endQueryEXT(va)}function u(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var l=[];function c(){return l.pop()||new u}function h(t){l.push(t)}var f=[];function d(t,e,n){var i=c();i.startQueryIndex=t,i.endQueryIndex=e,i.sum=0,i.stats=n,f.push(i)}var p=[],m=[];function y(){var t,n,i=o.length;if(0!==i){m.length=Math.max(m.length,i+1),p.length=Math.max(p.length,i+1),p[0]=0,m[0]=0;var s=0;for(t=0,n=0;n<o.length;++n){var a=o[n];e.ext_disjoint_timer_query.getQueryObjectEXT(a,ya)?(s+=e.ext_disjoint_timer_query.getQueryObjectEXT(a,ma),r(a)):o[t++]=a,p[n+1]=s,m[n+1]=t}for(o.length=t,t=0,n=0;n<f.length;++n){var u=f[n],l=u.startQueryIndex,c=u.endQueryIndex;u.sum+=p[c]-p[l];var d=m[l],y=m[c];y===d?(u.stats.gpuTime+=u.sum/1e6,h(u)):(u.startQueryIndex=d,u.endQueryIndex=y,f[t++]=u)}f.length=t}}return{beginQuery:s,endQuery:a,pushScopeStats:d,update:y,getNumPendingQueries:function(){return o.length},clear:function(){n.push.apply(n,o);for(var t=0;t<n.length;t++)e.ext_disjoint_timer_query.deleteQueryEXT(n[t]);o.length=0,n.length=0},restore:function(){o.length=0,n.length=0}}},ga=16384,xa=256,wa=1024,_a=34962,Sa="webglcontextlost",Aa="webglcontextrestored",Ta=1,Ia=2,Ca=3;function Pa(t,e){for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}function ka(t){var n=At(t);if(!n)return null;var i=n.gl,r=i.getContextAttributes(),o=i.isContextLost(),s=Tt(i,n);if(!s)return null;var a=vt(),u=pa(),l=s.extensions,c=ba(i,l),h=yt(),f=i.drawingBufferWidth,d=i.drawingBufferHeight,p={tick:0,time:0,viewportWidth:f,viewportHeight:d,framebufferWidth:f,framebufferHeight:d,drawingBufferWidth:f,drawingBufferHeight:d,pixelRatio:n.pixelRatio},m={},y={elements:null,primitive:4,count:-1,offset:0,instances:-1},v=_e(i,l),b=Ge(i,u,n,w),g=an(i,l,b,u),x=Wr(i,l,v,u,b,g,y);function w(t){return x.destroyBuffer(t)}var _=Xr(i,a,u,n),S=Zi(i,l,v,(function(){I.procs.poll()}),p,u,n),A=cr(i,l,v,u,n),T=Nr(i,l,v,S,A,u),I=da(i,a,l,v,b,g,S,T,m,x,_,y,p,c,n),C=to(i,T,I.procs.poll,p,r,l,v),P=I.next,k=i.canvas,z=[],D=[],O=[],F=[n.onDestroy],M=null;function B(){if(0===z.length)return c&&c.update(),void(M=null);M=mt.next(B),H();for(var t=z.length-1;t>=0;--t){var e=z[t];e&&e(p,null,0)}i.flush(),c&&c.update()}function E(){!M&&z.length>0&&(M=mt.next(B))}function L(){M&&(mt.cancel(B),M=null)}function N(t){t.preventDefault(),o=!0,L(),D.forEach((function(t){t()}))}function j(t){i.getError(),o=!1,s.restore(),_.restore(),b.restore(),S.restore(),A.restore(),T.restore(),x.restore(),c&&c.restore(),I.procs.refresh(),E(),O.forEach((function(t){t()}))}function R(){z.length=0,L(),k&&(k.removeEventListener(Sa,N),k.removeEventListener(Aa,j)),_.clear(),T.clear(),A.clear(),x.clear(),S.clear(),g.clear(),b.clear(),c&&c.clear(),F.forEach((function(t){t()}))}function V(t){function n(t){var n=e({},t);function i(t){if(t in n){var e=n[t];delete n[t],Object.keys(e).forEach((function(i){n[t+"."+i]=e[i]}))}}return delete n.uniforms,delete n.attributes,delete n.context,delete n.vao,"stencil"in n&&n.stencil.op&&(n.stencil.opBack=n.stencil.opFront=n.stencil.op,delete n.stencil.op),i("blend"),i("depth"),i("cull"),i("stencil"),i("polygonOffset"),i("scissor"),i("sample"),"vao"in t&&(n.vao=t.vao),n}function i(t,e){var n={},i={};return Object.keys(t).forEach((function(r){var o=t[r];if(pt.isDynamic(o))i[r]=pt.unbox(o,r);else{if(e&&Array.isArray(o))for(var s=0;s<o.length;++s)if(pt.isDynamic(o[s]))return void(i[r]=pt.unbox(o,r));n[r]=o}})),{dynamic:i,static:n}}nt(!!t,"invalid args to regl({...})"),nt.type(t,"object","invalid args to regl({...})");var r=i(t.context||{},!0),s=i(t.uniforms||{},!0),a=i(t.attributes||{},!1),u=i(n(t),!1),l={gpuTime:0,cpuTime:0,count:0},c=I.compile(u,a,s,r,l),h=c.draw,f=c.batch,d=c.scope,p=[];function m(t){for(;p.length<t;)p.push(null);return p}function y(t,e){var n;if(o&&nt.raise("context lost"),"function"==typeof t)return d.call(this,null,t,0);if("function"==typeof e)if("number"==typeof t)for(n=0;n<t;++n)d.call(this,null,e,n);else{if(!Array.isArray(t))return d.call(this,t,e,0);for(n=0;n<t.length;++n)d.call(this,t[n],e,n)}else if("number"==typeof t){if(t>0)return f.call(this,m(0|t),0|t)}else{if(!Array.isArray(t))return h.call(this,t);if(t.length)return f.call(this,t,t.length)}}return e(y,{stats:l,destroy:function(){c.destroy()}})}k&&(k.addEventListener(Sa,N,!1),k.addEventListener(Aa,j,!1));var U=T.setFBO=V({framebuffer:pt.define.call(null,Ta,"framebuffer")});function $(t,e){var n=0;I.procs.poll();var r=e.color;r&&(i.clearColor(+r[0]||0,+r[1]||0,+r[2]||0,+r[3]||0),n|=ga),"depth"in e&&(i.clearDepth(+e.depth),n|=xa),"stencil"in e&&(i.clearStencil(0|e.stencil),n|=wa),nt(!!n,"called regl.clear with no buffer specified"),i.clear(n)}function W(t){if(nt("object"==typeof t&&t,"regl.clear() takes an object as input"),"framebuffer"in t)if(t.framebuffer&&"framebufferCube"===t.framebuffer_reglType)for(var n=0;n<6;++n)U(e({framebuffer:t.framebuffer.faces[n]},t),$);else U(t,$);else $(null,t)}function q(t){function e(){var e=Pa(z,t);function n(){var t=Pa(z,n);z[t]=z[z.length-1],z.length-=1,z.length<=0&&L()}nt(e>=0,"cannot cancel a frame twice"),z[e]=n}return nt.type(t,"function","regl.frame() callback must be a function"),z.push(t),E(),{cancel:e}}function G(){var t=P.viewport,e=P.scissor_box;t[0]=t[1]=e[0]=e[1]=0,p.viewportWidth=p.framebufferWidth=p.drawingBufferWidth=t[2]=e[2]=i.drawingBufferWidth,p.viewportHeight=p.framebufferHeight=p.drawingBufferHeight=t[3]=e[3]=i.drawingBufferHeight}function H(){p.tick+=1,p.time=X(),G(),I.procs.poll()}function Y(){S.refresh(),G(),I.procs.refresh(),c&&c.update()}function X(){return(yt()-h)/1e3}function Z(t,e){var n;switch(nt.type(e,"function","listener callback must be a function"),t){case"frame":return q(e);case"lost":n=D;break;case"restore":n=O;break;case"destroy":n=F;break;default:nt.raise("invalid event, must be one of frame,lost,restore,destroy")}return n.push(e),{cancel:function(){for(var t=0;t<n.length;++t)if(n[t]===e)return n[t]=n[n.length-1],void n.pop()}}}Y();var K=e(V,{clear:W,prop:pt.define.bind(null,Ta),context:pt.define.bind(null,Ia),this:pt.define.bind(null,Ca),draw:V({}),buffer:function(t){return b.create(t,_a,!1,!1)},elements:function(t){return g.create(t,!1)},texture:S.create2D,cube:S.createCube,renderbuffer:A.create,framebuffer:T.create,framebufferCube:T.createCube,vao:x.createVAO,attributes:r,frame:q,on:Z,limits:v,hasExtension:function(t){return v.extensions.indexOf(t.toLowerCase())>=0},read:C,destroy:R,_gl:i,_refresh:Y,poll:function(){H(),c&&c.update()},now:X,stats:u});return n.onDone(null,K),K}return ka}();const Pn=Tn(Cn.exports),kn=!1,zn=8192,Dn=1,On=1,Fn=1,Mn=!0,Bn=!1,En=19,Ln=.8,Nn=.5,jn=!1,Rn=[50,150],Vn=.25,Un="auto",$n=!1,Wn="white",qn="white",Gn=void 0,Hn=!1,Yn={decay:5e3,gravity:.25,center:0,repulsion:1,repulsionTheta:1.15,repulsionQuadtreeLevels:12,linkSpring:1,linkDistance:10,linkDistRandomVariationRange:[1,1.2],repulsionFromMouse:2,friction:.85,cluster:.1},Xn=!1,Zn=2,Kn=!0,Qn=!1,Jn=!1,ti=!1,ei=!0,ni=250,ii=.1,ri=250,oi=150,si=!1,ai=void 0,ui=t=>Array.isArray(t),li=t=>(t=>t instanceof Object)(t)&&!ui(t)&&!(t=>"function"==typeof t)(t)&&!(t=>t instanceof Object&&"Function"!==t.constructor.name&&"Object"!==t.constructor.name)(t);function ci(t){let e;if(ui(t))e=t;else{const n=he(t),i=null==n?void 0:n.rgb();e=[(null==i?void 0:i.r)||0,(null==i?void 0:i.g)||0,(null==i?void 0:i.b)||0,(null==n?void 0:n.opacity)??1]}return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function hi(t,e){let n=new Float32Array;return t({framebuffer:e})((()=>{n=t.read()})),n}function fi(t){return null!=t&&!Number.isNaN(t)}class di{constructor(){this.disableSimulation=kn,this.backgroundColor="#222222",this.spaceSize=zn,this.pointColor="#b3b3b3",this.pointGreyoutOpacity=.1,this.pointSize=4,this.pointSizeScale=Dn,this.hoveredPointCursor=Un,this.renderHoveredPointRing=$n,this.hoveredPointRingColor=Wn,this.focusedPointRingColor=qn,this.focusedPointIndex=Gn,this.linkColor="#666666",this.linkGreyoutOpacity=.1,this.linkWidth=1,this.linkWidthScale=On,this.renderLinks=Mn,this.curvedLinks=Bn,this.curvedLinkSegments=En,this.curvedLinkWeight=Ln,this.curvedLinkControlPointDistance=Nn,this.linkArrows=jn,this.linkArrowsSizeScale=Fn,this.linkVisibilityDistanceRange=Rn,this.linkVisibilityMinTransparency=Vn,this.useQuadtree=Hn,this.simulationDecay=Yn.decay,this.simulationGravity=Yn.gravity,this.simulationCenter=Yn.center,this.simulationRepulsion=Yn.repulsion,this.simulationRepulsionTheta=Yn.repulsionTheta,this.simulationRepulsionQuadtreeLevels=Yn.repulsionQuadtreeLevels,this.simulationLinkSpring=Yn.linkSpring,this.simulationLinkDistance=Yn.linkDistance,this.simulationLinkDistRandomVariationRange=Yn.linkDistRandomVariationRange,this.simulationRepulsionFromMouse=Yn.repulsionFromMouse,this.simulationFriction=Yn.friction,this.simulationCluster=Yn.cluster,this.onSimulationStart=void 0,this.onSimulationTick=void 0,this.onSimulationEnd=void 0,this.onSimulationPause=void 0,this.onSimulationRestart=void 0,this.onClick=void 0,this.onMouseMove=void 0,this.onPointMouseOver=void 0,this.onPointMouseOut=void 0,this.onZoomStart=void 0,this.onZoom=void 0,this.onZoomEnd=void 0,this.onDragStart=void 0,this.onDrag=void 0,this.onDragEnd=void 0,this.showFPSMonitor=Xn,this.pixelRatio=Zn,this.scalePointsOnZoom=Kn,this.initialZoomLevel=void 0,this.disableZoom=Qn,this.enableSimulationDuringZoom=Jn,this.enableDrag=ti,this.fitViewOnInit=ei,this.fitViewDelay=ni,this.fitViewPadding=ii,this.fitViewDuration=ri,this.fitViewByPointsInRect=void 0,this.randomSeed=void 0,this.pointSamplingDistance=oi,this.disableAttribution=si,this.disableRescalePositions=ai}init(t){Object.keys(t).forEach((e=>{this.deepMergeConfig(this.getConfig(),t,e)}))}deepMergeConfig(t,e,n){li(t[n])&&li(e[n])?Object.keys(e[n]).forEach((i=>{this.deepMergeConfig(t[n],e[n],i)})):t[n]=e[n]}getConfig(){return this}}class pi{constructor(t,e,n,i,r){this.reglInstance=t,this.config=e,this.store=n,this.data=i,r&&(this.points=r)}}function mi(t){return{buffer:t.buffer(new Float32Array([-1,-1,1,-1,-1,1,1,1])),size:2}}function yi(t){const e=new Float32Array(t*t*2);for(let n=0;n<t;n++)for(let i=0;i<t;i++){const r=n*t*2+2*i;e[r+0]=i,e[r+1]=n}return e}function vi(t){var e;t&&null!=(e=null==t?void 0:t._framebuffer)&&e.framebuffer&&t.destroy()}var bi="#ifdef GL_ES\nprecision highp float;\n#endif\n\nvoid main() {\n  gl_FragColor = vec4(0.0);\n}",gi="#ifdef GL_ES\nprecision highp float;\n#endif\n\nattribute vec2 vertexCoord; \nvarying vec2 textureCoords; \n\nvoid main() {\n    \n    textureCoords = (vertexCoord + 1.0) / 2.0;\n    gl_Position = vec4(vertexCoord, 0, 1);\n}";class xi extends pi{create(){const{reglInstance:t,store:e}=this;this.centermassTexture||(this.centermassTexture=t.texture()),this.centermassTexture({data:new Float32Array(4).fill(0),shape:[1,1,4],type:"float"}),this.centermassFbo||(this.centermassFbo=t.framebuffer({color:this.centermassTexture,depth:!1,stencil:!1})),this.pointIndices||(this.pointIndices=t.buffer(0)),this.pointIndices(yi(e.pointsTextureSize))}initPrograms(){const{reglInstance:t,config:e,store:n,data:i,points:r}=this;this.clearCentermassCommand||(this.clearCentermassCommand=t({frag:bi,vert:gi,framebuffer:()=>this.centermassFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)}})),this.calculateCentermassCommand||(this.calculateCentermassCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec4 rgba;\n\nvoid main() {\n  gl_FragColor = rgba;\n}",vert:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform float pointsTextureSize;\n\nattribute vec2 pointIndices;\n\nvarying vec4 rgba;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, pointIndices / pointsTextureSize);\n  rgba = vec4(pointPosition.xy, 1.0, 0.0);\n\n  gl_Position = vec4(0.0, 0.0, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}",framebuffer:()=>this.centermassFbo,primitive:"points",count:()=>i.pointsNumber??0,attributes:{pointIndices:{buffer:this.pointIndices,size:2}},uniforms:{positionsTexture:()=>null==r?void 0:r.previousPositionFbo,pointsTextureSize:()=>n.pointsTextureSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.runCommand||(this.runCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D centermassTexture;\nuniform float centerForce;\nuniform float alpha;\n\nvarying vec2 textureCoords;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  vec4 velocity = vec4(0.0);\n  vec4 centermassValues = texture2D(centermassTexture, vec2(0.0));\n  vec2 centermassPosition = centermassValues.xy / centermassValues.b;\n  vec2 distVector = centermassPosition - pointPosition.xy;\n  float dist = sqrt(dot(distVector, distVector));\n  if (dist > 0.0) {\n    float angle = atan(distVector.y, distVector.x);\n    float addV = alpha * centerForce * dist * 0.01;\n    velocity.rg += addV * vec2(cos(angle), sin(angle));\n  }\n\n  gl_FragColor = velocity;\n}",vert:gi,framebuffer:()=>null==r?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>null==r?void 0:r.previousPositionFbo,centermassTexture:()=>this.centermassFbo,centerForce:()=>e.simulationCenter,alpha:()=>n.alpha}}))}run(){var t,e,n;null==(t=this.clearCentermassCommand)||t.call(this),null==(e=this.calculateCentermassCommand)||e.call(this),null==(n=this.runCommand)||n.call(this)}}class wi extends pi{initPrograms(){const{reglInstance:t,config:e,store:n,points:i}=this;this.runCommand||(this.runCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform float gravity;\nuniform float spaceSize;\nuniform float alpha;\n\nvarying vec2 textureCoords;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n\n  vec4 velocity = vec4(0.0);\n\n  vec2 centerPosition = vec2(spaceSize / 2.0);\n  vec2 distVector = centerPosition - pointPosition.rg;\n  float dist = sqrt(dot(distVector, distVector));\n  if (dist > 0.0) {\n    float angle = atan(distVector.y, distVector.x);\n    float additionalVelocity = alpha * gravity * dist * 0.1;\n    velocity.rg += additionalVelocity * vec2(cos(angle), sin(angle));\n  }\n\n  gl_FragColor = velocity;\n}",vert:gi,framebuffer:()=>null==i?void 0:i.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>null==i?void 0:i.previousPositionFbo,gravity:()=>e.simulationGravity,spaceSize:()=>n.adjustedSpaceSize,alpha:()=>n.alpha}}))}run(){var t;null==(t=this.runCommand)||t.call(this)}}var _i=(t=>(t.OUTGOING="outgoing",t.INCOMING="incoming",t))(_i||{});class Si extends pi{constructor(){super(...arguments),this.linkFirstIndicesAndAmount=new Float32Array,this.indices=new Float32Array,this.maxPointDegree=0}create(t){const{reglInstance:e,store:{pointsTextureSize:n,linksTextureSize:i},data:r}=this;if(!n||!i)return;this.linkFirstIndicesAndAmount=new Float32Array(n*n*4),this.indices=new Float32Array(i*i*4);const o=new Float32Array(i*i*4),s=new Float32Array(i*i*4),a="incoming"===t?r.sourceIndexToTargetIndices:r.targetIndexToSourceIndices;this.maxPointDegree=0;let u=0;null==a||a.forEach(((t,e)=>{t&&(this.linkFirstIndicesAndAmount[4*e+0]=u%i,this.linkFirstIndicesAndAmount[4*e+1]=Math.floor(u/i),this.linkFirstIndicesAndAmount[4*e+2]=t.length??0,t.forEach((t=>{let[i,a]=t;var l,c,h;this.indices[4*u+0]=i%n,this.indices[4*u+1]=Math.floor(i/n);const f=(null==(l=r.degree)?void 0:l[i])??0,d=(null==(c=r.degree)?void 0:c[e])??0,p=f+d,m=0!==p?f/p:.5,y=Math.min(f,d);let v=(null==(h=r.linkStrength)?void 0:h[a])??1/Math.max(y,1);v=Math.sqrt(v),o[4*u+0]=m,o[4*u+1]=v,s[4*u]=this.store.getRandomFloat(0,1),u+=1})),this.maxPointDegree=Math.max(this.maxPointDegree,t.length??0))})),this.linkFirstIndicesAndAmountTexture||(this.linkFirstIndicesAndAmountTexture=e.texture()),this.linkFirstIndicesAndAmountTexture({data:this.linkFirstIndicesAndAmount,shape:[n,n,4],type:"float"}),this.linkFirstIndicesAndAmountFbo||(this.linkFirstIndicesAndAmountFbo=e.framebuffer({color:this.linkFirstIndicesAndAmountTexture,depth:!1,stencil:!1})),this.indicesTexture||(this.indicesTexture=e.texture()),this.indicesTexture({data:this.indices,shape:[i,i,4],type:"float"}),this.indicesFbo||(this.indicesFbo=e.framebuffer({color:this.indicesTexture,depth:!1,stencil:!1})),this.biasAndStrengthTexture||(this.biasAndStrengthTexture=e.texture()),this.biasAndStrengthTexture({data:o,shape:[i,i,4],type:"float"}),this.biasAndStrengthFbo||(this.biasAndStrengthFbo=e.framebuffer({color:this.biasAndStrengthTexture,depth:!1,stencil:!1})),this.randomDistanceTexture||(this.randomDistanceTexture=e.texture()),this.randomDistanceTexture({data:s,shape:[i,i,4],type:"float"}),this.randomDistanceFbo||(this.randomDistanceFbo=e.framebuffer({color:this.randomDistanceTexture,depth:!1,stencil:!1}))}initPrograms(){const{reglInstance:t,config:e,store:n,points:i}=this;this.runCommand||(this.runCommand=t({frag:()=>function(t){return`\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform float linkSpring;\nuniform float linkDistance;\nuniform vec2 linkDistRandomVariationRange;\n\nuniform sampler2D linkInfoTexture; // Texture storing first link indices and amount\nuniform sampler2D linkIndicesTexture;\nuniform sampler2D linkPropertiesTexture; // Texture storing link bias and strength\nuniform sampler2D linkRandomDistanceTexture;\n\nuniform float pointsTextureSize;\nuniform float linksTextureSize;\nuniform float alpha;\n\nvarying vec2 textureCoords;\n\nconst float MAX_LINKS = ${t}.0;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  vec4 velocity = vec4(0.0);\n\n  vec4 linkInfo = texture2D(linkInfoTexture, textureCoords);\n  float iCount = linkInfo.r;\n  float jCount = linkInfo.g;\n  float linkAmount = linkInfo.b;\n  if (linkAmount > 0.0) {\n    for (float i = 0.0; i < MAX_LINKS; i += 1.0) {\n      if (i < linkAmount) {\n        if (iCount >= linksTextureSize) {\n          iCount = 0.0;\n          jCount += 1.0;\n        }\n        vec2 linkTextureIndex = (vec2(iCount, jCount) + 0.5) / linksTextureSize;\n        vec4 connectedPointIndex = texture2D(linkIndicesTexture, linkTextureIndex);\n        vec4 biasAndStrength = texture2D(linkPropertiesTexture, linkTextureIndex);\n        vec4 randomMinDistance = texture2D(linkRandomDistanceTexture, linkTextureIndex);\n        float bias = biasAndStrength.r;\n        float strength = biasAndStrength.g;\n        float randomMinLinkDist = randomMinDistance.r * (linkDistRandomVariationRange.g - linkDistRandomVariationRange.r) + linkDistRandomVariationRange.r;\n        randomMinLinkDist *= linkDistance;\n\n        iCount += 1.0;\n\n        vec4 connectedPointPosition = texture2D(positionsTexture, (connectedPointIndex.rg + 0.5) / pointsTextureSize);\n        float x = connectedPointPosition.x - (pointPosition.x + velocity.x);\n        float y = connectedPointPosition.y - (pointPosition.y + velocity.y);\n        float l = sqrt(x * x + y * y);\n\n        // Apply the link force\n        l = max(l, randomMinLinkDist * 0.99);\n        l = (l - randomMinLinkDist) / l;\n        l *= linkSpring * alpha;\n        l *= strength;\n        l *= bias;\n        x *= l;\n        y *= l;\n        velocity.x += x;\n        velocity.y += y;\n      }\n    }\n  }\n\n  gl_FragColor = vec4(velocity.rg, 0.0, 0.0);\n}\n  `}(this.maxPointDegree),vert:gi,framebuffer:()=>null==i?void 0:i.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>null==i?void 0:i.previousPositionFbo,linkSpring:()=>e.simulationLinkSpring,linkDistance:()=>e.simulationLinkDistance,linkDistRandomVariationRange:()=>e.simulationLinkDistRandomVariationRange,linkInfoTexture:()=>this.linkFirstIndicesAndAmountFbo,linkIndicesTexture:()=>this.indicesFbo,linkPropertiesTexture:()=>this.biasAndStrengthFbo,linkRandomDistanceTexture:()=>this.randomDistanceFbo,pointsTextureSize:()=>n.pointsTextureSize,linksTextureSize:()=>n.linksTextureSize,alpha:()=>n.alpha}}))}run(){var t;null==(t=this.runCommand)||t.call(this)}}var Ai="#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec4 rgba;\n\nvoid main() {\n  gl_FragColor = rgba;\n}",Ti="#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform float pointsTextureSize;\nuniform float levelTextureSize;\nuniform float cellSize;\n\nattribute vec2 pointIndices;\n\nvarying vec4 rgba;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, pointIndices / pointsTextureSize);\n  rgba = vec4(pointPosition.rg, 1.0, 0.0);\n\n  float n = floor(pointPosition.x / cellSize);\n  float m = floor(pointPosition.y / cellSize);\n  \n  vec2 levelPosition = 2.0 * (vec2(n, m) + 0.5) / levelTextureSize - 1.0;\n\n  gl_Position = vec4(levelPosition, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}";class Ii extends pi{constructor(){super(...arguments),this.levelsFbos=new Map,this.quadtreeLevels=0}create(){const{reglInstance:t,store:e}=this;if(!e.pointsTextureSize)return;this.quadtreeLevels=Math.log2(e.adjustedSpaceSize);for(let i=0;i<this.quadtreeLevels;i+=1){const e=Math.pow(2,i+1);this.levelsFbos.has(`level[${i}]`)||this.levelsFbos.set(`level[${i}]`,t.framebuffer());const n=this.levelsFbos.get(`level[${i}]`);n&&n({shape:[e,e],colorType:"float",depth:!1,stencil:!1})}const n=new Float32Array(e.pointsTextureSize*e.pointsTextureSize*4);for(let i=0;i<e.pointsTextureSize*e.pointsTextureSize;++i)n[4*i]=1e-5*e.getRandomFloat(-1,1),n[4*i+1]=1e-5*e.getRandomFloat(-1,1);this.randomValuesTexture||(this.randomValuesTexture=t.texture()),this.randomValuesTexture({data:n,shape:[e.pointsTextureSize,e.pointsTextureSize,4],type:"float"}),this.randomValuesFbo||(this.randomValuesFbo=t.framebuffer({color:this.randomValuesTexture,depth:!1,stencil:!1})),this.pointIndices||(this.pointIndices=t.buffer(0)),this.pointIndices(yi(e.pointsTextureSize))}initPrograms(){const{reglInstance:t,config:e,store:n,data:i,points:r}=this;this.clearLevelsCommand||(this.clearLevelsCommand=t({frag:bi,vert:gi,framebuffer:(t,e)=>e.levelFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)}})),this.calculateLevelsCommand||(this.calculateLevelsCommand=t({frag:Ai,vert:Ti,framebuffer:(t,e)=>e.levelFbo,primitive:"points",count:()=>i.pointsNumber??0,attributes:{pointIndices:{buffer:this.pointIndices,size:2}},uniforms:{positionsTexture:()=>null==r?void 0:r.previousPositionFbo,pointsTextureSize:()=>n.pointsTextureSize,levelTextureSize:(t,e)=>e.levelTextureSize,cellSize:(t,e)=>e.cellSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.forceCommand||(this.forceCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D levelFbo;\n\nuniform float level;\nuniform float levels;\nuniform float levelTextureSize;\nuniform float repulsion;\nuniform float alpha;\nuniform float spaceSize;\nuniform float theta;\n\nvarying vec2 textureCoords;\n\nconst float MAX_LEVELS_NUM = 14.0;\n\nvec2 calculateAdditionalVelocity (vec2 ij, vec2 pp) {\n  vec2 add = vec2(0.0);\n  vec4 centermass = texture2D(levelFbo, ij);\n  if (centermass.r > 0.0 && centermass.g > 0.0 && centermass.b > 0.0) {\n    vec2 centermassPosition = vec2(centermass.rg / centermass.b);\n    vec2 distVector = pp - centermassPosition;\n    float l = dot(distVector, distVector);\n    float dist = sqrt(l);\n    if (l > 0.0) {\n      float c = alpha * repulsion * centermass.b;\n\n      float distanceMin2 = 1.0;\n      if (l < distanceMin2) l = sqrt(distanceMin2 * l);\n      float addV = c / sqrt(l);\n      add = addV * normalize(distVector);\n    }\n  }\n  return add;\n}\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  float x = pointPosition.x;\n  float y = pointPosition.y;\n\n  float left = 0.0;\n  float top = 0.0;\n  float right = spaceSize;\n  float bottom = spaceSize;\n\n  float n_left = 0.0;\n  float n_top = 0.0;\n  float n_right = 0.0;\n  float n_bottom = 0.0;\n\n  float cellSize = 0.0;\n\n  \n  for (float i = 0.0; i < MAX_LEVELS_NUM; i += 1.0) {\n    if (i <= level) {\n      left += cellSize * n_left;\n      top += cellSize * n_top;\n      right -= cellSize * n_right;\n      bottom -= cellSize * n_bottom;\n\n      cellSize = pow(2.0 , levels - i - 1.0);\n\n      float dist_left = x - left;\n      n_left = max(0.0, floor(dist_left / cellSize - theta));\n\n      float dist_top = y - top;\n      n_top = max(0.0, floor(dist_top / cellSize - theta));\n      \n      float dist_right = right - x;\n      n_right = max(0.0, floor(dist_right / cellSize - theta));\n\n      float dist_bottom = bottom - y;\n      n_bottom = max(0.0, floor(dist_bottom / cellSize - theta));\n\n    }\n  }\n\n  vec4 velocity = vec4(vec2(0.0), 1.0, 0.0);\n\n  \n  for (float i = 0.0; i < 12.0; i += 1.0) {\n    for (float j = 0.0; j < 4.0; j += 1.0) {\n      float n = left + cellSize * j;\n      float m = top + cellSize * n_top + cellSize * i;\n\n      if (n < (left + n_left * cellSize) && m < bottom) {\n        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);\n      }\n\n      n = left + cellSize * i;\n      m = top + cellSize * j;\n\n      if (n < (right - n_right * cellSize) && m < (top + n_top * cellSize)) {\n        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);\n      }\n\n      n = right - n_right * cellSize + cellSize * j;\n      m = top + cellSize * i;\n\n      if (n < right && m < (bottom - n_bottom * cellSize)) {\n        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);\n      }\n\n      n = left + n_left * cellSize + cellSize * i;\n      m = bottom - n_bottom * cellSize + cellSize * j;\n\n      if (n < right && m < bottom) {\n        velocity.xy += calculateAdditionalVelocity(vec2(n / cellSize, m / cellSize) / levelTextureSize, pointPosition.xy);\n      }\n    }\n  }\n\n  gl_FragColor = velocity;\n}",vert:gi,framebuffer:()=>null==r?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>null==r?void 0:r.previousPositionFbo,level:(t,e)=>e.level,levels:this.quadtreeLevels,levelFbo:(t,e)=>e.levelFbo,levelTextureSize:(t,e)=>e.levelTextureSize,alpha:()=>n.alpha,repulsion:()=>e.simulationRepulsion,spaceSize:()=>n.adjustedSpaceSize,theta:()=>e.simulationRepulsionTheta},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.forceFromItsOwnCentermassCommand||(this.forceFromItsOwnCentermassCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D levelFbo;\nuniform sampler2D randomValues;\n\nuniform float levelTextureSize;\nuniform float repulsion;\nuniform float alpha;\n\nvarying vec2 textureCoords;\n\nvec2 calculateAdditionalVelocity (vec2 ij, vec2 pp) {\n  vec2 add = vec2(0.0);\n  vec4 centermass = texture2D(levelFbo, ij);\n  if (centermass.r > 0.0 && centermass.g > 0.0 && centermass.b > 0.0) {\n    vec2 centermassPosition = vec2(centermass.rg / centermass.b);\n    vec2 distVector = pp - centermassPosition;\n    float l = dot(distVector, distVector);\n    float dist = sqrt(l);\n    if (l > 0.0) {\n      float angle = atan(distVector.y, distVector.x);\n      float c = alpha * repulsion * centermass.b;\n\n      float distanceMin2 = 1.0;\n      if (l < distanceMin2) l = sqrt(distanceMin2 * l);\n      float addV = c / sqrt(l);\n      add = addV * vec2(cos(angle), sin(angle));\n    }\n  }\n  return add;\n}\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  vec4 random = texture2D(randomValues, textureCoords);\n\n  vec4 velocity = vec4(0.0);\n\n  \n  velocity.xy += calculateAdditionalVelocity(pointPosition.xy / levelTextureSize, pointPosition.xy);\n  \n  velocity.xy += velocity.xy * random.rg;\n\n  gl_FragColor = velocity;\n}",vert:gi,framebuffer:()=>null==r?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>null==r?void 0:r.previousPositionFbo,randomValues:()=>this.randomValuesFbo,levelFbo:(t,e)=>e.levelFbo,levelTextureSize:(t,e)=>e.levelTextureSize,alpha:()=>n.alpha,repulsion:()=>e.simulationRepulsion,spaceSize:()=>n.adjustedSpaceSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.clearVelocityCommand||(this.clearVelocityCommand=t({frag:bi,vert:gi,framebuffer:()=>null==r?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)}}))}run(){var t,e,n,i,r;const{store:o}=this;for(let s=0;s<this.quadtreeLevels;s+=1){null==(t=this.clearLevelsCommand)||t.call(this,{levelFbo:this.levelsFbos.get(`level[${s}]`)});const n=Math.pow(2,s+1),i=o.adjustedSpaceSize/n;null==(e=this.calculateLevelsCommand)||e.call(this,{levelFbo:this.levelsFbos.get(`level[${s}]`),levelTextureSize:n,cellSize:i})}null==(n=this.clearVelocityCommand)||n.call(this);for(let s=0;s<this.quadtreeLevels;s+=1){const t=Math.pow(2,s+1);null==(i=this.forceCommand)||i.call(this,{levelFbo:this.levelsFbos.get(`level[${s}]`),levelTextureSize:t,level:s}),s===this.quadtreeLevels-1&&(null==(r=this.forceFromItsOwnCentermassCommand)||r.call(this,{levelFbo:this.levelsFbos.get(`level[${s}]`),levelTextureSize:t,level:s}))}}}function Ci(t,e){t=Math.min(t,e);const n=e-t,i="\n    float dist = sqrt(l);\n    if (dist > 0.0) {\n      float c = alpha * repulsion * centermass.b;\n      addVelocity += calcAdd(vec2(x, y), l, c);\n      addVelocity += addVelocity * random.rg;\n    }\n  ";return`\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D randomValues;\nuniform float spaceSize;\nuniform float repulsion;\nuniform float theta;\nuniform float alpha;\nuniform sampler2D level[${e}];\nvarying vec2 textureCoords;\n\nvec2 calcAdd(vec2 xy, float l, float c) {\n  float distanceMin2 = 1.0;\n  if (l < distanceMin2) l = sqrt(distanceMin2 * l);\n  float add = c / l;\n  return add * xy;\n}\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  vec4 random = texture2D(randomValues, textureCoords);\n\n  float width0 = spaceSize;\n\n  vec2 velocity = vec2(0.0);\n  vec2 addVelocity = vec2(0.0);\n\n  ${new Array(e).fill(0).map(((t,e)=>`float width${e+1} = width${e} / 2.0;`)).join("\n")}\n\n  for (float n = 0.0; n < pow(2.0, ${n}.0); n += 1.0) {\n    for (float m = 0.0; m < pow(2.0, ${n}.0); m += 1.0) {\n      ${function r(o){if(o>=e)return i;{const e=Math.pow(2,o+1),s=new Array(o+1-n).fill(0).map(((t,e)=>`pow(2.0, ${o-(e+n)}.0) * i${e+n}`)).join("+"),a=new Array(o+1-n).fill(0).map(((t,e)=>`pow(2.0, ${o-(e+n)}.0) * j${e+n}`)).join("+");return`\n      for (float ij${o} = 0.0; ij${o} < 4.0; ij${o} += 1.0) {\n        float i${o} = 0.0;\n        float j${o} = 0.0;\n        if (ij${o} == 1.0 || ij${o} == 3.0) i${o} = 1.0;\n        if (ij${o} == 2.0 || ij${o} == 3.0) j${o} = 1.0;\n        float i = pow(2.0, ${t}.0) * n / width${o+1} + ${s};\n        float j = pow(2.0, ${t}.0) * m / width${o+1} + ${a};\n        float groupPosX = (i + 0.5) / ${e}.0;\n        float groupPosY = (j + 0.5) / ${e}.0;\n        \n        vec4 centermass = texture2D(level[${o}], vec2(groupPosX, groupPosY));\n        if (centermass.r > 0.0 && centermass.g > 0.0 && centermass.b > 0.0) {\n          float x = centermass.r / centermass.b - pointPosition.r;\n          float y = centermass.g / centermass.b - pointPosition.g;\n          float l = x * x + y * y;\n          if ((width${o+1} * width${o+1}) / theta < l) {\n            ${i}\n          } else {\n            ${r(o+1)}\n          }\n        }\n      }\n      `}}(n)}\n    }\n  }\n\n  velocity -= addVelocity;\n\n  gl_FragColor = vec4(velocity, 0.0, 0.0);\n}\n`}class Pi extends pi{constructor(){super(...arguments),this.levelsTextures=new Map,this.levelsFbos=new Map,this.quadtreeLevels=0}create(){const{reglInstance:t,store:e}=this;if(!e.pointsTextureSize)return;this.quadtreeLevels=Math.log2(e.adjustedSpaceSize);for(let i=0;i<this.quadtreeLevels;i+=1){const e=Math.pow(2,i+1),n=`level[${i}]`;this.levelsTextures.has(n)||this.levelsTextures.set(n,t.texture());const r=this.levelsTextures.get(n);r&&r({data:new Float32Array(e*e*4),shape:[e,e,4],type:"float"}),this.levelsFbos.has(n)||this.levelsFbos.set(n,t.framebuffer({color:this.levelsTextures.get(n),depth:!1,stencil:!1}))}const n=new Float32Array(e.pointsTextureSize*e.pointsTextureSize*4);for(let i=0;i<e.pointsTextureSize*e.pointsTextureSize;++i)n[4*i]=1e-5*e.getRandomFloat(-1,1),n[4*i+1]=1e-5*e.getRandomFloat(-1,1);this.randomValuesTexture||(this.randomValuesTexture=t.texture()),this.randomValuesTexture({data:n,shape:[e.pointsTextureSize,e.pointsTextureSize,4],type:"float"}),this.randomValuesFbo||(this.randomValuesFbo=t.framebuffer({color:this.randomValuesTexture,depth:!1,stencil:!1})),this.pointIndices||(this.pointIndices=t.buffer(0)),this.pointIndices(yi(e.pointsTextureSize))}initPrograms(){const{reglInstance:t,config:e,store:n,data:i,points:r}=this;this.clearLevelsCommand||(this.clearLevelsCommand=t({frag:bi,vert:gi,framebuffer:(t,e)=>e.levelFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)}})),this.calculateLevelsCommand||(this.calculateLevelsCommand=t({frag:Ai,vert:Ti,framebuffer:(t,e)=>e.levelFbo,primitive:"points",count:()=>i.pointsNumber??0,attributes:{pointIndices:{buffer:this.pointIndices,size:2}},uniforms:{positionsTexture:()=>null==r?void 0:r.previousPositionFbo,pointsTextureSize:()=>n.pointsTextureSize,levelTextureSize:(t,e)=>e.levelTextureSize,cellSize:(t,e)=>e.cellSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.quadtreeCommand=t({frag:Ci(e.simulationRepulsionQuadtreeLevels??this.quadtreeLevels,this.quadtreeLevels),vert:gi,framebuffer:()=>null==r?void 0:r.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>null==r?void 0:r.previousPositionFbo,randomValues:()=>this.randomValuesFbo,spaceSize:()=>n.adjustedSpaceSize,repulsion:()=>e.simulationRepulsion,theta:()=>e.simulationRepulsionTheta,alpha:()=>n.alpha,...Object.fromEntries(this.levelsFbos)}})}run(){var t,e,n;const{store:i}=this;for(let r=0;r<this.quadtreeLevels;r+=1){null==(t=this.clearLevelsCommand)||t.call(this,{levelFbo:this.levelsFbos.get(`level[${r}]`)});const n=Math.pow(2,r+1),o=i.adjustedSpaceSize/n;null==(e=this.calculateLevelsCommand)||e.call(this,{levelFbo:this.levelsFbos.get(`level[${r}]`),levelTextureSize:n,cellSize:o})}null==(n=this.quadtreeCommand)||n.call(this)}}class ki extends pi{initPrograms(){const{reglInstance:t,config:e,store:n,points:i}=this;this.runCommand||(this.runCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform float repulsion;\nuniform vec2 mousePos;\n\nvarying vec2 textureCoords;\n\nvoid main() {  \n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  vec4 velocity = vec4(0.0);\n  vec2 mouse = mousePos;\n  \n  vec2 distVector = mouse - pointPosition.rg;\n  float dist = sqrt(dot(distVector, distVector));\n  dist = max(dist, 10.0);\n  float angle = atan(distVector.y, distVector.x);\n  float addV = 100.0 * repulsion / (dist * dist);\n  velocity.rg -= addV * vec2(cos(angle), sin(angle));\n\n  gl_FragColor = velocity;\n}",vert:gi,framebuffer:()=>null==i?void 0:i.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>null==i?void 0:i.previousPositionFbo,mousePos:()=>n.mousePosition,repulsion:()=>e.simulationRepulsionFromMouse}}))}run(){var t;null==(t=this.runCommand)||t.call(this)}}class zi extends pi{create(){var t;const{reglInstance:e,store:n,data:i}=this,{pointsTextureSize:r}=n;if(void 0===i.pointsNumber||!i.pointClusters&&!i.clusterPositions)return;const o=(i.pointClusters??[]).reduce(((t,e)=>void 0===e||e<0?t:Math.max(t,e)),0)+1;this.clustersTextureSize=Math.ceil(Math.sqrt(o)),this.clusterTexture||(this.clusterTexture=e.texture()),this.clusterPositionsTexture||(this.clusterPositionsTexture=e.texture()),this.clusterForceCoefficientTexture||(this.clusterForceCoefficientTexture=e.texture());const s=new Float32Array(r*r*4),a=new Float32Array(this.clustersTextureSize*this.clustersTextureSize*4).fill(-1),u=new Float32Array(r*r*4).fill(1);if(i.clusterPositions)for(let l=0;l<o;++l)a[4*l+0]=i.clusterPositions[2*l+0]??-1,a[4*l+1]=i.clusterPositions[2*l+1]??-1;for(let l=0;l<i.pointsNumber;++l){const e=null==(t=i.pointClusters)?void 0:t[l];void 0===e?(s[4*l+0]=-1,s[4*l+1]=-1):(s[4*l+0]=e%this.clustersTextureSize,s[4*l+1]=Math.floor(e/this.clustersTextureSize)),i.clusterStrength&&(u[4*l+0]=i.clusterStrength[l]??1)}this.clusterTexture({data:s,shape:[r,r,4],type:"float"}),this.clusterFbo||(this.clusterFbo=e.framebuffer({color:this.clusterTexture,depth:!1,stencil:!1})),this.clusterPositionsTexture({data:a,shape:[this.clustersTextureSize,this.clustersTextureSize,4],type:"float"}),this.clusterPositionsFbo||(this.clusterPositionsFbo=e.framebuffer({color:this.clusterPositionsTexture,depth:!1,stencil:!1})),this.clusterForceCoefficientTexture({data:u,shape:[r,r,4],type:"float"}),this.clusterForceCoefficientFbo||(this.clusterForceCoefficientFbo=e.framebuffer({color:this.clusterForceCoefficientTexture,depth:!1,stencil:!1})),this.centermassTexture||(this.centermassTexture=e.texture()),this.centermassTexture({data:new Float32Array(this.clustersTextureSize*this.clustersTextureSize*4).fill(0),shape:[this.clustersTextureSize,this.clustersTextureSize,4],type:"float"}),this.centermassFbo||(this.centermassFbo=e.framebuffer({color:this.centermassTexture,depth:!1,stencil:!1})),this.pointIndices||(this.pointIndices=e.buffer(0)),this.pointIndices(yi(n.pointsTextureSize))}initPrograms(){const{reglInstance:t,store:e,data:n,points:i}=this;void 0!==n.pointClusters&&(this.clearCentermassCommand||(this.clearCentermassCommand=t({frag:bi,vert:gi,framebuffer:()=>this.centermassFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)}})),this.calculateCentermassCommand||(this.calculateCentermassCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec4 rgba;\n\nvoid main() {\n  gl_FragColor = rgba;\n}",vert:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D clusterTexture;\nuniform float pointsTextureSize;\nuniform float clustersTextureSize;\n\nattribute vec2 pointIndices;\n\nvarying vec4 rgba;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, pointIndices / pointsTextureSize);\n  rgba = vec4(pointPosition.xy, 1.0, 0.0);\n\n  vec4 pointClusterIndices = texture2D(clusterTexture, pointIndices / pointsTextureSize);\n  vec2 xy = vec2(0.0);\n  if (pointClusterIndices.x >= 0.0 && pointClusterIndices.y >= 0.0) {\n    xy = 2.0 * (pointClusterIndices.xy + 0.5) / clustersTextureSize - 1.0;\n  }\n  \n  gl_Position = vec4(xy, 0.0, 1.0);\n  gl_PointSize = 1.0;\n}",framebuffer:()=>this.centermassFbo,primitive:"points",count:()=>n.pointsNumber??0,attributes:{pointIndices:{buffer:this.pointIndices,size:2}},uniforms:{positionsTexture:()=>null==i?void 0:i.previousPositionFbo,pointsTextureSize:()=>e.pointsTextureSize,clusterTexture:()=>this.clusterFbo,clustersTextureSize:()=>this.clustersTextureSize},blend:{enable:!0,func:{src:"one",dst:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},stencil:{enable:!1}})),this.applyForcesCommand||(this.applyForcesCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D centermassTexture;\nuniform sampler2D clusterTexture;\nuniform sampler2D clusterPositionsTexture;\nuniform sampler2D clusterForceCoefficient;\nuniform float alpha;\nuniform float clustersTextureSize;\nuniform float clusterCoefficient;\n\nvarying vec2 textureCoords;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  vec4 velocity = vec4(0.0);\n  vec4 pointClusterIndices = texture2D(clusterTexture, textureCoords);\n  \n  if (pointClusterIndices.x >= 0.0 && pointClusterIndices.y >= 0.0) {\n    \n    vec2 clusterPositions = texture2D(clusterPositionsTexture, pointClusterIndices.xy / clustersTextureSize).xy;\n    if (clusterPositions.x < 0.0 || clusterPositions.y < 0.0) {\n      vec4 centermassValues = texture2D(centermassTexture, pointClusterIndices.xy / clustersTextureSize);\n      clusterPositions = centermassValues.xy / centermassValues.b;\n    }\n    vec4 clusterCustomCoeff = texture2D(clusterForceCoefficient, textureCoords);\n    vec2 distVector = clusterPositions.xy - pointPosition.xy;\n    float dist = length(distVector);\n    if (dist > 0.0) {\n      float addV = alpha * dist * clusterCoefficient * clusterCustomCoeff.r;\n      velocity.rg += addV * normalize(distVector);\n    }\n  }\n\n  gl_FragColor = velocity;\n}",vert:gi,framebuffer:()=>null==i?void 0:i.velocityFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>null==i?void 0:i.previousPositionFbo,clusterTexture:()=>this.clusterFbo,centermassTexture:()=>this.centermassFbo,clusterPositionsTexture:()=>this.clusterPositionsFbo,clusterForceCoefficient:()=>this.clusterForceCoefficientFbo,alpha:()=>e.alpha,clustersTextureSize:()=>this.clustersTextureSize,clusterCoefficient:()=>this.config.simulationCluster}})))}run(){var t,e,n;!this.data.pointClusters&&!this.data.clusterPositions||(null==(t=this.clearCentermassCommand)||t.call(this),null==(e=this.calculateCentermassCommand)||e.call(this),null==(n=this.applyForcesCommand)||n.call(this))}}var Di={exports:{}};!function(t){t.exports=function(){var t='<div class="gl-box">\n  <svg viewBox="0 0 55 60">\n    <text x="27" y="56" class="gl-fps">00 FPS</text>\n    <text x="28" y="8" class="gl-mem"></text>\n    <rect x="0" y="14" rx="4" ry="4" width="55" height="32"></rect>\n    <polyline class="gl-chart"></polyline>\n  </svg>\n  <svg viewBox="0 0 14 60" class="gl-cpu-svg">\n    <line x1="7" y1="38" x2="7" y2="11" class="opacity"/>\n    <line x1="7" y1="38" x2="7" y2="11" class="gl-cpu" stroke-dasharray="0 27"/>\n    <path d="M5.35 43c-.464 0-.812.377-.812.812v1.16c-.783.1972-1.421.812-1.595 1.624h-1.16c-.435 0-.812.348-.812.812s.348.812.812.812h1.102v1.653H1.812c-.464 0-.812.377-.812.812 0 .464.377.812.812.812h1.131c.1943.783.812 1.392 1.595 1.595v1.131c0 .464.377.812.812.812.464 0 .812-.377.812-.812V53.15h1.653v1.073c0 .464.377.812.812.812.464 0 .812-.377.812-.812v-1.131c.783-.1943 1.392-.812 1.595-1.595h1.131c.464 0 .812-.377.812-.812 0-.464-.377-.812-.812-.812h-1.073V48.22h1.102c.435 0 .812-.348.812-.812s-.348-.812-.812-.812h-1.16c-.1885-.783-.812-1.421-1.595-1.624v-1.131c0-.464-.377-.812-.812-.812-.464 0-.812.377-.812.812v1.073H6.162v-1.073c0-.464-.377-.812-.812-.812zm.58 3.48h2.088c.754 0 1.363.609 1.363 1.363v2.088c0 .754-.609 1.363-1.363 1.363H5.93c-.754 0-1.363-.609-1.363-1.363v-2.088c0-.754.609-1.363 1.363-1.363z"/>\n  </svg>\n  <svg viewBox="0 0 14 60" class="gl-gpu-svg">\n    <line x1="7" y1="38" x2="7" y2="11" class="opacity"/>\n    <line x1="7" y1="38" x2="7" y2="11" class="gl-gpu" stroke-dasharray="0 27"/>\n    <path d="M1.94775 43.3772a.736.736 0 10-.00416 1.472c.58535.00231.56465.1288.6348.3197.07015.18975.04933.43585.04933.43585l-.00653.05405v8.671a.736.736 0 101.472 0v-1.4145c.253.09522.52785.1495.81765.1495h5.267c1.2535 0 2.254-.9752 2.254-2.185v-3.105c0-1.2075-1.00625-2.185-2.254-2.185h-5.267c-.28865 0-.5635.05405-.8165.1495.01806-.16445.04209-.598-.1357-1.0787-.22425-.6072-.9499-1.2765-2.0125-1.2765zm2.9095 3.6455c.42435 0 .7659.36225.7659.8119v2.9785c0 .44965-.34155.8119-.7659.8119s-.7659-.36225-.7659-.8119v-2.9785c0-.44965.34155-.8119.7659-.8119zm4.117 0a2.3 2.3 0 012.3 2.3 2.3 2.3 0 01-2.3 2.3 2.3 2.3 0 01-2.3-2.3 2.3 2.3 0 012.3-2.3z"/>\n  </svg>\n</div>',e="#gl-bench {\n  position:absolute;\n  left:0;\n  top:0;\n  z-index:1000;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  user-select: none;\n}\n\n#gl-bench div {\n  position: relative;\n  display: block;\n  margin: 4px;\n  padding: 0 7px 0 10px;\n  background: #6c6;\n  border-radius: 15px;\n  cursor: pointer;\n  opacity: 0.9;\n}\n\n#gl-bench svg {\n  height: 60px;\n  margin: 0 -1px;\n}\n\n#gl-bench text {\n  font-size: 12px;\n  font-family: Helvetica,Arial,sans-serif;\n  font-weight: 700;\n  dominant-baseline: middle;\n  text-anchor: middle;\n}\n\n#gl-bench .gl-mem {\n  font-size: 9px;\n}\n\n#gl-bench line {\n  stroke-width: 5;\n  stroke: #112211;\n  stroke-linecap: round;\n}\n\n#gl-bench polyline {\n  fill: none;\n  stroke: #112211;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n  stroke-width: 3.5;\n}\n\n#gl-bench rect {\n  fill: #448844;\n}\n\n#gl-bench .opacity {\n  stroke: #448844;\n}\n";class n{constructor(n){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.css=e,this.svg=t,this.paramLogger=()=>{},this.chartLogger=()=>{},this.chartLen=20,this.chartHz=20,this.names=[],this.cpuAccums=[],this.gpuAccums=[],this.activeAccums=[],this.chart=new Array(this.chartLen),this.now=()=>performance&&performance.now?performance.now():Date.now(),this.updateUI=()=>{[].forEach.call(this.nodes["gl-gpu-svg"],(t=>{t.style.display=this.trackGPU?"inline":"none"}))},Object.assign(this,i),this.detected=0,this.finished=[],this.isFramebuffer=0,this.frameId=0;let r,o,s=0,a=t=>{++s<20?r=requestAnimationFrame(a):(this.detected=Math.ceil(1e3*s/(t-o)/70),cancelAnimationFrame(r)),o||(o=t)};if(requestAnimationFrame(a),n){const t=async(t,e)=>Promise.resolve(setTimeout((()=>{n.getError();const i=this.now()-t;e.forEach(((t,e)=>{t&&(this.gpuAccums[e]+=i)}))}),0)),e=(e,n,i)=>function(){const r=n.now();e.apply(i,arguments),n.trackGPU&&n.finished.push(t(r,n.activeAccums.slice(0)))};["drawArrays","drawElements","drawArraysInstanced","drawBuffers","drawElementsInstanced","drawRangeElements"].forEach((t=>{n[t]&&(n[t]=e(n[t],this,n))})),n.getExtension=((t,i)=>function(){let r=t.apply(n,arguments);return r&&["drawElementsInstancedANGLE","drawBuffersWEBGL"].forEach((t=>{r[t]&&(r[t]=e(r[t],i,r))})),r})(n.getExtension,this)}if(!this.withoutUI){this.dom||(this.dom=document.body);let t=document.createElement("div");t.id="gl-bench",this.dom.appendChild(t),this.dom.insertAdjacentHTML("afterbegin",'<style id="gl-bench-style">'+this.css+"</style>"),this.dom=t,this.dom.addEventListener("click",(()=>{this.trackGPU=!this.trackGPU,this.updateUI()})),this.paramLogger=((t,e,n)=>{const i=["gl-cpu","gl-gpu","gl-mem","gl-fps","gl-gpu-svg","gl-chart"],r=Object.assign({},i);return i.forEach((t=>r[t]=e.getElementsByClassName(t))),this.nodes=r,(e,i,o,s,a,u,l)=>{r["gl-cpu"][e].style.strokeDasharray=(.27*i).toFixed(0)+" 100",r["gl-gpu"][e].style.strokeDasharray=(.27*o).toFixed(0)+" 100",r["gl-mem"][e].innerHTML=n[e]?n[e]:s?"mem: "+s.toFixed(0)+"mb":"",r["gl-fps"][e].innerHTML=a.toFixed(0)+" FPS",t(n[e],i,o,s,a,u,l)}})(this.paramLogger,this.dom,this.names),this.chartLogger=(t=>{let e={"gl-chart":this.dom.getElementsByClassName("gl-chart")};return(n,i,r)=>{let o="",s=i.length;for(let t=0;t<s;t++){let e=(r+t+1)%s;null!=i[e]&&(o=o+" "+(55*t/(s-1)).toFixed(1)+","+(45-22*i[e]/60/this.detected).toFixed(1))}e["gl-chart"][n].setAttribute("points",o),t(this.names[n],i,r)}})(this.chartLogger)}}addUI(t){-1==this.names.indexOf(t)&&(this.names.push(t),this.dom&&(this.dom.insertAdjacentHTML("beforeend",this.svg),this.updateUI()),this.cpuAccums.push(0),this.gpuAccums.push(0),this.activeAccums.push(!1))}nextFrame(t){this.frameId++;const e=t||this.now();if(this.frameId<=1)this.paramFrame=this.frameId,this.paramTime=e;else{let t=e-this.paramTime;if(t>=1e3){const n=this.frameId-this.paramFrame,i=n/t*1e3;for(let e=0;e<this.names.length;e++){const r=this.cpuAccums[e]/t*100,o=this.gpuAccums[e]/t*100,s=performance&&performance.memory?performance.memory.usedJSHeapSize/(1<<20):0;this.paramLogger(e,r,o,s,i,t,n),this.cpuAccums[e]=0,Promise.all(this.finished).then((()=>{this.gpuAccums[e]=0,this.finished=[]}))}this.paramFrame=this.frameId,this.paramTime=e}}if(this.detected&&this.chartFrame){let t=e-this.chartTime,n=this.chartHz*t/1e3;for(;--n>0&&this.detected;){const n=(this.frameId-this.chartFrame)/t*1e3;this.chart[this.circularId%this.chartLen]=n;for(let t=0;t<this.names.length;t++)this.chartLogger(t,this.chart,this.circularId);this.circularId++,this.chartFrame=this.frameId,this.chartTime=e}}else this.chartFrame=this.frameId,this.chartTime=e,this.circularId=0}begin(t){this.updateAccums(t)}end(t){this.updateAccums(t)}updateAccums(t){let e=this.names.indexOf(t);-1==e&&(e=this.names.length,this.addUI(t));const n=this.now(),i=n-this.t0;for(let r=0;r<e+1;r++)this.activeAccums[r]&&(this.cpuAccums[r]+=i);this.activeAccums[e]=!this.activeAccums[e],this.t0=n}}return n}()}(Di);const Oi=Tn(Di.exports);class Fi{constructor(t){this.destroy();const e=t.getContext("webgl")||t.getContext("experimental-webgl");this.bench=new Oi(e,{css:"\n  #gl-bench {\n    position:absolute;\n    right:0;\n    top:0;\n    z-index:1000;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  #gl-bench div {\n    position: relative;\n    display: block;\n    margin: 4px;\n    padding: 0 7px 0 10px;\n    background: #5f69de;\n    border-radius: 15px;\n    cursor: pointer;\n    opacity: 0.9;\n  }\n  #gl-bench svg {\n    height: 60px;\n    margin: 0 -1px;\n  }\n  #gl-bench text {\n    font-size: 12px;\n    font-family: Helvetica,Arial,sans-serif;\n    font-weight: 700;\n    dominant-baseline: middle;\n    text-anchor: middle;\n  }\n  #gl-bench .gl-mem {\n    font-size: 9px;\n  }\n  #gl-bench line {\n    stroke-width: 5;\n    stroke: #112211;\n    stroke-linecap: round;\n  }\n  #gl-bench polyline {\n    fill: none;\n    stroke: #112211;\n    stroke-linecap: round;\n    stroke-linejoin: round;\n    stroke-width: 3.5;\n  }\n  #gl-bench rect {\n    fill: #8288e4;\n  }\n  #gl-bench .opacity {\n    stroke: #8288e4;\n  }\n"})}begin(){var t;null==(t=this.bench)||t.begin("frame")}end(t){var e,n;null==(e=this.bench)||e.end("frame"),null==(n=this.bench)||n.nextFrame(t)}destroy(){this.bench=void 0,mt("#gl-bench").remove()}}class Mi{constructor(t){this._config=t}get pointsNumber(){return this.pointPositions&&this.pointPositions.length/2}get linksNumber(){return this.links&&this.links.length/2}updatePoints(){this.pointPositions=this.inputPointPositions}updatePointColor(){if(void 0===this.pointsNumber)return void(this.pointColors=void 0);const t=ci(this._config.pointColor);if(void 0===this.inputPointColors||this.inputPointColors.length/4!==this.pointsNumber){this.pointColors=new Float32Array(4*this.pointsNumber);for(let e=0;e<this.pointColors.length/4;e++)this.pointColors[4*e]=t[0],this.pointColors[4*e+1]=t[1],this.pointColors[4*e+2]=t[2],this.pointColors[4*e+3]=t[3]}else{this.pointColors=this.inputPointColors;for(let e=0;e<this.pointColors.length/4;e++)fi(this.pointColors[4*e])||(this.pointColors[4*e]=t[0]),fi(this.pointColors[4*e+1])||(this.pointColors[4*e+1]=t[1]),fi(this.pointColors[4*e+2])||(this.pointColors[4*e+2]=t[2]),fi(this.pointColors[4*e+3])||(this.pointColors[4*e+3]=t[3])}}updatePointSize(){if(void 0!==this.pointsNumber)if(void 0===this.inputPointSizes||this.inputPointSizes.length!==this.pointsNumber)this.pointSizes=new Float32Array(this.pointsNumber).fill(this._config.pointSize);else{this.pointSizes=this.inputPointSizes;for(let t=0;t<this.pointSizes.length;t++)fi(this.pointSizes[t])||(this.pointSizes[t]=this._config.pointSize)}else this.pointSizes=void 0}updateLinks(){this.links=this.inputLinks}updateLinkColor(){if(void 0===this.linksNumber)return void(this.linkColors=void 0);const t=ci(this._config.linkColor);if(void 0===this.inputLinkColors||this.inputLinkColors.length/4!==this.linksNumber){this.linkColors=new Float32Array(4*this.linksNumber);for(let e=0;e<this.linkColors.length/4;e++)this.linkColors[4*e]=t[0],this.linkColors[4*e+1]=t[1],this.linkColors[4*e+2]=t[2],this.linkColors[4*e+3]=t[3]}else{this.linkColors=this.inputLinkColors;for(let e=0;e<this.linkColors.length/4;e++)fi(this.linkColors[4*e])||(this.linkColors[4*e]=t[0]),fi(this.linkColors[4*e+1])||(this.linkColors[4*e+1]=t[1]),fi(this.linkColors[4*e+2])||(this.linkColors[4*e+2]=t[2]),fi(this.linkColors[4*e+3])||(this.linkColors[4*e+3]=t[3])}}updateLinkWidth(){if(void 0!==this.linksNumber)if(void 0===this.inputLinkWidths||this.inputLinkWidths.length!==this.linksNumber)this.linkWidths=new Float32Array(this.linksNumber).fill(this._config.linkWidth);else{this.linkWidths=this.inputLinkWidths;for(let t=0;t<this.linkWidths.length;t++)fi(this.linkWidths[t])||(this.linkWidths[t]=this._config.linkWidth)}else this.linkWidths=void 0}updateArrows(){void 0!==this.linksNumber?void 0===this.linkArrowsBoolean||this.linkArrowsBoolean.length!==this.linksNumber?this.linkArrows=new Array(this.linksNumber).fill(+this._config.linkArrows):this.linkArrows=this.linkArrowsBoolean.map((t=>+t)):this.linkArrows=void 0}updateLinkStrength(){void 0===this.linksNumber&&(this.linkStrength=void 0),void 0===this.inputLinkStrength||this.inputLinkStrength.length!==this.linksNumber?this.linkStrength=void 0:this.linkStrength=this.inputLinkStrength}updateClusters(){if(void 0===this.pointsNumber)return this.pointClusters=void 0,void(this.clusterPositions=void 0);void 0===this.inputPointClusters||this.inputPointClusters.length!==this.pointsNumber?this.pointClusters=void 0:this.pointClusters=this.inputPointClusters,void 0===this.inputClusterPositions?this.clusterPositions=void 0:this.clusterPositions=this.inputClusterPositions,void 0===this.inputClusterStrength||this.inputClusterStrength.length!==this.pointsNumber?this.clusterStrength=void 0:this.clusterStrength=this.inputClusterStrength}update(){this.updatePoints(),this.updatePointColor(),this.updatePointSize(),this.updateLinks(),this.updateLinkColor(),this.updateLinkWidth(),this.updateArrows(),this.updateLinkStrength(),this.updateClusters(),this._createAdjacencyLists(),this._calculateDegrees()}getAdjacentIndices(t){var e,n,i,r;return[...(null==(n=null==(e=this.sourceIndexToTargetIndices)?void 0:e[t])?void 0:n.map((t=>t[0])))||[],...(null==(r=null==(i=this.targetIndexToSourceIndices)?void 0:i[t])?void 0:r.map((t=>t[0])))||[]]}_createAdjacencyLists(){var t,e;if(void 0===this.linksNumber||void 0===this.links)return this.sourceIndexToTargetIndices=void 0,void(this.targetIndexToSourceIndices=void 0);this.sourceIndexToTargetIndices=new Array(this.pointsNumber).fill(void 0),this.targetIndexToSourceIndices=new Array(this.pointsNumber).fill(void 0);for(let n=0;n<this.linksNumber;n++){const i=this.links[2*n],r=this.links[2*n+1];void 0!==i&&void 0!==r&&(void 0===this.sourceIndexToTargetIndices[i]&&(this.sourceIndexToTargetIndices[i]=[]),null==(t=this.sourceIndexToTargetIndices[i])||t.push([r,n]),void 0===this.targetIndexToSourceIndices[r]&&(this.targetIndexToSourceIndices[r]=[]),null==(e=this.targetIndexToSourceIndices[r])||e.push([i,n]))}}_calculateDegrees(){var t,e,n,i;if(void 0===this.pointsNumber)return this.degree=void 0,this.inDegree=void 0,void(this.outDegree=void 0);this.degree=new Array(this.pointsNumber).fill(0),this.inDegree=new Array(this.pointsNumber).fill(0),this.outDegree=new Array(this.pointsNumber).fill(0);for(let r=0;r<this.pointsNumber;r++)this.inDegree[r]=(null==(e=null==(t=this.targetIndexToSourceIndices)?void 0:t[r])?void 0:e.length)??0,this.outDegree[r]=(null==(i=null==(n=this.sourceIndexToTargetIndices)?void 0:n[r])?void 0:i.length)??0,this.degree[r]=(this.inDegree[r]??0)+(this.outDegree[r]??0)}}function Bi(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ei(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Li(t){let e,n,i;function r(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(r<o){if(0!==e(i,i))return o;do{const e=r+o>>>1;n(t[e],i)<0?r=e+1:o=e}while(r<o)}return r}return 2!==t.length?(e=Bi,n=(e,n)=>Bi(t(e),n),i=(e,n)=>t(e)-n):(e=t===Bi||t===Ei?t:Ni,n=t,i=t),{left:r,center:function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=r(t,e,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length)-1);return o>n&&i(t[o-1],e)>-i(t[o],e)?o-1:o},right:function(t,i){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.length;if(r<o){if(0!==e(i,i))return o;do{const e=r+o>>>1;n(t[e],i)<=0?r=e+1:o=e}while(r<o)}return r}}}function Ni(){return 0}const ji=Li(Bi).right;function Ri(t,e){let n,i;for(const r of t)null!=r&&(void 0===n?r>=r&&(n=i=r):(n>r&&(n=r),i<r&&(i=r)));return[n,i]}Li((function(t){return null===t?NaN:+t})).center;var Vi=Math.sqrt(50),Ui=Math.sqrt(10),$i=Math.sqrt(2);function Wi(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=Vi?10:o>=Ui?5:o>=$i?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=Vi?10:o>=Ui?5:o>=$i?2:1)}function qi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Gi(t){return+t}var Hi=[0,1];function Yi(t){return t}function Xi(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function Zi(t,e,n){var i=t[0],r=t[1],o=e[0],s=e[1];return r<i?(i=Xi(r,i),o=n(s,o)):(i=Xi(i,r),o=n(o,s)),function(t){return o(i(t))}}function Ki(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),o=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)r[s]=Xi(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(e){var n=ji(t,e,1,i)-1;return o[n](r[n](e))}}function Qi(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Ji(){var t,e,n,i,r,o,s=Hi,a=Hi,u=je,l=Yi;function c(){var t=Math.min(s.length,a.length);return l!==Yi&&(l=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(s[0],s[t-1])),i=t>2?Ki:Zi,r=o=null,h}function h(e){return null==e||isNaN(e=+e)?n:(r||(r=i(s.map(t),a,u)))(t(l(e)))}return h.invert=function(n){return l(e((o||(o=i(a,s.map(t),Me)))(n)))},h.domain=function(t){return arguments.length?(s=Array.from(t,Gi),c()):s.slice()},h.range=function(t){return arguments.length?(a=Array.from(t),c()):a.slice()},h.rangeRound=function(t){return a=Array.from(t),u=Re,c()},h.clamp=function(t){return arguments.length?(l=!!t||Yi,c()):l!==Yi},h.interpolate=function(t){return arguments.length?(u=t,c()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,c()}}function tr(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function er(t){return(t=tr(Math.abs(t)))?t[1]:NaN}var nr,ir=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function rr(t){if(!(e=ir.exec(t)))throw new Error("invalid format: "+t);var e;return new or({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function or(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function sr(t,e){var n=tr(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}rr.prototype=or.prototype,or.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const ar={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>sr(100*t,e),r:sr,s:function(t,e){var n=tr(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(nr=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,s=i.length;return o===s?i:o>s?i+new Array(o-s+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+tr(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ur(t){return t}var lr,cr,hr,fr=Array.prototype.map,dr=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function pr(t){var e=void 0===t.grouping||void 0===t.thousands?ur:function(t,e){return function(n,i){for(var r=n.length,o=[],s=0,a=t[0],u=0;r>0&&a>0&&(u+a+1>i&&(a=Math.max(1,i-u)),o.push(n.substring(r-=a,r+a)),!((u+=a+1)>i));)a=t[s=(s+1)%t.length];return o.reverse().join(e)}}(fr.call(t.grouping,Number),t.thousands+""),n=void 0===t.currency?"":t.currency[0]+"",i=void 0===t.currency?"":t.currency[1]+"",r=void 0===t.decimal?".":t.decimal+"",o=void 0===t.numerals?ur:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(fr.call(t.numerals,String)),s=void 0===t.percent?"%":t.percent+"",a=void 0===t.minus?"\u2212":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function l(t){var l=(t=rr(t)).fill,c=t.align,h=t.sign,f=t.symbol,d=t.zero,p=t.width,m=t.comma,y=t.precision,v=t.trim,b=t.type;"n"===b?(m=!0,b="g"):ar[b]||(void 0===y&&(y=12),v=!0,b="g"),(d||"0"===l&&"="===c)&&(d=!0,l="0",c="=");var g="$"===f?n:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===f?i:/[%p]/.test(b)?s:"",w=ar[b],_=/[defgprs%]/.test(b);function S(t){var n,i,s,f=g,S=x;if("c"===b)S=w(t)+S,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:w(Math.abs(t),y),v&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),A&&0==+t&&"+"!==h&&(A=!1),f=(A?"("===h?h:a:"-"===h||"("===h?"":h)+f,S=("s"===b?dr[8+nr/3]:"")+S+(A&&"("===h?")":""),_)for(n=-1,i=t.length;++n<i;)if(48>(s=t.charCodeAt(n))||s>57){S=(46===s?r+t.slice(n+1):t.slice(n))+S,t=t.slice(0,n);break}}m&&!d&&(t=e(t,1/0));var T=f.length+t.length+S.length,I=T<p?new Array(p-T+1).join(l):"";switch(m&&d&&(t=e(I+t,I.length?p-S.length:1/0),I=""),c){case"<":t=f+t+S+I;break;case"=":t=f+I+t+S;break;case"^":t=I.slice(0,T=I.length>>1)+f+t+S+I.slice(T);break;default:t=I+f+t+S}return o(t)}return y=void 0===y?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),S.toString=function(){return t+""},S}return{format:l,formatPrefix:function(t,e){var n=l(((t=rr(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(er(e)/3))),r=Math.pow(10,-i),o=dr[8+i/3];return function(t){return n(r*t)+o}}}}function mr(t,e,n,i){var r,o=function(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=Vi?r*=10:o>=Ui?r*=5:o>=$i&&(r*=2),e<t?-r:r}(t,e,n);switch((i=rr(i??",f")).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null==i.precision&&!isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(er(e)/3)))-er(Math.abs(t)))}(o,s))&&(i.precision=r),hr(i,s);case"":case"e":case"g":case"p":case"r":null==i.precision&&!isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,er(e)-er(t))+1}(o,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=r-("e"===i.type));break;case"f":case"%":null==i.precision&&!isNaN(r=function(t){return Math.max(0,-er(Math.abs(t)))}(o))&&(i.precision=r-2*("%"===i.type))}return cr(i)}function yr(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var i,r,o,s,a=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(s=Wi(t,e,n))||!isFinite(s))return[];if(s>0){let n=Math.round(t/s),i=Math.round(e/s);for(n*s<t&&++n,i*s>e&&--i,o=new Array(r=i-n+1);++a<r;)o[a]=(n+a)*s}else{s=-s;let n=Math.round(t*s),i=Math.round(e*s);for(n/s<t&&++n,i/s>e&&--i,o=new Array(r=i-n+1);++a<r;)o[a]=(n+a)/s}return i&&o.reverse(),o}(n[0],n[n.length-1],t??10)},t.tickFormat=function(t,n){var i=e();return mr(i[0],i[i.length-1],t??10,n)},t.nice=function(n){null==n&&(n=10);var i,r,o=e(),s=0,a=o.length-1,u=o[s],l=o[a],c=10;for(l<u&&(r=u,u=l,l=r,r=s,s=a,a=r);c-- >0;){if((r=Wi(u,l,n))===i)return o[s]=u,o[a]=l,e(o);if(r>0)u=Math.floor(u/r)*r,l=Math.ceil(l/r)*r;else{if(!(r<0))break;u=Math.ceil(u*r)/r,l=Math.floor(l*r)/r}i=r}return t},t}function vr(){var t=Ji()(Yi,Yi);return t.copy=function(){return Qi(t,vr())},qi.apply(t,arguments),yr(t)}function br(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function gr(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function xr(t){return t<0?-t*t:t*t}function wr(t){var e=t(Yi,Yi),n=1;return e.exponent=function(e){return arguments.length?1===(n=+e)?t(Yi,Yi):.5===n?t(gr,xr):t(br(n),br(1/n)):n},yr(e)}function _r(){var t=wr(Ji());return t.copy=function(){return Qi(t,_r()).exponent(t.exponent())},qi.apply(t,arguments),t}!function(t){lr=pr(t),cr=lr.format,hr=lr.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Sr=t=>{const e=_r().exponent(2).range([0,1]).domain([-1,1]),n=function(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(r);++i<r;)o[i]=t+i*n;return o}(0,t).map((e=>e/t-.5));n.push(.5);const i=new Array(2*n.length);return n.forEach(((t,n)=>{i[2*n]=[e(2*t),.5],i[2*n+1]=[e(2*t),-.5]})),i};class Ar extends pi{initPrograms(){const{reglInstance:t,config:e,store:n}=this;this.drawCurveCommand||(this.drawCurveCommand=t({vert:"precision highp float;\nattribute vec2 position, pointA, pointB;\nattribute vec4 color;\nattribute float width;\nattribute float arrow;\nuniform sampler2D positionsTexture;\nuniform sampler2D pointGreyoutStatus;\nuniform mat3 transformationMatrix;\nuniform float pointsTextureSize;\nuniform float widthScale;\nuniform float arrowSizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform float ratio;\nuniform vec2 linkVisibilityDistanceRange;\nuniform float linkVisibilityMinTransparency;\nuniform float greyoutOpacity;\nuniform float curvedWeight;\nuniform float curvedLinkControlPointDistance;\nuniform float curvedLinkSegments;\n\nvarying vec4 rgbaColor;\nvarying vec2 pos;\nvarying float arrowLength;\nvarying float linkWidthArrowWidthRatio;\nvarying float smoothWidthRatio;\nvarying float useArrow;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvec2 conicParametricCurve(vec2 A, vec2 B, vec2 ControlPoint, float t, float w) {\n  vec2 divident = (1.0 - t) * (1.0 - t) * A + 2.0 * (1.0 - t) * t * w * ControlPoint + t * t * B;\n  float divisor = (1.0 - t) * (1.0 - t) + 2.0 * (1.0 - t) * t * w + t * t;\n  return divident / divisor;\n}\n\nvoid main() {\n  pos = position;\n\n  vec2 pointTexturePosA = (pointA + 0.5) / pointsTextureSize;\n  vec2 pointTexturePosB = (pointB + 0.5) / pointsTextureSize;\n  \n  vec4 greyoutStatusA = texture2D(pointGreyoutStatus, pointTexturePosA);\n  vec4 greyoutStatusB = texture2D(pointGreyoutStatus, pointTexturePosB);\n  \n  vec4 pointPositionA = texture2D(positionsTexture, pointTexturePosA);\n  vec4 pointPositionB = texture2D(positionsTexture, pointTexturePosB);\n  vec2 a = pointPositionA.xy;\n  vec2 b = pointPositionB.xy;\n  vec2 xBasis = b - a;\n  vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n\n  \n  float linkDist = length(xBasis);\n  float h = curvedLinkControlPointDistance;\n  vec2 controlPoint = (a + b) / 2.0 + yBasis * linkDist * h;\n\n  float linkDistPx = linkDist * transformationMatrix[0][0];\n  \n  float linkWidth = width * widthScale;\n  float k = 2.0;\n  float arrowWidth = max(5.0, linkWidth * k);\n  arrowWidth *= arrowSizeScale;\n\n  float arrowWidthPx = arrowWidth / transformationMatrix[0][0];\n  arrowLength = min(0.3, (0.866 * arrowWidthPx * 2.0) / linkDist);\n\n  float smoothWidth = 2.0;\n  float arrowExtraWidth = arrowWidth - linkWidth;\n  linkWidth += smoothWidth / 2.0;\n  useArrow = arrow;\n  if (useArrow > 0.5) {\n    linkWidth += arrowExtraWidth;\n  }\n  smoothWidthRatio = smoothWidth / linkWidth;\n  linkWidthArrowWidthRatio = arrowExtraWidth / linkWidth;\n\n  float linkWidthPx = linkWidth / transformationMatrix[0][0];\n\n  \n  vec3 rgbColor = color.rgb;\n  float opacity = color.a * max(linkVisibilityMinTransparency, map(linkDistPx, linkVisibilityDistanceRange.g, linkVisibilityDistanceRange.r, 0.0, 1.0));\n\n  if (greyoutStatusA.r > 0.0 || greyoutStatusB.r > 0.0) {\n    opacity *= greyoutOpacity;\n  }\n\n  rgbaColor = vec4(rgbColor, opacity);\n\n  float t = position.x;\n  float w = curvedWeight;\n  float tPrev = t - 1.0 / curvedLinkSegments;\n  float tNext = t + 1.0 / curvedLinkSegments;\n  vec2 pointCurr = conicParametricCurve(a, b, controlPoint, t, w);\n  vec2 pointPrev = conicParametricCurve(a, b, controlPoint, max(0.0, tPrev), w);\n  vec2 pointNext = conicParametricCurve(a, b, controlPoint, min(tNext, 1.0), w);\n  vec2 xBasisCurved = pointNext - pointPrev;\n  vec2 yBasisCurved = normalize(vec2(-xBasisCurved.y, xBasisCurved.x));\n  pointCurr += yBasisCurved * linkWidthPx * position.y;\n  vec2 p = 2.0 * pointCurr / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  vec3 final =  transformationMatrix * vec3(p, 1);\n  gl_Position = vec4(final.rg, 0, 1);\n}",frag:"precision highp float;\n\nvarying vec4 rgbaColor;\nvarying vec2 pos;\nvarying float arrowLength;\nvarying float linkWidthArrowWidthRatio;\nvarying float smoothWidthRatio;\nvarying float useArrow;\n\nfloat map(float value, float min1, float max1, float min2, float max2) {\n  return min2 + (value - min1) * (max2 - min2) / (max1 - min1);\n}\n\nvoid main() {\n  float opacity = 1.0;\n  vec3 color = rgbaColor.rgb;\n  float smoothDelta = smoothWidthRatio / 2.0;\n  if (useArrow > 0.5) {\n    float end_arrow = 0.5 + arrowLength / 2.0;\n    float start_arrow = end_arrow - arrowLength;\n    float arrowWidthDelta = linkWidthArrowWidthRatio / 2.0;\n    float linkOpacity = rgbaColor.a * smoothstep(0.5 - arrowWidthDelta, 0.5 - arrowWidthDelta - smoothDelta, abs(pos.y));\n    float arrowOpacity = 1.0;\n    if (pos.x > start_arrow && pos.x < start_arrow + arrowLength) {\n      float xmapped = map(pos.x, start_arrow, end_arrow, 0.0, 1.0);\n      arrowOpacity = rgbaColor.a * smoothstep(xmapped - smoothDelta, xmapped, map(abs(pos.y), 0.5, 0.0, 0.0, 1.0));\n      if (linkOpacity != arrowOpacity) {\n        linkOpacity += arrowOpacity;\n      }\n    }\n    opacity = linkOpacity;\n  } else opacity = rgbaColor.a * smoothstep(0.5, 0.5 - smoothDelta, abs(pos.y));\n  \n  gl_FragColor = vec4(color, opacity);\n}",attributes:{position:{buffer:()=>this.curveLineBuffer,divisor:0},pointA:{buffer:()=>this.pointsBuffer,divisor:1,offset:0*Float32Array.BYTES_PER_ELEMENT,stride:4*Float32Array.BYTES_PER_ELEMENT},pointB:{buffer:()=>this.pointsBuffer,divisor:1,offset:2*Float32Array.BYTES_PER_ELEMENT,stride:4*Float32Array.BYTES_PER_ELEMENT},color:{buffer:()=>this.colorBuffer,divisor:1,offset:0*Float32Array.BYTES_PER_ELEMENT,stride:4*Float32Array.BYTES_PER_ELEMENT},width:{buffer:()=>this.widthBuffer,divisor:1,offset:0*Float32Array.BYTES_PER_ELEMENT,stride:1*Float32Array.BYTES_PER_ELEMENT},arrow:{buffer:()=>this.arrowBuffer,divisor:1,offset:0*Float32Array.BYTES_PER_ELEMENT,stride:1*Float32Array.BYTES_PER_ELEMENT}},uniforms:{positionsTexture:()=>{var t;return null==(t=this.points)?void 0:t.currentPositionFbo},pointGreyoutStatus:()=>{var t;return null==(t=this.points)?void 0:t.greyoutStatusFbo},transformationMatrix:()=>n.transform,pointsTextureSize:()=>n.pointsTextureSize,pointSizeScale:()=>e.pointSizeScale,widthScale:()=>e.linkWidthScale,arrowSizeScale:()=>e.linkArrowsSizeScale,spaceSize:()=>n.adjustedSpaceSize,screenSize:()=>n.screenSize,ratio:()=>e.pixelRatio,linkVisibilityDistanceRange:()=>e.linkVisibilityDistanceRange,linkVisibilityMinTransparency:()=>e.linkVisibilityMinTransparency,greyoutOpacity:()=>e.linkGreyoutOpacity,scalePointsOnZoom:()=>e.scalePointsOnZoom,curvedWeight:()=>e.curvedLinkWeight,curvedLinkControlPointDistance:()=>e.curvedLinkControlPointDistance,curvedLinkSegments:()=>e.curvedLinks?e.curvedLinkSegments??En:1},cull:{enable:!0,face:"back"},blend:{enable:!0,func:{dstRGB:"one minus src alpha",srcRGB:"src alpha",dstAlpha:"one minus src alpha",srcAlpha:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1},count:()=>{var t;return(null==(t=this.curveLineGeometry)?void 0:t.length)??0},instances:()=>this.data.linksNumber??0,primitive:"triangle strip"}))}draw(){var t;!this.pointsBuffer||!this.curveLineBuffer||(this.colorBuffer||this.updateColor(),this.widthBuffer||this.updateWidth(),this.arrowBuffer||this.updateArrow(),null==(t=this.drawCurveCommand)||t.call(this))}updatePointsBuffer(){const{reglInstance:t,data:e,store:n}=this;if(void 0===e.linksNumber||void 0===e.links)return;const i=new Float32Array(4*e.linksNumber);for(let r=0;r<e.linksNumber;r++){const t=e.links[2*r],o=e.links[2*r+1],s=t%n.pointsTextureSize,a=Math.floor(t/n.pointsTextureSize),u=o%n.pointsTextureSize,l=Math.floor(o/n.pointsTextureSize),c=4*r;i[c]=s,i[c+1]=a,i[c+2]=u,i[c+3]=l}this.pointsBuffer||(this.pointsBuffer=t.buffer(0)),this.pointsBuffer(i)}updateColor(){const{reglInstance:t,data:e}=this;this.colorBuffer||(this.colorBuffer=t.buffer(0)),this.colorBuffer(e.linkColors??new Float32Array)}updateWidth(){const{reglInstance:t,data:e}=this;this.widthBuffer||(this.widthBuffer=t.buffer(0)),this.widthBuffer(e.linkWidths??new Float32Array)}updateArrow(){const{reglInstance:t,data:e}=this;this.arrowBuffer||(this.arrowBuffer=t.buffer(0)),this.arrowBuffer(e.linkArrows??new Float32Array)}updateCurveLineGeometry(){const{reglInstance:t,config:{curvedLinks:e,curvedLinkSegments:n}}=this;this.curveLineGeometry=Sr(e?n??En:1),this.curveLineBuffer||(this.curveLineBuffer=t.buffer(0)),this.curveLineBuffer(this.curveLineGeometry)}}class Tr extends pi{updatePositions(){const{reglInstance:t,store:e,data:n,config:{disableRescalePositions:i,disableSimulation:r}}=this,{pointsTextureSize:o}=e;if(!o||!n.pointPositions||void 0===n.pointsNumber)return;const s=new Float32Array(o*o*4);this.scaleX=void 0,this.scaleY=void 0,(!1===i||void 0===i&&r)&&this.rescaleInitialNodePositions();for(let a=0;a<n.pointsNumber;++a)s[4*a+0]=n.pointPositions[2*a+0],s[4*a+1]=n.pointPositions[2*a+1],s[4*a+2]=a;vi(this.currentPositionFbo),this.currentPositionFbo=t.framebuffer({color:t.texture({data:s,shape:[o,o,4],type:"float"}),depth:!1,stencil:!1}),vi(this.previousPositionFbo),this.previousPositionFbo=t.framebuffer({color:t.texture({data:s,shape:[o,o,4],type:"float"}),depth:!1,stencil:!1}),this.config.disableSimulation||(vi(this.velocityFbo),this.velocityFbo=t.framebuffer({color:t.texture({data:new Float32Array(o*o*4).fill(0),shape:[o,o,4],type:"float"}),depth:!1,stencil:!1})),this.selectedTexture||(this.selectedTexture=t.texture()),this.selectedTexture({data:s,shape:[o,o,4],type:"float"}),this.selectedFbo||(this.selectedFbo=t.framebuffer({color:this.selectedTexture,depth:!1,stencil:!1})),this.hoveredFbo||(this.hoveredFbo=t.framebuffer({shape:[2,2],colorType:"float",depth:!1,stencil:!1})),this.drawPointIndices||(this.drawPointIndices=t.buffer(0)),this.drawPointIndices(yi(e.pointsTextureSize)),this.hoveredPointIndices||(this.hoveredPointIndices=t.buffer(0)),this.hoveredPointIndices(yi(e.pointsTextureSize)),this.sampledPointIndices||(this.sampledPointIndices=t.buffer(0)),this.sampledPointIndices(yi(e.pointsTextureSize)),this.updateGreyoutStatus(),this.updateSampledPointsGrid(),this.trackPointsByIndices()}initPrograms(){const{reglInstance:t,config:e,store:n,data:i}=this;e.disableSimulation||this.updatePositionCommand||(this.updatePositionCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D velocity;\nuniform float friction;\nuniform float spaceSize;\n\nvarying vec2 textureCoords;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  vec4 pointVelocity = texture2D(velocity, textureCoords);\n\n  \n  pointVelocity.rg *= friction;\n\n  pointPosition.rg += pointVelocity.rg;\n\n  pointPosition.r = clamp(pointPosition.r, 0.0, spaceSize);\n  pointPosition.g = clamp(pointPosition.g, 0.0, spaceSize);\n  \n  gl_FragColor = pointPosition;\n}",vert:gi,framebuffer:()=>this.currentPositionFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>this.previousPositionFbo,velocity:()=>this.velocityFbo,friction:()=>e.simulationFriction,spaceSize:()=>n.adjustedSpaceSize}})),this.dragPointCommand||(this.dragPointCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform vec2 mousePos;\nuniform float index;\n\nvarying vec2 textureCoords;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n\n  \n  if (index >= 0.0 && index == pointPosition.b) {\n    pointPosition.rg = mousePos.rg;\n  }\n\n  gl_FragColor = pointPosition;\n}",vert:gi,framebuffer:()=>this.currentPositionFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>this.previousPositionFbo,mousePos:()=>n.mousePosition,index:()=>{var t;return(null==(t=n.hoveredPoint)?void 0:t.index)??-1}}})),this.drawCommand||(this.drawCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec3 rgbColor;\nvarying float alpha;\n\nconst float smoothing = 0.9;\n\nvoid main() {\n    \n    if (alpha == 0.0) { discard; }\n\n    \n    vec2 pointCoord = 2.0 * gl_PointCoord - 1.0;\n    \n    float pointCenterDistance = dot(pointCoord, pointCoord);\n    \n    float opacity = alpha * (1.0 - smoothstep(smoothing, 1.0, pointCenterDistance));\n\n    gl_FragColor = vec4(rgbColor, opacity);\n}",vert:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nattribute vec2 pointIndices;\nattribute float size;\nattribute vec4 color;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D pointGreyoutStatus;\nuniform float ratio;\nuniform mat3 transformationMatrix;\nuniform float pointsTextureSize;\nuniform float sizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform float greyoutOpacity;\nuniform bool scalePointsOnZoom;\nuniform float maxPointSize;\n\nvarying vec2 textureCoords;\nvarying vec3 rgbColor;\nvarying float alpha;\n\nfloat calculatePointSize(float size) {\n  float pSize;\n  if (scalePointsOnZoom) { \n    pSize = size * ratio * transformationMatrix[0][0];\n  } else {\n    pSize = size * ratio * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n  }\n\n  return min(pSize, maxPointSize * ratio);\n}\n\nvoid main() {  \n  textureCoords = pointIndices;\n  \n  vec4 pointPosition = texture2D(positionsTexture, (textureCoords + 0.5) / pointsTextureSize);\n  vec2 point = pointPosition.rg;\n\n  \n  vec2 normalizedPosition = 2.0 * point / spaceSize - 1.0;\n  normalizedPosition *= spaceSize / screenSize;\n  vec3 finalPosition = transformationMatrix * vec3(normalizedPosition, 1);\n  gl_Position = vec4(finalPosition.rg, 0, 1);\n\n  gl_PointSize = calculatePointSize(size * sizeScale);\n\n  rgbColor = color.rgb;\n  alpha = color.a;\n\n  \n  vec4 greyoutStatus = texture2D(pointGreyoutStatus, (textureCoords + 0.5) / pointsTextureSize);\n  if (greyoutStatus.r > 0.0) {\n    alpha *= greyoutOpacity;\n  }\n}",primitive:"points",count:()=>i.pointsNumber??0,attributes:{pointIndices:{buffer:this.drawPointIndices,size:2},size:{buffer:()=>this.sizeBuffer,size:1},color:{buffer:()=>this.colorBuffer,size:4}},uniforms:{positionsTexture:()=>this.currentPositionFbo,pointGreyoutStatus:()=>this.greyoutStatusFbo,ratio:()=>e.pixelRatio,sizeScale:()=>e.pointSizeScale,pointsTextureSize:()=>n.pointsTextureSize,transformationMatrix:()=>n.transform,spaceSize:()=>n.adjustedSpaceSize,screenSize:()=>n.screenSize,greyoutOpacity:()=>e.pointGreyoutOpacity,scalePointsOnZoom:()=>e.scalePointsOnZoom,maxPointSize:()=>n.maxPointSize},blend:{enable:!0,func:{dstRGB:"one minus src alpha",srcRGB:"src alpha",dstAlpha:"one minus src alpha",srcAlpha:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1}})),this.findPointsOnAreaSelectionCommand||(this.findPointsOnAreaSelectionCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D pointSize;\nuniform float sizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform float ratio;\nuniform mat3 transformationMatrix;\nuniform vec2 selection[2];\nuniform bool scalePointsOnZoom;\nuniform float maxPointSize;\n\nvarying vec2 textureCoords;\n\nfloat pointSizeF(float size) {\n  float pSize;\n  if (scalePointsOnZoom) { \n    pSize = size * ratio * transformationMatrix[0][0];\n  } else {\n    pSize = size * ratio * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n  }\n  return min(pSize, maxPointSize * ratio);\n}\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, textureCoords);\n  vec2 p = 2.0 * pointPosition.rg / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  vec3 final = transformationMatrix * vec3(p, 1);\n\n  vec4 pSize = texture2D(pointSize, textureCoords);\n  float size = pSize.r * sizeScale;\n\n  float left = 2.0 * (selection[0].x - 0.5 * pointSizeF(size)) / screenSize.x - 1.0;\n  float right = 2.0 * (selection[1].x + 0.5 * pointSizeF(size)) / screenSize.x - 1.0;\n  float top =  2.0 * (selection[0].y - 0.5 * pointSizeF(size)) / screenSize.y - 1.0;\n  float bottom =  2.0 * (selection[1].y + 0.5 * pointSizeF(size)) / screenSize.y - 1.0;\n\n  gl_FragColor = vec4(0.0, 0.0, pointPosition.rg);\n  if (final.x >= left && final.x <= right && final.y >= top && final.y <= bottom) {\n    gl_FragColor.r = 1.0;\n  }\n}",vert:gi,framebuffer:()=>this.selectedFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>this.currentPositionFbo,pointSize:()=>this.sizeFbo,spaceSize:()=>n.adjustedSpaceSize,screenSize:()=>n.screenSize,sizeScale:()=>e.pointSizeScale,transformationMatrix:()=>n.transform,ratio:()=>e.pixelRatio,"selection[0]":()=>n.selectedArea[0],"selection[1]":()=>n.selectedArea[1],scalePointsOnZoom:()=>e.scalePointsOnZoom,maxPointSize:()=>n.maxPointSize}})),this.clearHoveredFboCommand||(this.clearHoveredFboCommand=t({frag:bi,vert:gi,framebuffer:this.hoveredFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)}})),this.findHoveredPointCommand||(this.findHoveredPointCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec4 rgba;\n\nvoid main() {\n  gl_FragColor = rgba;\n}",vert:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nattribute float size;\n\nuniform sampler2D positionsTexture;\nuniform float pointsTextureSize;\nuniform float sizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform float ratio;\nuniform mat3 transformationMatrix;\nuniform vec2 mousePosition;\nuniform bool scalePointsOnZoom;\nuniform float maxPointSize;\n\nattribute vec2 pointIndices;\n\nvarying vec4 rgba;\n\nfloat calculatePointSize(float size) {\n  float pSize;\n  if (scalePointsOnZoom) { \n    pSize = size * ratio * transformationMatrix[0][0];\n  } else {\n    pSize = size * ratio * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n  }\n  return min(pSize, maxPointSize * ratio);\n}\n\nfloat euclideanDistance (float x1, float x2, float y1, float y2) {\n  return sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n}\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, (pointIndices + 0.5) / pointsTextureSize);\n\n  \n  vec2 normalizedPoint = 2.0 * pointPosition.rg / spaceSize - 1.0;\n  normalizedPoint *= spaceSize / screenSize;\n  vec3 finalPosition = transformationMatrix * vec3(normalizedPoint, 1);\n\n  float pointRadius = 0.5 * calculatePointSize(size * sizeScale);\n\n  vec2 pointScreenPosition = (finalPosition.xy + 1.0) * screenSize / 2.0;\n  rgba = vec4(0.0);\n  gl_Position = vec4(0.5, 0.5, 0.0, 1.0);\n  \n  if (euclideanDistance(pointScreenPosition.x, mousePosition.x, pointScreenPosition.y, mousePosition.y) < pointRadius / ratio) {\n    float index = pointIndices.g * pointsTextureSize + pointIndices.r;\n    rgba = vec4(index, size, pointPosition.xy);\n    gl_Position = vec4(-0.5, -0.5, 0.0, 1.0);\n  }\n\n  gl_PointSize = 1.0;\n}",primitive:"points",count:()=>i.pointsNumber??0,framebuffer:()=>this.hoveredFbo,attributes:{pointIndices:{buffer:this.hoveredPointIndices,size:2},size:{buffer:()=>this.sizeBuffer,size:1}},uniforms:{positionsTexture:()=>this.currentPositionFbo,ratio:()=>e.pixelRatio,sizeScale:()=>e.pointSizeScale,pointsTextureSize:()=>n.pointsTextureSize,transformationMatrix:()=>n.transform,spaceSize:()=>n.adjustedSpaceSize,screenSize:()=>n.screenSize,scalePointsOnZoom:()=>e.scalePointsOnZoom,mousePosition:()=>n.screenMousePosition,maxPointSize:()=>n.maxPointSize},depth:{enable:!1,mask:!1}})),this.clearSampledPointsFboCommand||(this.clearSampledPointsFboCommand=t({frag:bi,vert:gi,framebuffer:()=>this.sampledPointsFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)}})),this.fillSampledPointsFboCommand||(this.fillSampledPointsFboCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nvarying vec4 rgba;\n\nvoid main() {\n  gl_FragColor = rgba;\n}",vert:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform float pointsTextureSize;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform mat3 transformationMatrix;\n\nattribute vec2 pointIndices;\n\nvarying vec4 rgba;\n\nvoid main() {\n  vec4 pointPosition = texture2D(positionsTexture, (pointIndices + 0.5) / pointsTextureSize);\n  vec2 p = 2.0 * pointPosition.rg / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  vec3 final = transformationMatrix * vec3(p, 1);\n\n  vec2 pointScreenPosition = (final.xy + 1.0) * screenSize / 2.0;\n  float index = pointIndices.g * pointsTextureSize + pointIndices.r;\n  rgba = vec4(index, 1.0, pointPosition.xy);\n  float i = (pointScreenPosition.x + 0.5) / screenSize.x;\n  float j = (pointScreenPosition.y + 0.5) / screenSize.y;\n  gl_Position = vec4(2.0 * vec2(i, j) - 1.0, 0.0, 1.0);\n\n  gl_PointSize = 1.0;\n}",primitive:"points",count:()=>i.pointsNumber??0,framebuffer:()=>this.sampledPointsFbo,attributes:{pointIndices:{buffer:this.sampledPointIndices,size:2}},uniforms:{positionsTexture:()=>this.currentPositionFbo,pointsTextureSize:()=>n.pointsTextureSize,transformationMatrix:()=>n.transform,spaceSize:()=>n.adjustedSpaceSize,screenSize:()=>n.screenSize},depth:{enable:!1,mask:!1}})),this.drawHighlightedCommand||(this.drawHighlightedCommand=t({frag:"precision mediump float;\n\nuniform vec4 color;\nuniform float width;\n\nvarying vec2 vertexPosition;\nvarying float pointOpacity;\n\nconst float smoothing = 1.05;\n\nvoid main () {\n  float r = dot(vertexPosition, vertexPosition);\n  float opacity = smoothstep(r, r * smoothing, 1.0);\n  float stroke = smoothstep(width, width * smoothing, r);\n  gl_FragColor = vec4(color.rgb, opacity * stroke * color.a * pointOpacity);\n}",vert:"precision mediump float;\n\nattribute vec2 vertexCoord;\n\nuniform sampler2D positionsTexture;\nuniform sampler2D pointGreyoutStatusTexture;\nuniform float size;\nuniform mat3 transformationMatrix;\nuniform float pointsTextureSize;\nuniform float sizeScale;\nuniform float spaceSize;\nuniform vec2 screenSize;\nuniform bool scalePointsOnZoom;\nuniform float pointIndex;\nuniform float maxPointSize;\nuniform vec4 color;\nuniform float greyoutOpacity;\n\nvarying vec2 vertexPosition;\nvarying float pointOpacity;\n\nfloat calculatePointSize(float size) {\n  float pSize;\n  if (scalePointsOnZoom) { \n    pSize = size * transformationMatrix[0][0];\n  } else {\n    pSize = size * min(5.0, max(1.0, transformationMatrix[0][0] * 0.01));\n  }\n  return min(pSize, maxPointSize);\n}\n\nconst float relativeRingRadius = 1.3;\n\nvoid main () {\n  vertexPosition = vertexCoord;\n\n  vec2 textureCoordinates = vec2(mod(pointIndex, pointsTextureSize), floor(pointIndex / pointsTextureSize)) + 0.5;\n  vec4 pointPosition = texture2D(positionsTexture, textureCoordinates / pointsTextureSize);\n\n  \n  pointOpacity = color.a;\n  vec4 greyoutStatus = texture2D(pointGreyoutStatusTexture, textureCoordinates / pointsTextureSize);\n  if (greyoutStatus.r > 0.0) {\n    pointOpacity *= greyoutOpacity;\n  }\n\n  \n  float pointSize = (calculatePointSize(size * sizeScale) * relativeRingRadius) / transformationMatrix[0][0];\n  float radius = pointSize * 0.5;\n\n  \n  vec2 a = pointPosition.xy;\n  vec2 b = pointPosition.xy + vec2(0.0, radius);\n  vec2 xBasis = b - a;\n  vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));\n  vec2 pointPositionInScreenSpace = a + xBasis * vertexCoord.x + yBasis * radius * vertexCoord.y;\n\n  \n  vec2 p = 2.0 * pointPositionInScreenSpace / spaceSize - 1.0;\n  p *= spaceSize / screenSize;\n  vec3 final =  transformationMatrix * vec3(p, 1);\n  \n  gl_Position = vec4(final.rg, 0, 1);\n}",attributes:{vertexCoord:mi(t)},primitive:"triangle strip",count:4,uniforms:{color:t.prop("color"),width:t.prop("width"),pointIndex:t.prop("pointIndex"),size:t.prop("size"),positionsTexture:()=>this.currentPositionFbo,sizeScale:()=>e.pointSizeScale,pointsTextureSize:()=>n.pointsTextureSize,transformationMatrix:()=>n.transform,spaceSize:()=>n.adjustedSpaceSize,screenSize:()=>n.screenSize,scalePointsOnZoom:()=>e.scalePointsOnZoom,maxPointSize:()=>n.maxPointSize,pointGreyoutStatusTexture:()=>this.greyoutStatusFbo,greyoutOpacity:()=>e.pointGreyoutOpacity},blend:{enable:!0,func:{dstRGB:"one minus src alpha",srcRGB:"src alpha",dstAlpha:"one minus src alpha",srcAlpha:"one"},equation:{rgb:"add",alpha:"add"}},depth:{enable:!1,mask:!1}})),this.trackPointsCommand||(this.trackPointsCommand=t({frag:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D positionsTexture;\nuniform sampler2D trackedIndices;\nuniform float pointsTextureSize;\n\nvarying vec2 textureCoords;\n\nvoid main() {\n  vec4 trackedPointIndices = texture2D(trackedIndices, textureCoords);\n  if (trackedPointIndices.r < 0.0) discard;\n  vec4 pointPosition = texture2D(positionsTexture, (trackedPointIndices.rg + 0.5) / pointsTextureSize);\n\n  gl_FragColor = vec4(pointPosition.rg, 1.0, 1.0);\n}",vert:gi,framebuffer:()=>this.trackedPositionsFbo,primitive:"triangle strip",count:4,attributes:{vertexCoord:mi(t)},uniforms:{positionsTexture:()=>this.currentPositionFbo,trackedIndices:()=>this.trackedIndicesFbo,pointsTextureSize:()=>n.pointsTextureSize}}))}updateColor(){const{reglInstance:t,store:{pointsTextureSize:e},data:n}=this;e&&(this.colorBuffer||(this.colorBuffer=t.buffer(0)),this.colorBuffer(n.pointColors))}updateGreyoutStatus(){const{reglInstance:t,store:{selectedIndices:e,pointsTextureSize:n}}=this;if(!n)return;const i=new Float32Array(n*n*4).fill(e?1:0);if(e)for(const r of e)i[4*r]=0;this.greyoutStatusTexture||(this.greyoutStatusTexture=t.texture()),this.greyoutStatusTexture({data:i,width:n,height:n,type:"float"}),this.greyoutStatusFbo||(this.greyoutStatusFbo=t.framebuffer({color:this.greyoutStatusTexture,depth:!1,stencil:!1}))}updateSize(){const{reglInstance:t,store:{pointsTextureSize:e},data:n}=this;if(!e||void 0===n.pointsNumber||void 0===n.pointSizes)return;this.sizeBuffer||(this.sizeBuffer=t.buffer(0)),this.sizeBuffer(n.pointSizes);const i=new Float32Array(e*e*4);for(let r=0;r<n.pointsNumber;r++)i[4*r]=n.pointSizes[r];this.sizeTexture||(this.sizeTexture=t.texture()),this.sizeTexture({data:i,width:e,height:e,type:"float"}),this.sizeFbo||(this.sizeFbo=t.framebuffer({color:this.sizeTexture,depth:!1,stencil:!1}))}updateSampledPointsGrid(){const{store:{screenSize:t},config:{pointSamplingDistance:e},reglInstance:n}=this;let i=e??Math.min(...t)/2;0===i&&(i=oi);const r=Math.ceil(t[0]/i),o=Math.ceil(t[1]/i);vi(this.sampledPointsFbo),this.sampledPointsFbo=n.framebuffer({shape:[r,o],depth:!1,stencil:!1,colorType:"float"})}trackPoints(){var t,e;null!=(t=this.trackedIndices)&&t.length&&(null==(e=this.trackPointsCommand)||e.call(this))}draw(){var t,e,n,i,r;const{config:{renderHoveredPointRing:o,pointSize:s},store:a,data:u}=this;this.colorBuffer||this.updateColor(),this.sizeBuffer||this.updateSize(),null==(t=this.drawCommand)||t.call(this),o&&a.hoveredPoint&&(null==(n=this.drawHighlightedCommand)||n.call(this,{width:.85,color:a.hoveredPointRingColor,pointIndex:a.hoveredPoint.index,size:(null==(e=u.pointSizes)?void 0:e[a.hoveredPoint.index])??s})),a.focusedPoint&&(null==(r=this.drawHighlightedCommand)||r.call(this,{width:.75,color:a.focusedPointRingColor,pointIndex:a.focusedPoint.index,size:(null==(i=u.pointSizes)?void 0:i[a.focusedPoint.index])??s}))}updatePosition(){var t;null==(t=this.updatePositionCommand)||t.call(this),this.swapFbo()}drag(){var t;null==(t=this.dragPointCommand)||t.call(this),this.swapFbo()}findPointsOnAreaSelection(){var t;null==(t=this.findPointsOnAreaSelectionCommand)||t.call(this)}findHoveredPoint(){var t,e;null==(t=this.clearHoveredFboCommand)||t.call(this),null==(e=this.findHoveredPointCommand)||e.call(this)}trackPointsByIndices(t){const{store:{pointsTextureSize:e},reglInstance:n}=this;if(this.trackedIndices=t,null==t||!t.length)return;const i=Math.ceil(Math.sqrt(t.length)),r=new Float32Array(i*i*4).fill(-1);for(const[o,s]of t.entries())void 0!==s&&(r[4*o]=s%e,r[4*o+1]=Math.floor(s/e),r[4*o+2]=0,r[4*o+3]=0);this.trackedIndicesTexture||(this.trackedIndicesTexture=n.texture()),this.trackedIndicesTexture({data:r,width:i,height:i,type:"float"}),this.trackedIndicesFbo||(this.trackedIndicesFbo=n.framebuffer({color:this.trackedIndicesTexture,depth:!1,stencil:!1})),this.trackedPositionsFbo||(this.trackedPositionsFbo=n.framebuffer()),this.trackedPositionsFbo({shape:[i,i],depth:!1,stencil:!1,colorType:"float"}),this.trackPoints()}getTrackedPositionsMap(){const t=new Map;if(!this.trackedIndices)return t;const e=hi(this.reglInstance,this.trackedPositionsFbo);for(let n=0;n<e.length/4;n+=1){const i=e[4*n],r=e[4*n+1],o=this.trackedIndices[n];void 0!==i&&void 0!==r&&void 0!==o&&t.set(o,[i,r])}return t}getSampledPointPositionsMap(){var t,e;const n=new Map;if(!this.sampledPointsFbo)return n;null==(t=this.clearSampledPointsFboCommand)||t.call(this),null==(e=this.fillSampledPointsFboCommand)||e.call(this);const i=hi(this.reglInstance,this.sampledPointsFbo);for(let r=0;r<i.length/4;r++){const t=i[4*r],e=!!i[4*r+1],o=i[4*r+2],s=i[4*r+3];e&&void 0!==t&&void 0!==o&&void 0!==s&&n.set(t,[o,s])}return n}swapFbo(){const t=this.previousPositionFbo;this.previousPositionFbo=this.currentPositionFbo,this.currentPositionFbo=t}rescaleInitialNodePositions(){const{config:{spaceSize:t}}=this;if(!this.data.pointPositions||!t)return;const e=this.data.pointPositions,n=e.length/2;let i=1/0,r=-1/0,o=1/0,s=-1/0;for(let d=0;d<e.length;d+=2){const t=e[d],n=e[d+1];i=Math.min(i,t),r=Math.max(r,t),o=Math.min(o,n),s=Math.max(s,n)}const a=r-i,u=s-o,l=Math.max(a,u);if(l>t)return this.scaleX=void 0,void(this.scaleY=void 0);const c=(n>t*t*.001?t*Math.max(1.2,Math.sqrt(n)/t):.1*t)/l,h=(l-a)/2*c,f=(l-u)/2*c;this.scaleX=t=>(t-i)*c+h,this.scaleY=t=>(t-o)*c+f;for(let d=0;d<n;d++)this.data.pointPositions[2*d]=this.scaleX(e[2*d]),this.data.pointPositions[2*d+1]=this.scaleY(e[2*d+1])}}var Ir=typeof Float32Array<"u"?Float32Array:Array;function Cr(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],f=n[0],d=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=f*i+d*s+l,t[7]=f*r+d*a+c,t[8]=f*o+d*u+h,t}function Pr(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var kr={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n=function(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){var i=.02519603282416938*(t+=e.charCodeAt(n));i-=t=i>>>0,t=(i*=t)>>>0,t+=4294967296*(i-=t)}return 2.3283064365386963e-10*(t>>>0)};return e}();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function r(t,e){var r=new n(t),o=e&&e.state,s=r.next;return s.int32=function(){return 4294967296*r.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,r),s.state=function(){return i(r,{})}),s}e&&e.exports?e.exports=r:this.alea=r}(0,t)}(kr);var zr=kr.exports,Dr={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function r(t,e){var r=new n(t),o=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,o&&("object"==typeof o&&i(o,r),s.state=function(){return i(r,{})}),s}e&&e.exports?e.exports=r:this.xor128=r}(0,t)}(Dr);var Or=Dr.exports,Fr={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var i=0;i<n.length+64;i++)e.x^=0|n.charCodeAt(i),i==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function r(t,e){var r=new n(t),o=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,o&&("object"==typeof o&&i(o,r),s.state=function(){return i(r,{})}),s}e&&e.exports?e.exports=r:this.xorwow=r}(0,t)}(Fr);var Mr=Fr.exports,Br={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,i=e.x,r=e.i;return t=i[r],n=(t^=t>>>7)^t<<24,n^=(t=i[r+1&7])^t>>>10,n^=(t=i[r+3&7])^t>>>3,n^=(t=i[r+4&7])^t<<7,t=i[r+7&7],n^=(t^=t<<13)^t<<9,i[r]=n,e.i=r+1&7,n},function(t,e){var n,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,n=0;n<e.length;++n)i[7&n]=i[7&n]<<15^e.charCodeAt(n)+i[n+1&7]<<13;for(;i.length<8;)i.push(0);for(n=0;n<8&&0===i[n];++n);for(8==n?i[7]=-1:i[n],t.x=i,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function r(t,e){null==t&&(t=+new Date);var r=new n(t),o=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,o&&(o.x&&i(o,r),s.state=function(){return i(r,{})}),s}e&&e.exports?e.exports=r:this.xorshift7=r}(0,t)}(Br);var Er=Br.exports,Lr={exports:{}};!function(t){!function(t,e){function n(t){var e=this;e.next=function(){var t,n,i=e.w,r=e.X,o=e.i;return e.w=i=i+1640531527|0,n=r[o+34&127],t=r[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=r[o]=n^t,e.i=o,n+(i^i>>>16)|0},function(t,e){var n,i,r,o,s,a=[],u=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,u=Math.max(u,e.length)),r=0,o=-32;o<u;++o)e&&(i^=e.charCodeAt((o+32)%e.length)),0===o&&(s=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,o>=0&&(s=s+1640531527|0,r=0==(n=a[127&o]^=i+s)?r+1:0);for(r>=128&&(a[127&(e&&e.length||0)]=-1),r=127,o=512;o>0;--o)i=a[r+34&127],n=a[r=r+1&127],i^=i<<13,n^=n<<17,i^=i>>>15,n^=n>>>12,a[r]=i^n;t.w=s,t.X=a,t.i=r}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function r(t,e){null==t&&(t=+new Date);var r=new n(t),o=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,o&&(o.X&&i(o,r),s.state=function(){return i(r,{})}),s}e&&e.exports?e.exports=r:this.xor4096=r}(0,t)}(Lr);var Nr=Lr.exports,jr={exports:{}};!function(t){!function(t,e){function n(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,i=e.d,r=e.a;return t=t<<25^t>>>7^n,n=n-i|0,i=i<<24^i>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-i|0,e.d=i<<16^n>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var i=0;i<n.length+20;i++)e.b^=0|n.charCodeAt(i),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function r(t,e){var r=new n(t),o=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,o&&("object"==typeof o&&i(o,r),s.state=function(){return i(r,{})}),s}e&&e.exports?e.exports=r:this.tychei=r}(0,t)}(jr);var Rr=jr.exports,Vr={exports:{}};const Ur=In(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));!function(t){!function(e,n,i){var r,o=256,s="random",a=i.pow(o,6),u=i.pow(2,52),l=2*u,c=255;function h(t,c,h){var v=[],b=m(p((c=1==c?{entropy:!0}:c||{}).entropy?[t,y(n)]:t??function(){try{var t;return r&&(t=r.randomBytes)?t=t(o):(t=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(t)),y(t)}catch{var i=e.navigator,s=i&&i.plugins;return[+new Date,e,s,e.screen,y(n)]}}(),3),v),g=new f(v),x=function(){for(var t=g.g(6),e=a,n=0;t<u;)t=(t+n)*o,e*=o,n=g.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|g.g(4)},x.quick=function(){return g.g(4)/4294967296},x.double=x,m(y(g.S),n),(c.pass||h||function(t,e,n,r){return r&&(r.S&&d(r,g),t.state=function(){return d(g,{})}),n?(i[s]=t,e):t})(x,b,"global"in c?c.global:this==i,c.state)}function f(t){var e,n=t.length,i=this,r=0,s=i.i=i.j=0,a=i.S=[];for(n||(t=[n++]);r<o;)a[r]=r++;for(r=0;r<o;r++)a[r]=a[s=c&s+t[r%n]+(e=a[r])],a[s]=e;(i.g=function(t){for(var e,n=0,r=i.i,s=i.j,a=i.S;t--;)e=a[r=c&r+1],n=n*o+a[c&(a[r]=a[s=c&s+e])+(a[s]=e)];return i.i=r,i.j=s,n})(o)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){var n,i=[],r=typeof t;if(e&&"object"==r)for(n in t)try{i.push(p(t[n],e-1))}catch{}return i.length?i:"string"==r?t:t+"\0"}function m(t,e){for(var n,i=t+"",r=0;r<i.length;)e[c&r]=c&(n^=19*e[c&r])+i.charCodeAt(r++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(m(i.random(),n),t.exports){t.exports=h;try{r=Ur}catch{}}else i["seed"+s]=h}(typeof self<"u"?self:An,[],Math)}(Vr);var $r=zr,Wr=Or,qr=Mr,Gr=Er,Hr=Nr,Yr=Rr,Xr=Vr.exports;Xr.alea=$r,Xr.xor128=Wr,Xr.xorwow=qr,Xr.xorshift7=Gr,Xr.xor4096=Hr,Xr.tychei=Yr;const Zr=Tn(Xr);function Kr(t,e,n){return e&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,to(i.key),i)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Qr(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,Jr(t,e)}function Jr(t,e){return(Jr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function to(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t,"string");return"symbol"==typeof e?e:String(e)}var eo=function(){function t(){}return t.prototype._seed=function(t,e){if(t===(t||0))return t;for(var n=""+t,i=0,r=0;r<n.length;++r)i^=0|n.charCodeAt(r);return i},t}(),no=function(t){function e(e,n){var i;return(i=t.call(this)||this)._rng=void 0,i.seed(e,n),i}Qr(e,t);var n=e.prototype;return n.next=function(){return this._rng()},n.seed=function(t,e){this._rng=t},n.clone=function(t,n){return new e(this._rng,n)},Kr(e,[{key:"name",get:function(){return"function"}}]),e}(eo),io=function(){var t=[].slice.call(arguments),e=t[0],n=void 0===e?"default":e;switch(typeof n){case"object":if(n instanceof eo)return n;break;case"function":return new no(n);default:return new no(Zr.apply(void 0,t))}throw new Error('invalid RNG "'+n+'"')},ro=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),function(){return t.next()*(n-e)+e}};function oo(t){return new so(t)}var so=function(t){var e=this;this.n=void 0,this.isInt=function(){if(Number.isInteger(e.n))return e;throw new Error("Expected number to be an integer, got "+e.n)},this.isPositive=function(){if(e.n>0)return e;throw new Error("Expected number to be positive, got "+e.n)},this.lessThan=function(t){if(e.n<t)return e;throw new Error("Expected number to be less than "+t+", got "+e.n)},this.greaterThanOrEqual=function(t){if(e.n>=t)return e;throw new Error("Expected number to be greater than or equal to "+t+", got "+e.n)},this.greaterThan=function(t){if(e.n>t)return e;throw new Error("Expected number to be greater than "+t+", got "+e.n)},this.n=t},ao=function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),void 0===n&&(n=void 0===e?1:e,e=0),oo(e).isInt(),oo(n).isInt(),function(){return Math.floor(t.next()*(n-e+1)+e)}},uo=function(t){return function(){return t.next()>=.5}},lo=[0,0,.6931471805599453,1.791759469228055,3.1780538303479458,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469],co=function(t){return lo[t]},ho=function(t){function e(){return t.apply(this,arguments)||this}Qr(e,t);var n=e.prototype;return n.next=function(){return Math.random()},n.seed=function(t,e){},n.clone=function(){return new e},Kr(e,[{key:"name",get:function(){return"default"}}]),e}(eo),fo=function(){function t(t){var e=this;this._rng=void 0,this._patch=void 0,this._cache={},this.next=function(){return e._rng.next()},this.float=function(t,n){return e.uniform(t,n)()},this.int=function(t,n){return e.uniformInt(t,n)()},this.integer=function(t,n){return e.uniformInt(t,n)()},this.bool=function(){return e.uniformBoolean()()},this.boolean=function(){return e.uniformBoolean()()},this.uniform=function(t,n){return e._memoize("uniform",ro,t,n)},this.uniformInt=function(t,n){return e._memoize("uniformInt",ao,t,n)},this.uniformBoolean=function(){return e._memoize("uniformBoolean",uo)},this.normal=function(t,n){return function(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=1),function(){var i,r,o;do{o=(i=2*t.next()-1)*i+(r=2*t.next()-1)*r}while(!o||o>1);return e+n*r*Math.sqrt(-2*Math.log(o)/o)}}(e,t,n)},this.logNormal=function(t,n){return function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=1);var i=t.normal(e,n);return function(){return Math.exp(i())}}(e,t,n)},this.bernoulli=function(t){return function(t,e){return void 0===e&&(e=.5),oo(e).greaterThanOrEqual(0).lessThan(1),function(){return Math.floor(t.next()+e)}}(e,t)},this.binomial=function(t,n){return function(t,e,n){return void 0===e&&(e=1),void 0===n&&(n=.5),oo(e).isInt().isPositive(),oo(n).greaterThanOrEqual(0).lessThan(1),function(){for(var i=0,r=0;i++<e;)t.next()<n&&r++;return r}}(e,t,n)},this.geometric=function(t){return function(t,e){void 0===e&&(e=.5),oo(e).greaterThan(0).lessThan(1);var n=1/Math.log(1-e);return function(){return Math.floor(1+Math.log(t.next())*n)}}(e,t)},this.poisson=function(t){return function(t,e){if(void 0===e&&(e=1),oo(e).isPositive(),e<10){var n=Math.exp(-e);return function(){for(var i=n,r=0,o=t.next();o>i;)o-=i,i=e*i/++r;return r}}var i=Math.sqrt(e),r=.931+2.53*i,o=.02483*r-.059,s=1.1239+1.1328/(r-3.4),a=.9277-3.6224/(r-2);return function(){for(;;){var n=void 0,u=t.next();if(u<=.86*a)return n=u/a-.43,Math.floor((2*o/(.5-Math.abs(n))+r)*n+e+.445);u>=a?n=t.next()-.5:(n=((n=u/a-.93)<0?-.5:.5)-n,u=t.next()*a);var l=.5-Math.abs(n);if(!(l<.013&&u>l)){var c=Math.floor((2*o/l+r)*n+e+.445);if(u=u*s/(o/(l*l)+r),c>=10){var h=(c+.5)*Math.log(e/c)-e-.9189385332046727+c-(.08333333333333333-(.002777777777777778-1/(1260*c*c))/(c*c))/c;if(Math.log(u*i)<=h)return c}else if(c>=0){var f,d=null!=(f=co(c))?f:0;if(Math.log(u)<=c*Math.log(e)-e-d)return c}}}}}(e,t)},this.exponential=function(t){return function(t,e){return void 0===e&&(e=1),oo(e).isPositive(),function(){return-Math.log(1-t.next())/e}}(e,t)},this.irwinHall=function(t){return function(t,e){return void 0===e&&(e=1),oo(e).isInt().greaterThanOrEqual(0),function(){for(var n=0,i=0;i<e;++i)n+=t.next();return n}}(e,t)},this.bates=function(t){return function(t,e){void 0===e&&(e=1),oo(e).isInt().isPositive();var n=t.irwinHall(e);return function(){return n()/e}}(e,t)},this.pareto=function(t){return function(t,e){void 0===e&&(e=1),oo(e).greaterThanOrEqual(0);var n=1/e;return function(){return 1/Math.pow(1-t.next(),n)}}(e,t)},t&&t instanceof eo?this.use(t):this.use(new ho),this._cache={}}var e=t.prototype;return e.clone=function(){var e=[].slice.call(arguments);return e.length?new t(io.apply(void 0,e)):new t(this.rng.clone())},e.use=function(){this._rng=io.apply(void 0,[].slice.call(arguments))},e.patch=function(){if(this._patch)throw new Error("Math.random already patched");this._patch=Math.random,Math.random=this.uniform()},e.unpatch=function(){this._patch&&(Math.random=this._patch,delete this._patch)},e.choice=function(t){if(!Array.isArray(t))throw new Error("Random.choice expected input to be an array, got "+typeof t);var e=null==t?void 0:t.length;return e>0?t[this.uniformInt(0,e-1)()]:void 0},e._memoize=function(t,e){var n=[].slice.call(arguments,2),i=""+n.join(";"),r=this._cache[t];return(void 0===r||r.key!==i)&&(r={key:i,distribution:e.apply(void 0,[this].concat(n))},this._cache[t]=r),r.distribution},Kr(t,[{key:"rng",get:function(){return this._rng}}]),t}();new fo;const po=.001;class mo{constructor(){this.pointsTextureSize=0,this.linksTextureSize=0,this.alpha=1,this.transform=function(){var t=new Ir(9);return Ir!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}(),this.screenSize=[0,0],this.mousePosition=[0,0],this.screenMousePosition=[0,0],this.selectedArea=[[0,0],[0,0]],this.isSimulationRunning=!1,this.simulationProgress=0,this.selectedIndices=null,this.maxPointSize=64,this.hoveredPoint=void 0,this.focusedPoint=void 0,this.draggingPointIndex=void 0,this.adjustedSpaceSize=zn,this.isSpaceKeyPressed=!1,this.hoveredPointRingColor=[1,1,1,.7],this.focusedPointRingColor=[1,1,1,.95],this.alphaTarget=0,this.scalePointX=vr(),this.scalePointY=vr(),this.random=new fo,this._backgroundColor=[0,0,0,0],this.alphaDecay=t=>1-Math.pow(po,1/t)}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t;const e=function(t,e,n){return.2126*t+.7152*e+.0722*n}(t[0],t[1],t[2]);document.documentElement.style.setProperty("--cosmos-attribution-color",e>.65?"black":"white"),this.div&&(this.div.style.backgroundColor=`rgba(${255*t[0]}, ${255*t[1]}, ${255*t[2]}, ${t[3]})`)}addRandomSeed(t){this.random=this.random.clone(t)}getRandomFloat(t,e){return this.random.float(t,e)}adjustSpaceSize(t,e){t>=e?(this.adjustedSpaceSize=e/2,console.warn(`The \`spaceSize\` has been reduced to ${this.adjustedSpaceSize} due to WebGL limits`)):this.adjustedSpaceSize=t}updateScreenSize(t,e){const{adjustedSpaceSize:n}=this;this.screenSize=[t,e],this.scalePointX.domain([0,n]).range([(t-n)/2,(t+n)/2]),this.scalePointY.domain([n,0]).range([(e-n)/2,(e+n)/2])}scaleX(t){return this.scalePointX(t)}scaleY(t){return this.scalePointY(t)}setHoveredPointRingColor(t){const e=ci(t);this.hoveredPointRingColor[0]=e[0],this.hoveredPointRingColor[1]=e[1],this.hoveredPointRingColor[2]=e[2]}setFocusedPointRingColor(t){const e=ci(t);this.focusedPointRingColor[0]=e[0],this.focusedPointRingColor[1]=e[1],this.focusedPointRingColor[2]=e[2]}setFocusedPoint(t){this.focusedPoint=void 0!==t?{index:t}:void 0}addAlpha(t){return(this.alphaTarget-this.alpha)*this.alphaDecay(t)}}const yo={passive:!1},vo={capture:!0,passive:!1};function bo(t){t.stopImmediatePropagation()}function go(t){t.preventDefault(),t.stopImmediatePropagation()}function xo(t){var e=t.document.documentElement,n=mt(t).on("dragstart.drag",go,vo);"onselectstart"in e?n.on("selectstart.drag",go,vo):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function wo(t,e){var n=t.document.documentElement,i=mt(t).on("dragstart.drag",null);e&&(i.on("click.drag",go,vo),setTimeout((function(){i.on("click.drag",null)}),0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const _o=t=>()=>t;function So(t,e){let{sourceEvent:n,subject:i,target:r,identifier:o,active:s,x:a,y:u,dx:l,dy:c,dispatch:h}=e;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:h}})}function Ao(t){return!t.ctrlKey&&!t.button}function To(){return this.parentNode}function Io(t,e){return e??{x:t.x,y:t.y}}function Co(){return navigator.maxTouchPoints||"ontouchstart"in this}So.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};const Po=t=>()=>t;function ko(t,e){let{sourceEvent:n,target:i,transform:r,dispatch:o}=e;Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function zo(t,e,n){this.k=t,this.x=e,this.y=n}zo.prototype={constructor:zo,scale:function(t){return 1===t?this:new zo(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new zo(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Do=new zo(1,0,0);function Oo(t){t.stopImmediatePropagation()}function Fo(t){t.preventDefault(),t.stopImmediatePropagation()}function Mo(t){return(!t.ctrlKey||"wheel"===t.type)&&!t.button}function Bo(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function Eo(){return this.__zoom||Do}function Lo(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function No(){return navigator.maxTouchPoints||"ontouchstart"in this}function jo(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}zo.prototype;class Ro{constructor(t,e){this.eventTransform=Do,this.behavior=function(){var t,e,n,i=Mo,r=Bo,o=jo,s=Lo,a=No,u=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,h=Xe,f=bt("start","zoom","end"),d=0,p=10;function m(t){t.property("__zoom",Eo).on("wheel.zoom",_,{passive:!1}).on("mousedown.zoom",S).on("dblclick.zoom",A).filter(a).on("touchstart.zoom",T).on("touchmove.zoom",I).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(t,e){return(e=Math.max(u[0],Math.min(u[1],e)))===t.k?t:new zo(e,t.x,t.y)}function v(t,e,n){var i=e[0]-n[0]*t.k,r=e[1]-n[1]*t.k;return i===t.x&&r===t.y?t:new zo(t.k,i,r)}function b(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function g(t,e,n,i){t.on("start.zoom",(function(){x(this,arguments).event(i).start()})).on("interrupt.zoom end.zoom",(function(){x(this,arguments).event(i).end()})).tween("zoom",(function(){var t=this,o=arguments,s=x(t,o).event(i),a=r.apply(t,o),u=null==n?b(a):"function"==typeof n?n.apply(t,o):n,l=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),c=t.__zoom,f="function"==typeof e?e.apply(t,o):e,d=h(c.invert(u).concat(l/c.k),f.invert(u).concat(l/f.k));return function(t){if(1===t)t=f;else{var e=d(t),n=l/e[2];t=new zo(n,u[0]-e[0]*n,u[1]-e[1]*n)}s.zoom(null,t)}}))}function x(t,e,n){return!n&&t.__zooming||new w(t,e)}function w(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=r.apply(t,e),this.taps=0}function _(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(i.apply(this,arguments)){var a=x(this,n).event(t),c=this.__zoom,h=Math.max(u[0],Math.min(u[1],c.k*Math.pow(2,s.apply(this,arguments)))),f=yt(t);if(a.wheel)(a.mouse[0][0]!==f[0]||a.mouse[0][1]!==f[1])&&(a.mouse[1]=c.invert(a.mouse[0]=f)),clearTimeout(a.wheel);else{if(c.k===h)return;a.mouse=[f,c.invert(f)],Gt(this),a.start()}Fo(t),a.wheel=setTimeout((function(){a.wheel=null,a.end()}),150),a.zoom("mouse",o(v(y(c,h),a.mouse[0],a.mouse[1]),a.extent,l))}}function S(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),s=1;s<e;s++)r[s-1]=arguments[s];if(!n&&i.apply(this,arguments)){var a=t.currentTarget,u=x(this,r,!0).event(t),c=mt(t.view).on("mousemove.zoom",(function(t){if(Fo(t),!u.moved){var e=t.clientX-f,n=t.clientY-p;u.moved=e*e+n*n>d}u.event(t).zoom("mouse",o(v(u.that.__zoom,u.mouse[0]=yt(t,a),u.mouse[1]),u.extent,l))}),!0).on("mouseup.zoom",(function(t){c.on("mousemove.zoom mouseup.zoom",null),wo(t.view,u.moved),Fo(t),u.event(t).end()}),!0),h=yt(t,a),f=t.clientX,p=t.clientY;xo(t.view),Oo(t),u.mouse=[h,this.__zoom.invert(h)],Gt(this),u.start()}}function A(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];if(i.apply(this,arguments)){var a=this.__zoom,u=yt(t.changedTouches?t.changedTouches[0]:t,this),h=a.invert(u),f=a.k*(t.shiftKey?.5:2),d=o(v(y(a,f),u,h),r.apply(this,n),l);Fo(t),c>0?mt(this).transition().duration(c).call(g,d,u,t):mt(this).call(m.transform,d,u,t)}}function T(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];if(i.apply(this,arguments)){var a,u,l,c,h=n.touches,f=h.length,d=x(this,o,n.changedTouches.length===f).event(n);for(Oo(n),u=0;u<f;++u)c=[c=yt(l=h[u],this),this.__zoom.invert(c),l.identifier],d.touch0?!d.touch1&&d.touch0[2]!==c[2]&&(d.touch1=c,d.taps=0):(d.touch0=c,a=!0,d.taps=1+!!t);t&&(t=clearTimeout(t)),a&&(d.taps<2&&(e=c[0],t=setTimeout((function(){t=null}),500)),Gt(this),d.start())}}function I(t){if(this.__zooming){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r,s,a,u,c=x(this,n).event(t),h=t.changedTouches,f=h.length;for(Fo(t),r=0;r<f;++r)a=yt(s=h[r],this),c.touch0&&c.touch0[2]===s.identifier?c.touch0[0]=a:c.touch1&&c.touch1[2]===s.identifier&&(c.touch1[0]=a);if(s=c.that.__zoom,c.touch1){var d=c.touch0[0],p=c.touch0[1],m=c.touch1[0],b=c.touch1[1],g=(g=m[0]-d[0])*g+(g=m[1]-d[1])*g,w=(w=b[0]-p[0])*w+(w=b[1]-p[1])*w;s=y(s,Math.sqrt(g/w)),a=[(d[0]+m[0])/2,(d[1]+m[1])/2],u=[(p[0]+b[0])/2,(p[1]+b[1])/2]}else{if(!c.touch0)return;a=c.touch0[0],u=c.touch0[1]}c.zoom("touch",o(v(s,a,u),c.extent,l))}}function C(t){for(var i=arguments.length,r=new Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];if(this.__zooming){var s,a,u=x(this,r).event(t),l=t.changedTouches,c=l.length;for(Oo(t),n&&clearTimeout(n),n=setTimeout((function(){n=null}),500),s=0;s<c;++s)a=l[s],u.touch0&&u.touch0[2]===a.identifier?delete u.touch0:u.touch1&&u.touch1[2]===a.identifier&&delete u.touch1;if(u.touch1&&!u.touch0&&(u.touch0=u.touch1,delete u.touch1),u.touch0)u.touch0[1]=this.__zoom.invert(u.touch0[0]);else if(u.end(),2===u.taps&&(a=yt(a,this),Math.hypot(e[0]-a[0],e[1]-a[1])<p)){var h=mt(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return m.transform=function(t,e,n,i){var r=t.selection?t.selection():t;r.property("__zoom",Eo),t!==r?g(t,e,n,i):r.interrupt().each((function(){x(this,arguments).event(i).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},m.scaleBy=function(t,e,n,i){m.scaleTo(t,(function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)}),n,i)},m.scaleTo=function(t,e,n,i){m.transform(t,(function(){var t=r.apply(this,arguments),i=this.__zoom,s=null==n?b(t):"function"==typeof n?n.apply(this,arguments):n,a=i.invert(s),u="function"==typeof e?e.apply(this,arguments):e;return o(v(y(i,u),s,a),t,l)}),n,i)},m.translateBy=function(t,e,n,i){m.transform(t,(function(){return o(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),l)}),null,i)},m.translateTo=function(t,e,n,i,s){m.transform(t,(function(){var t=r.apply(this,arguments),s=this.__zoom,a=null==i?b(t):"function"==typeof i?i.apply(this,arguments):i;return o(Do.translate(a[0],a[1]).scale(s.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,l)}),i,s)},w.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1===++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0===--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=mt(this.that).datum();f.call(t,this.that,new ko(t,{sourceEvent:this.sourceEvent,target:m,type:t,transform:this.that.__zoom,dispatch:f}),e)}},m.wheelDelta=function(t){return arguments.length?(s="function"==typeof t?t:Po(+t),m):s},m.filter=function(t){return arguments.length?(i="function"==typeof t?t:Po(!!t),m):i},m.touchable=function(t){return arguments.length?(a="function"==typeof t?t:Po(!!t),m):a},m.extent=function(t){return arguments.length?(r="function"==typeof t?t:Po([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),m):r},m.scaleExtent=function(t){return arguments.length?(u[0]=+t[0],u[1]=+t[1],m):[u[0],u[1]]},m.translateExtent=function(t){return arguments.length?(l[0][0]=+t[0][0],l[1][0]=+t[1][0],l[0][1]=+t[0][1],l[1][1]=+t[1][1],m):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},m.constrain=function(t){return arguments.length?(o=t,m):o},m.duration=function(t){return arguments.length?(c=+t,m):c},m.interpolate=function(t){return arguments.length?(h=t,m):h},m.on=function(){var t=f.on.apply(f,arguments);return t===f?m:t},m.clickDistance=function(t){return arguments.length?(d=(t=+t)*t,m):Math.sqrt(d)},m.tapDistance=function(t){return arguments.length?(p=+t,m):p},m}().scaleExtent([.001,1/0]).on("start",(t=>{var e,n;this.isRunning=!0;const i=!!t.sourceEvent;null==(n=null==(e=this.config)?void 0:e.onZoomStart)||n.call(e,t,i)})).on("zoom",(t=>{var e,n;this.eventTransform=t.transform;const{eventTransform:{x:i,y:r,k:o},store:{transform:s,screenSize:a}}=this,u=a[0],l=a[1];if(!u||!l)return;(function(t,e,n){t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1})(s,u,l),Cr(s,s,[i,r]),Pr(s,s,[o,o]),Cr(s,s,[u/2,l/2]),Pr(s,s,[u/2,l/2]),Pr(s,s,[1,-1]);const c=!!t.sourceEvent;null==(n=null==(e=this.config)?void 0:e.onZoom)||n.call(e,t,c)})).on("end",(t=>{var e,n;this.isRunning=!1;const i=!!t.sourceEvent;null==(n=null==(e=this.config)?void 0:e.onZoomEnd)||n.call(e,t,i)})),this.isRunning=!1,this.store=t,this.config=e}getTransform(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;if(0===t.length)return this.eventTransform;const{store:{screenSize:i}}=this,r=i[0],o=i[1],s=Ri(t.map((t=>t[0]))),a=Ri(t.map((t=>t[1])));s[0]=this.store.scaleX(s[0]),s[1]=this.store.scaleX(s[1]),a[0]=this.store.scaleY(a[0]),a[1]=this.store.scaleY(a[1]),s[0]===s[1]&&(s[0]-=.5,s[1]+=.5),a[0]===a[1]&&(a[0]+=.5,a[1]-=.5);const u=r*(1-2*n)/(s[1]-s[0]),l=o*(1-2*n)/(a[0]-a[1]),c=function(t,e,n){return Math.min(Math.max(t,e),n)}(e??Math.min(u,l),...this.behavior.scaleExtent()),h=r/2-(s[1]+s[0])/2*c,f=o/2-(a[1]+a[0])/2*c;return Do.translate(h,f).scale(c)}getDistanceToPoint(t){const{x:e,y:n,k:i}=this.eventTransform,r=this.getTransform([t],i),o=e-r.x,s=n-r.y;return Math.sqrt(o*o+s*s)}getMiddlePointTransform(t){const{store:{screenSize:e},eventTransform:{x:n,y:i,k:r}}=this,o=e[0],s=e[1],a=(s/2-i)/r,u=o/2-1*(((o/2-n)/r+this.store.scaleX(t[0]))/2),l=s/2-1*((a+this.store.scaleY(t[1]))/2);return Do.translate(u,l).scale(1)}convertScreenToSpacePosition(t){const{eventTransform:{x:e,y:n,k:i},store:{screenSize:r}}=this,o=r[0],s=r[1],a=[(t[0]-e)/i,s-(t[1]-n)/i];return a[0]-=(o-this.store.adjustedSpaceSize)/2,a[1]-=(s-this.store.adjustedSpaceSize)/2,a}convertSpaceToScreenPosition(t){return[this.eventTransform.applyX(this.store.scaleX(t[0])),this.eventTransform.applyY(this.store.scaleY(t[1]))]}convertSpaceToScreenRadius(t){const{config:{scalePointsOnZoom:e},store:{maxPointSize:n},eventTransform:{k:i}}=this;let r=2*t;return r*=e?i:Math.min(5,Math.max(1,.01*i)),Math.min(r,n)/2}}class Vo{constructor(t,e){this.isActive=!1,this.behavior=function(){var t,e,n,i,r=Ao,o=To,s=Io,a=Co,u={},l=bt("start","drag","end"),c=0,h=0;function f(t){t.on("mousedown.drag",d).filter(a).on("touchstart.drag",y).on("touchmove.drag",v,yo).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(s,a){if(!i&&r.call(this,s,a)){var u=g(this,o.call(this,s,a),s,a,"mouse");u&&(mt(s.view).on("mousemove.drag",p,vo).on("mouseup.drag",m,vo),xo(s.view),bo(s),n=!1,t=s.clientX,e=s.clientY,u("start",s))}}function p(i){if(go(i),!n){var r=i.clientX-t,o=i.clientY-e;n=r*r+o*o>h}u.mouse("drag",i)}function m(t){mt(t.view).on("mousemove.drag mouseup.drag",null),wo(t.view,n),go(t),u.mouse("end",t)}function y(t,e){if(r.call(this,t,e)){var n,i,s=t.changedTouches,a=o.call(this,t,e),u=s.length;for(n=0;n<u;++n)(i=g(this,a,t,e,s[n].identifier,s[n]))&&(bo(t),i("start",t,s[n]))}}function v(t){var e,n,i=t.changedTouches,r=i.length;for(e=0;e<r;++e)(n=u[i[e].identifier])&&(go(t),n("drag",t,i[e]))}function b(t){var e,n,r=t.changedTouches,o=r.length;for(i&&clearTimeout(i),i=setTimeout((function(){i=null}),500),e=0;e<o;++e)(n=u[r[e].identifier])&&(bo(t),n("end",t,r[e]))}function g(t,e,n,i,r,o){var a,h,d,p=l.copy(),m=yt(o||n,e);if(null!=(d=s.call(t,new So("beforestart",{sourceEvent:n,target:f,identifier:r,active:c,x:m[0],y:m[1],dx:0,dy:0,dispatch:p}),i)))return a=d.x-m[0]||0,h=d.y-m[1]||0,function n(o,s,l){var y,v=m;switch(o){case"start":u[r]=n,y=c++;break;case"end":delete u[r],--c;case"drag":m=yt(l||s,e),y=c}p.call(o,t,new So(o,{sourceEvent:s,subject:d,target:f,identifier:r,active:y,x:m[0]+a,y:m[1]+h,dx:m[0]-v[0],dy:m[1]-v[1],dispatch:p}),i)}}return f.filter=function(t){return arguments.length?(r="function"==typeof t?t:_o(!!t),f):r},f.container=function(t){return arguments.length?(o="function"==typeof t?t:_o(t),f):o},f.subject=function(t){return arguments.length?(s="function"==typeof t?t:_o(t),f):s},f.touchable=function(t){return arguments.length?(a="function"==typeof t?t:_o(!!t),f):a},f.on=function(){var t=l.on.apply(l,arguments);return t===l?f:t},f.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,f):Math.sqrt(h)},f}().subject((t=>this.store.hoveredPoint&&!this.store.isSpaceKeyPressed?{x:t.x,y:t.y}:void 0)).on("start",(t=>{var e,n;this.store.hoveredPoint&&(this.store.draggingPointIndex=this.store.hoveredPoint.index,this.isActive=!0,null==(n=null==(e=this.config)?void 0:e.onDragStart)||n.call(e,t))})).on("drag",(t=>{var e,n;null==(n=null==(e=this.config)?void 0:e.onDrag)||n.call(e,t)})).on("end",(t=>{var e,n;this.isActive=!1,this.store.draggingPointIndex=void 0,null==(n=null==(e=this.config)?void 0:e.onDragEnd)||n.call(e,t)})),this.store=t,this.config=e}}n(219);var Uo,$o,Wo,qo,Go,Ho,Yo,Xo,Zo,Ko=n(43);!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(Uo||(Uo={})),function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}($o||($o={})),function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(Wo||(Wo={})),function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(qo||(qo={})),function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(Go||(Go={})),function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(Ho||(Ho={})),function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(Yo||(Yo={})),function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"}(Xo||(Xo={})),function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"}(Zo||(Zo={}));const[Qo,Jo]=(()=>{const t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},"undefined"!==typeof BigInt?[BigInt,!0]:[e,!1]})(),[ts,es]=(()=>{const t=()=>{throw new Error("BigInt64Array is not available in this environment")};return"undefined"!==typeof BigInt64Array?[BigInt64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),[ns,is]=(()=>{const t=()=>{throw new Error("BigUint64Array is not available in this environment")};return"undefined"!==typeof BigUint64Array?[BigUint64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),rs=t=>"number"===typeof t,os=t=>"boolean"===typeof t,ss=t=>"function"===typeof t,as=t=>null!=t&&Object(t)===t,us=t=>as(t)&&ss(t.then),ls=t=>as(t)&&ss(t[Symbol.iterator]),cs=t=>as(t)&&ss(t[Symbol.asyncIterator]),hs=t=>as(t)&&as(t.schema),fs=t=>as(t)&&"done"in t&&"value"in t,ds=t=>as(t)&&ss(t.stat)&&rs(t.fd),ps=t=>as(t)&&ys(t.body),ms=t=>"_getDOMStream"in t&&"_getNodeStream"in t,ys=t=>as(t)&&ss(t.cancel)&&ss(t.getReader)&&!ms(t),vs=t=>as(t)&&ss(t.read)&&ss(t.pipe)&&os(t.readable)&&!ms(t);function bs(t){if(null===t)return"null";if(undefined===t)return"undefined";switch(typeof t){case"number":case"bigint":return`${t}`;case"string":return`"${t}"`}return"function"===typeof t[Symbol.toPrimitive]?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof ts||t instanceof ns?`[${[...t].map((t=>bs(t)))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,((t,e)=>"bigint"===typeof e?`${e}`:e))}function gs(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{u(i.next(t))}catch(e){o(e)}}function a(t){try{u(i.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((i=i.apply(t,e||[])).next())}))}Object.create;function xs(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ws(t){return this instanceof ws?(this.v=t,this):new ws(t)}function _s(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),o=[];return i=Object.create(("function"===typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",(function(t){return function(e){return Promise.resolve(e).then(t,l)}})),i[Symbol.asyncIterator]=function(){return this},i;function s(t,e){r[t]&&(i[t]=function(e){return new Promise((function(n,i){o.push([t,e,n,i])>1||a(t,e)}))},e&&(i[t]=e(i[t])))}function a(t,e){try{(n=r[t](e)).value instanceof ws?Promise.resolve(n.value.v).then(u,l):c(o[0][2],n)}catch(i){c(o[0][3],i)}var n}function u(t){a("next",t)}function l(t){a("throw",t)}function c(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Ss(t){var e,n;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,r){e[i]=t[i]?function(e){return(n=!n)?{value:ws(t[i](e)),done:!1}:r?r(e):e}:r}}function As(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=xs(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,r){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,r,(e=t[n](e)).done,e.value)}))}}}Object.create;"function"===typeof SuppressedError&&SuppressedError;const Ts=new TextDecoder("utf-8"),Is=t=>Ts.decode(t),Cs=new TextEncoder,Ps=t=>Cs.encode(t),ks="undefined"!==typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function zs(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.byteLength;const r=t.byteLength,o=new Uint8Array(t.buffer,t.byteOffset,r),s=new Uint8Array(e.buffer,e.byteOffset,Math.min(i,r));return o.set(s,n),t}function Ds(t,e){const n=function(t){const e=t[0]?[t[0]]:[];let n,i,r,o;for(let s,a,u=0,l=0,c=t.length;++u<c;)s=e[l],a=t[u],!s||!a||s.buffer!==a.buffer||a.byteOffset<s.byteOffset?a&&(e[++l]=a):(({byteOffset:n,byteLength:r}=s),({byteOffset:i,byteLength:o}=a),n+r<i||i+o<n?a&&(e[++l]=a):e[l]=new Uint8Array(s.buffer,n,i-n+o));return e}(t),i=n.reduce(((t,e)=>t+e.byteLength),0);let r,o,s,a=0,u=-1;const l=Math.min(e||Number.POSITIVE_INFINITY,i);for(const c=n.length;++u<c;){if(r=n[u],o=r.subarray(0,Math.min(r.length,l-a)),l<=a+o.length){o.length<r.length?n[u]=r.subarray(o.length):o.length===r.length&&u++,s?zs(s,o,a):s=o;break}zs(s||(s=new Uint8Array(l)),o,a),a+=o.length}return[s||new Uint8Array(0),n.slice(u),i-(s?s.byteLength:0)]}function Os(t,e){let n=fs(e)?e.value:e;return n instanceof t?t===Uint8Array?new t(n.buffer,n.byteOffset,n.byteLength):n:n?("string"===typeof n&&(n=Ps(n)),n instanceof ArrayBuffer||n instanceof ks?new t(n):as(i=n)&&ss(i.clear)&&ss(i.bytes)&&ss(i.position)&&ss(i.setPosition)&&ss(i.capacity)&&ss(i.getBufferIdentifier)&&ss(i.createLong)?Os(t,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new t(0):new t(n.buffer,n.byteOffset,n.byteLength/t.BYTES_PER_ELEMENT):t.from(n)):new t(0);var i}const Fs=t=>Os(Int32Array,t),Ms=t=>Os(Uint8Array,t),Bs=t=>(t.next(),t);function*Es(t,e){const n=function*(t){yield t},i="string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ks?n(e):ls(e)?e:n(e);return yield*Bs(function*(e){let n=null;do{n=e.next(yield Os(t,n))}while(!n.done)}(i[Symbol.iterator]())),new t}function Ls(t,e){return _s(this,arguments,(function*(){if(us(e))return yield ws(yield ws(yield*Ss(As(Ls(t,yield ws(e))))));const n=function(t){return _s(this,arguments,(function*(){yield yield ws(yield ws(t))}))},i="string"===typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof ks?n(e):ls(e)?function(t){return _s(this,arguments,(function*(){yield ws(yield*Ss(As(Bs(function*(t){let e=null;do{e=t.next(yield null===e||void 0===e?void 0:e.value)}while(!e.done)}(t[Symbol.iterator]())))))}))}(e):cs(e)?e:n(e);return yield ws(yield*Ss(As(Bs(function(e){return _s(this,arguments,(function*(){let n=null;do{n=yield ws(e.next(yield yield ws(Os(t,n))))}while(!n.done)}))}(i[Symbol.asyncIterator]()))))),yield ws(new t)}))}function Ns(t,e,n){if(0!==t){n=n.slice(0,e+1);for(let i=-1;++i<=e;)n[i]+=t}return n}const js=Symbol.for("isArrowBigNum");function Rs(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return 0===n.length?Object.setPrototypeOf(Os(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...n),this.constructor.prototype)}function Vs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Rs.apply(this,e)}function Us(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Rs.apply(this,e)}function $s(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Rs.apply(this,e)}function Ws(t){const{buffer:e,byteOffset:n,length:i,signed:r}=t,o=new ns(e,n,i),s=r&&o[o.length-1]&BigInt(1)<<BigInt(63);let a=s?BigInt(1):BigInt(0),u=BigInt(0);if(s){for(const t of o)a+=~t*(BigInt(1)<<BigInt(32)*u++);a*=BigInt(-1)}else for(const l of o)a+=l*(BigInt(1)<<BigInt(32)*u++);return a}let qs,Gs;function Hs(t){let e="";const n=new Uint32Array(2);let i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const r=new Uint32Array((i=new Uint16Array(i).reverse()).buffer);let o=-1;const s=i.length-1;do{for(n[0]=i[o=0];o<s;)i[o++]=n[1]=n[0]/10,n[0]=(n[0]-10*n[1]<<16)+i[o];i[o]=n[1]=n[0]/10,n[0]=n[0]-10*n[1],e=`${n[0]}${e}`}while(r[0]||r[1]||r[2]||r[3]);return null!==e&&void 0!==e?e:"0"}Rs.prototype[js]=!0,Rs.prototype.toJSON=function(){return`"${qs(this)}"`},Rs.prototype.valueOf=function(){return Ws(this)},Rs.prototype.toString=function(){return qs(this)},Rs.prototype[Symbol.toPrimitive]=function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default"){case"number":return Ws(this);case"string":return qs(this);case"default":return Gs(this)}return qs(this)},Object.setPrototypeOf(Vs.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(Us.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf($s.prototype,Object.create(Uint32Array.prototype)),Object.assign(Vs.prototype,Rs.prototype,{constructor:Vs,signed:!0,TypedArray:Int32Array,BigIntArray:ts}),Object.assign(Us.prototype,Rs.prototype,{constructor:Us,signed:!1,TypedArray:Uint32Array,BigIntArray:ns}),Object.assign($s.prototype,Rs.prototype,{constructor:$s,signed:!0,TypedArray:Uint32Array,BigIntArray:ns}),Jo?(Gs=t=>8===t.byteLength?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:Hs(t),qs=t=>8===t.byteLength?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:Hs(t)):(qs=Hs,Gs=qs);class Ys{static new(t,e){switch(e){case!0:return new Vs(t);case!1:return new Us(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case ts:return new Vs(t)}return 16===t.byteLength?new $s(t):new Us(t)}static signed(t){return new Vs(t)}static unsigned(t){return new Us(t)}static decimal(t){return new $s(t)}constructor(t,e){return Ys.new(t,e)}}var Xs,Zs,Ks,Qs,Js,ta,ea,na,ia,ra,oa,sa,aa,ua,la,ca,ha,fa,da,pa;class ma{static isNull(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Null}static isInt(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Int}static isFloat(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Float}static isBinary(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Binary}static isUtf8(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Utf8}static isBool(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Bool}static isDecimal(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Decimal}static isDate(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Date}static isTime(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Time}static isTimestamp(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Timestamp}static isInterval(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Interval}static isList(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.List}static isStruct(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Struct}static isUnion(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Union}static isFixedSizeBinary(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.FixedSizeBinary}static isFixedSizeList(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.FixedSizeList}static isMap(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Map}static isDictionary(t){return(null===t||void 0===t?void 0:t.typeId)===Xo.Dictionary}static isDenseUnion(t){return ma.isUnion(t)&&t.mode===$o.Dense}static isSparseUnion(t){return ma.isUnion(t)&&t.mode===$o.Sparse}get typeId(){return Xo.NONE}}Xs=Symbol.toStringTag,ma[Xs]=((pa=ma.prototype).children=null,pa.ArrayType=Array,pa[Symbol.toStringTag]="DataType");class ya extends ma{toString(){return"Null"}get typeId(){return Xo.Null}}Zs=Symbol.toStringTag,ya[Zs]=(t=>t[Symbol.toStringTag]="Null")(ya.prototype);class va extends ma{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return Xo.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?ts:ns}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Ks=Symbol.toStringTag,va[Ks]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(va.prototype);class ba extends va{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(class extends va{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(class extends va{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(ba.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(class extends va{constructor(){super(!0,64)}get ArrayType(){return ts}}.prototype,"ArrayType",{value:ts}),Object.defineProperty(class extends va{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(class extends va{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends va{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(class extends va{constructor(){super(!1,64)}get ArrayType(){return ns}}.prototype,"ArrayType",{value:ns});class ga extends ma{constructor(t){super(),this.precision=t}get typeId(){return Xo.Float}get ArrayType(){switch(this.precision){case Wo.HALF:return Uint16Array;case Wo.SINGLE:return Float32Array;case Wo.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}Qs=Symbol.toStringTag,ga[Qs]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(ga.prototype);Object.defineProperty(class extends ga{constructor(){super(Wo.HALF)}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends ga{constructor(){super(Wo.SINGLE)}}.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(class extends ga{constructor(){super(Wo.DOUBLE)}}.prototype,"ArrayType",{value:Float64Array});class xa extends ma{constructor(){super()}get typeId(){return Xo.Binary}toString(){return"Binary"}}Js=Symbol.toStringTag,xa[Js]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(xa.prototype);class wa extends ma{constructor(){super()}get typeId(){return Xo.Utf8}toString(){return"Utf8"}}ta=Symbol.toStringTag,wa[ta]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(wa.prototype);class _a extends ma{constructor(){super()}get typeId(){return Xo.Bool}toString(){return"Bool"}}ea=Symbol.toStringTag,_a[ea]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(_a.prototype);class Sa extends ma{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:128;super(),this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return Xo.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}na=Symbol.toStringTag,Sa[na]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Sa.prototype);class Aa extends ma{constructor(t){super(),this.unit=t}get typeId(){return Xo.Date}toString(){return`Date${32*(this.unit+1)}<${qo[this.unit]}>`}}ia=Symbol.toStringTag,Aa[ia]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Aa.prototype);class Ta extends ma{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return Xo.Time}toString(){return`Time${this.bitWidth}<${Go[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return ts}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}ra=Symbol.toStringTag,Ta[ra]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(Ta.prototype);class Ia extends ma{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return Xo.Timestamp}toString(){return`Timestamp<${Go[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}oa=Symbol.toStringTag,Ia[oa]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Ia.prototype);class Ca extends ma{constructor(t){super(),this.unit=t}get typeId(){return Xo.Interval}toString(){return`Interval<${Ho[this.unit]}>`}}sa=Symbol.toStringTag,Ca[sa]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Ca.prototype);class Pa extends ma{constructor(t){super(),this.children=[t]}get typeId(){return Xo.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}aa=Symbol.toStringTag,Pa[aa]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Pa.prototype);class ka extends ma{constructor(t){super(),this.children=t}get typeId(){return Xo.Struct}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}ua=Symbol.toStringTag,ka[ua]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(ka.prototype);class za extends ma{constructor(t,e,n){super(),this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce(((t,e,n)=>(t[e]=n)&&t||t),Object.create(null))}get typeId(){return Xo.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((t=>`${t.type}`)).join(" | ")}>`}}la=Symbol.toStringTag,za[la]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(za.prototype);class Da extends ma{constructor(t){super(),this.byteWidth=t}get typeId(){return Xo.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}ca=Symbol.toStringTag,Da[ca]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Da.prototype);class Oa extends ma{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return Xo.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}ha=Symbol.toStringTag,Oa[ha]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(Oa.prototype);class Fa extends ma{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.children=[t],this.keysSorted=e}get typeId(){return Xo.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}fa=Symbol.toStringTag,Fa[fa]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(Fa.prototype);const Ma=(Ba=-1,()=>++Ba);var Ba;class Ea extends ma{constructor(t,e,n,i){super(),this.indices=e,this.dictionary=t,this.isOrdered=i||!1,this.id=null==n?Ma():"number"===typeof n?n:n.low}get typeId(){return Xo.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function La(t){const e=t;switch(t.typeId){case Xo.Decimal:return t.bitWidth/32;case Xo.Timestamp:return 2;case Xo.Date:case Xo.Interval:return 1+e.unit;case Xo.FixedSizeList:return e.listSize;case Xo.FixedSizeBinary:return e.byteWidth;default:return 1}}da=Symbol.toStringTag,Ea[da]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(Ea.prototype);class Na{visitMany(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return t.map(((t,e)=>this.visit(t,...n.map((t=>t[e])))))}visit(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.getVisitFn(e[0],!1).apply(this,e)}getVisitFn(t){return function(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("number"===typeof e)return ja(t,e,n);if("string"===typeof e&&e in Xo)return ja(t,Xo[e],n);if(e&&e instanceof ma)return ja(t,Ra(e),n);if((null===e||void 0===e?void 0:e.type)&&e.type instanceof ma)return ja(t,Ra(e.type),n);return ja(t,Xo.NONE,n)}(this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}getVisitFnByTypeId(t){return ja(this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}visitNull(t){return null}visitBool(t){return null}visitInt(t){return null}visitFloat(t){return null}visitUtf8(t){return null}visitBinary(t){return null}visitFixedSizeBinary(t){return null}visitDate(t){return null}visitTimestamp(t){return null}visitTime(t){return null}visitDecimal(t){return null}visitList(t){return null}visitStruct(t){return null}visitUnion(t){return null}visitDictionary(t){return null}visitInterval(t){return null}visitFixedSizeList(t){return null}visitMap(t){return null}}function ja(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=null;switch(e){case Xo.Null:i=t.visitNull;break;case Xo.Bool:i=t.visitBool;break;case Xo.Int:i=t.visitInt;break;case Xo.Int8:i=t.visitInt8||t.visitInt;break;case Xo.Int16:i=t.visitInt16||t.visitInt;break;case Xo.Int32:i=t.visitInt32||t.visitInt;break;case Xo.Int64:i=t.visitInt64||t.visitInt;break;case Xo.Uint8:i=t.visitUint8||t.visitInt;break;case Xo.Uint16:i=t.visitUint16||t.visitInt;break;case Xo.Uint32:i=t.visitUint32||t.visitInt;break;case Xo.Uint64:i=t.visitUint64||t.visitInt;break;case Xo.Float:i=t.visitFloat;break;case Xo.Float16:i=t.visitFloat16||t.visitFloat;break;case Xo.Float32:i=t.visitFloat32||t.visitFloat;break;case Xo.Float64:i=t.visitFloat64||t.visitFloat;break;case Xo.Utf8:i=t.visitUtf8;break;case Xo.Binary:i=t.visitBinary;break;case Xo.FixedSizeBinary:i=t.visitFixedSizeBinary;break;case Xo.Date:i=t.visitDate;break;case Xo.DateDay:i=t.visitDateDay||t.visitDate;break;case Xo.DateMillisecond:i=t.visitDateMillisecond||t.visitDate;break;case Xo.Timestamp:i=t.visitTimestamp;break;case Xo.TimestampSecond:i=t.visitTimestampSecond||t.visitTimestamp;break;case Xo.TimestampMillisecond:i=t.visitTimestampMillisecond||t.visitTimestamp;break;case Xo.TimestampMicrosecond:i=t.visitTimestampMicrosecond||t.visitTimestamp;break;case Xo.TimestampNanosecond:i=t.visitTimestampNanosecond||t.visitTimestamp;break;case Xo.Time:i=t.visitTime;break;case Xo.TimeSecond:i=t.visitTimeSecond||t.visitTime;break;case Xo.TimeMillisecond:i=t.visitTimeMillisecond||t.visitTime;break;case Xo.TimeMicrosecond:i=t.visitTimeMicrosecond||t.visitTime;break;case Xo.TimeNanosecond:i=t.visitTimeNanosecond||t.visitTime;break;case Xo.Decimal:i=t.visitDecimal;break;case Xo.List:i=t.visitList;break;case Xo.Struct:i=t.visitStruct;break;case Xo.Union:i=t.visitUnion;break;case Xo.DenseUnion:i=t.visitDenseUnion||t.visitUnion;break;case Xo.SparseUnion:i=t.visitSparseUnion||t.visitUnion;break;case Xo.Dictionary:i=t.visitDictionary;break;case Xo.Interval:i=t.visitInterval;break;case Xo.IntervalDayTime:i=t.visitIntervalDayTime||t.visitInterval;break;case Xo.IntervalYearMonth:i=t.visitIntervalYearMonth||t.visitInterval;break;case Xo.FixedSizeList:i=t.visitFixedSizeList;break;case Xo.Map:i=t.visitMap}if("function"===typeof i)return i;if(!n)return()=>null;throw new Error(`Unrecognized type '${Xo[e]}'`)}function Ra(t){switch(t.typeId){case Xo.Null:return Xo.Null;case Xo.Int:{const{bitWidth:e,isSigned:n}=t;switch(e){case 8:return n?Xo.Int8:Xo.Uint8;case 16:return n?Xo.Int16:Xo.Uint16;case 32:return n?Xo.Int32:Xo.Uint32;case 64:return n?Xo.Int64:Xo.Uint64}return Xo.Int}case Xo.Float:switch(t.precision){case Wo.HALF:return Xo.Float16;case Wo.SINGLE:return Xo.Float32;case Wo.DOUBLE:return Xo.Float64}return Xo.Float;case Xo.Binary:return Xo.Binary;case Xo.Utf8:return Xo.Utf8;case Xo.Bool:return Xo.Bool;case Xo.Decimal:return Xo.Decimal;case Xo.Time:switch(t.unit){case Go.SECOND:return Xo.TimeSecond;case Go.MILLISECOND:return Xo.TimeMillisecond;case Go.MICROSECOND:return Xo.TimeMicrosecond;case Go.NANOSECOND:return Xo.TimeNanosecond}return Xo.Time;case Xo.Timestamp:switch(t.unit){case Go.SECOND:return Xo.TimestampSecond;case Go.MILLISECOND:return Xo.TimestampMillisecond;case Go.MICROSECOND:return Xo.TimestampMicrosecond;case Go.NANOSECOND:return Xo.TimestampNanosecond}return Xo.Timestamp;case Xo.Date:switch(t.unit){case qo.DAY:return Xo.DateDay;case qo.MILLISECOND:return Xo.DateMillisecond}return Xo.Date;case Xo.Interval:switch(t.unit){case Ho.DAY_TIME:return Xo.IntervalDayTime;case Ho.YEAR_MONTH:return Xo.IntervalYearMonth}return Xo.Interval;case Xo.Map:return Xo.Map;case Xo.List:return Xo.List;case Xo.Struct:return Xo.Struct;case Xo.Union:switch(t.mode){case $o.Dense:return Xo.DenseUnion;case $o.Sparse:return Xo.SparseUnion}return Xo.Union;case Xo.FixedSizeBinary:return Xo.FixedSizeBinary;case Xo.FixedSizeList:return Xo.FixedSizeList;case Xo.Dictionary:return Xo.Dictionary}throw new Error(`Unrecognized type '${Xo[t.typeId]}'`)}Na.prototype.visitInt8=null,Na.prototype.visitInt16=null,Na.prototype.visitInt32=null,Na.prototype.visitInt64=null,Na.prototype.visitUint8=null,Na.prototype.visitUint16=null,Na.prototype.visitUint32=null,Na.prototype.visitUint64=null,Na.prototype.visitFloat16=null,Na.prototype.visitFloat32=null,Na.prototype.visitFloat64=null,Na.prototype.visitDateDay=null,Na.prototype.visitDateMillisecond=null,Na.prototype.visitTimestampSecond=null,Na.prototype.visitTimestampMillisecond=null,Na.prototype.visitTimestampMicrosecond=null,Na.prototype.visitTimestampNanosecond=null,Na.prototype.visitTimeSecond=null,Na.prototype.visitTimeMillisecond=null,Na.prototype.visitTimeMicrosecond=null,Na.prototype.visitTimeNanosecond=null,Na.prototype.visitDenseUnion=null,Na.prototype.visitSparseUnion=null,Na.prototype.visitIntervalDayTime=null,Na.prototype.visitIntervalYearMonth=null;const Va=new Float64Array(1),Ua=new Uint32Array(Va.buffer);function $a(t){const e=(31744&t)>>10,n=(1023&t)/1024,i=Math.pow(-1,(32768&t)>>15);switch(e){case 31:return i*(n?Number.NaN:1/0);case 0:return i*(n?6103515625e-14*n:0)}return i*Math.pow(2,e-15)*(1+n)}class Wa extends Na{}function qa(t){return(e,n,i)=>{if(e.setValid(n,null!=i))return t(e,n,i)}}const Ga=(t,e,n)=>{t[e]=Math.trunc(n%4294967296),t[e+1]=Math.trunc(n/4294967296)},Ha=(t,e,n,i)=>{if(n+1<e.length){const{[n]:r,[n+1]:o}=e;t.set(i.subarray(0,o-r),r)}},Ya=(t,e,n)=>{let{values:i}=t;i[e]=n},Xa=(t,e,n)=>{let{values:i}=t;i[e]=n},Za=(t,e,n)=>{let{values:i}=t;i[e]=function(t){if(t!==t)return 32256;Va[0]=t;const e=(2147483648&Ua[1])>>16&65535;let n=2146435072&Ua[1],i=0;return n>=1089470464?Ua[0]>0?n=31744:(n=(2080374784&n)>>16,i=(1048575&Ua[1])>>10):n<=1056964608?(i=1048576+(1048575&Ua[1]),i=1048576+(i<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,i=512+(1048575&Ua[1])>>10),e|n|65535&i}(n)},Ka=(t,e,n)=>{let{values:i}=t;((t,e,n)=>{t[e]=Math.trunc(n/864e5)})(i,e,n.valueOf())},Qa=(t,e,n)=>{let{values:i}=t;Ga(i,2*e,n.valueOf())},Ja=(t,e,n)=>{let{values:i}=t;return Ga(i,2*e,n/1e3)},tu=(t,e,n)=>{let{values:i}=t;return Ga(i,2*e,n)},eu=(t,e,n)=>{let{values:i}=t;return((t,e,n)=>{t[e]=Math.trunc(1e3*n%4294967296),t[e+1]=Math.trunc(1e3*n/4294967296)})(i,2*e,n)},nu=(t,e,n)=>{let{values:i}=t;return((t,e,n)=>{t[e]=Math.trunc(1e6*n%4294967296),t[e+1]=Math.trunc(1e6*n/4294967296)})(i,2*e,n)},iu=(t,e,n)=>{let{values:i}=t;i[e]=n},ru=(t,e,n)=>{let{values:i}=t;i[e]=n},ou=(t,e,n)=>{let{values:i}=t;i[e]=n},su=(t,e,n)=>{let{values:i}=t;i[e]=n},au=(t,e,n)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[i];hu.visit(r,t.valueOffsets[e],n)},uu=(t,e,n)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[i];hu.visit(r,e,n)},lu=(t,e,n)=>{let{values:i}=t;i.set(n.subarray(0,2),2*e)},cu=(t,e,n)=>{let{values:i}=t;i[e]=12*n[0]+n[1]%12};Wa.prototype.visitBool=qa(((t,e,n)=>{let{offset:i,values:r}=t;const o=i+e;n?r[o>>3]|=1<<o%8:r[o>>3]&=~(1<<o%8)})),Wa.prototype.visitInt=qa(Ya),Wa.prototype.visitInt8=qa(Ya),Wa.prototype.visitInt16=qa(Ya),Wa.prototype.visitInt32=qa(Ya),Wa.prototype.visitInt64=qa(Ya),Wa.prototype.visitUint8=qa(Ya),Wa.prototype.visitUint16=qa(Ya),Wa.prototype.visitUint32=qa(Ya),Wa.prototype.visitUint64=qa(Ya),Wa.prototype.visitFloat=qa(((t,e,n)=>{switch(t.type.precision){case Wo.HALF:return Za(t,e,n);case Wo.SINGLE:case Wo.DOUBLE:return Xa(t,e,n)}})),Wa.prototype.visitFloat16=qa(Za),Wa.prototype.visitFloat32=qa(Xa),Wa.prototype.visitFloat64=qa(Xa),Wa.prototype.visitUtf8=qa(((t,e,n)=>{let{values:i,valueOffsets:r}=t;Ha(i,r,e,Ps(n))})),Wa.prototype.visitBinary=qa(((t,e,n)=>{let{values:i,valueOffsets:r}=t;return Ha(i,r,e,n)})),Wa.prototype.visitFixedSizeBinary=qa(((t,e,n)=>{let{stride:i,values:r}=t;r.set(n.subarray(0,i),i*e)})),Wa.prototype.visitDate=qa(((t,e,n)=>{t.type.unit===qo.DAY?Ka(t,e,n):Qa(t,e,n)})),Wa.prototype.visitDateDay=qa(Ka),Wa.prototype.visitDateMillisecond=qa(Qa),Wa.prototype.visitTimestamp=qa(((t,e,n)=>{switch(t.type.unit){case Go.SECOND:return Ja(t,e,n);case Go.MILLISECOND:return tu(t,e,n);case Go.MICROSECOND:return eu(t,e,n);case Go.NANOSECOND:return nu(t,e,n)}})),Wa.prototype.visitTimestampSecond=qa(Ja),Wa.prototype.visitTimestampMillisecond=qa(tu),Wa.prototype.visitTimestampMicrosecond=qa(eu),Wa.prototype.visitTimestampNanosecond=qa(nu),Wa.prototype.visitTime=qa(((t,e,n)=>{switch(t.type.unit){case Go.SECOND:return iu(t,e,n);case Go.MILLISECOND:return ru(t,e,n);case Go.MICROSECOND:return ou(t,e,n);case Go.NANOSECOND:return su(t,e,n)}})),Wa.prototype.visitTimeSecond=qa(iu),Wa.prototype.visitTimeMillisecond=qa(ru),Wa.prototype.visitTimeMicrosecond=qa(ou),Wa.prototype.visitTimeNanosecond=qa(su),Wa.prototype.visitDecimal=qa(((t,e,n)=>{let{values:i,stride:r}=t;i.set(n.subarray(0,r),r*e)})),Wa.prototype.visitList=qa(((t,e,n)=>{const i=t.children[0],r=t.valueOffsets,o=hu.getVisitFn(i);if(Array.isArray(n))for(let s=-1,a=r[e],u=r[e+1];a<u;)o(i,a++,n[++s]);else for(let s=-1,a=r[e],u=r[e+1];a<u;)o(i,a++,n.get(++s))})),Wa.prototype.visitStruct=qa(((t,e,n)=>{const i=t.type.children.map((t=>hu.getVisitFn(t.type))),r=n instanceof Map?(o=e,s=n,(t,e,n,i)=>e&&t(e,o,s.get(n.name))):n instanceof Pl?((t,e)=>(n,i,r,o)=>i&&n(i,t,e.get(o)))(e,n):Array.isArray(n)?((t,e)=>(n,i,r,o)=>i&&n(i,t,e[o]))(e,n):((t,e)=>(n,i,r,o)=>i&&n(i,t,e[r.name]))(e,n);var o,s;t.type.children.forEach(((e,n)=>r(i[n],t.children[n],e,n)))})),Wa.prototype.visitUnion=qa(((t,e,n)=>{t.type.mode===$o.Dense?au(t,e,n):uu(t,e,n)})),Wa.prototype.visitDenseUnion=qa(au),Wa.prototype.visitSparseUnion=qa(uu),Wa.prototype.visitDictionary=qa(((t,e,n)=>{var i;null===(i=t.dictionary)||void 0===i||i.set(t.values[e],n)})),Wa.prototype.visitInterval=qa(((t,e,n)=>{t.type.unit===Ho.DAY_TIME?lu(t,e,n):cu(t,e,n)})),Wa.prototype.visitIntervalDayTime=qa(lu),Wa.prototype.visitIntervalYearMonth=qa(cu),Wa.prototype.visitFixedSizeList=qa(((t,e,n)=>{const{stride:i}=t,r=t.children[0],o=hu.getVisitFn(r);if(Array.isArray(n))for(let s=-1,a=e*i;++s<i;)o(r,a+s,n[s]);else for(let s=-1,a=e*i;++s<i;)o(r,a+s,n.get(s))})),Wa.prototype.visitMap=qa(((t,e,n)=>{const i=t.children[0],{valueOffsets:r}=t,o=hu.getVisitFn(i);let{[e]:s,[e+1]:a}=r;const u=n instanceof Map?n.entries():Object.entries(n);for(const l of u)if(o(i,s,l),++s>=a)break}));const hu=new Wa,fu=Symbol.for("parent"),du=Symbol.for("rowIndex");class pu{constructor(t,e){return this[fu]=t,this[du]=e,new Proxy(this,new yu)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[du],e=this[fu],n=e.type.children,i={};for(let r=-1,o=n.length;++r<o;)i[n[r].name]=Nu.visit(e.children[r],t);return i}toString(){return`{${[...this].map((t=>{let[e,n]=t;return`${bs(e)}: ${bs(n)}`})).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new mu(this[fu],this[du])}}class mu{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Nu.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(pu.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[fu]:{writable:!0,enumerable:!1,configurable:!1,value:null},[du]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class yu{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[fu].type.children.map((t=>t.name))}has(t,e){return-1!==t[fu].type.children.findIndex((t=>t.name===e))}getOwnPropertyDescriptor(t,e){if(-1!==t[fu].type.children.findIndex((t=>t.name===e)))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[fu].type.children.findIndex((t=>t.name===e));if(-1!==n){const i=Nu.visit(t[fu].children[n],t[du]);return Reflect.set(t,e,i),i}}set(t,e,n){const i=t[fu].type.children.findIndex((t=>t.name===e));return-1!==i?(hu.visit(t[fu].children[i],t[du],n),Reflect.set(t,e,n)):!(!Reflect.has(t,e)&&"symbol"!==typeof e)&&Reflect.set(t,e,n)}}class vu extends Na{}function bu(t){return(e,n)=>e.getValid(n)?t(e,n):null}const gu=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),xu=t=>new Date(t),wu=(t,e,n)=>{if(n+1>=e.length)return null;const i=e[n],r=e[n+1];return t.subarray(i,r)},_u=(t,e)=>{let{values:n}=t;return((t,e)=>xu(((t,e)=>864e5*t[e])(t,e)))(n,e)},Su=(t,e)=>{let{values:n}=t;return((t,e)=>xu(gu(t,e)))(n,2*e)},Au=(t,e)=>{let{stride:n,values:i}=t;return i[n*e]},Tu=(t,e)=>{let{values:n}=t;return n[e]},Iu=(t,e)=>{let{values:n}=t;return 1e3*gu(n,2*e)},Cu=(t,e)=>{let{values:n}=t;return gu(n,2*e)},Pu=(t,e)=>{let{values:n}=t;return((t,e)=>t[e+1]/1e3*4294967296+(t[e]>>>0)/1e3)(n,2*e)},ku=(t,e)=>{let{values:n}=t;return((t,e)=>t[e+1]/1e6*4294967296+(t[e]>>>0)/1e6)(n,2*e)},zu=(t,e)=>{let{values:n}=t;return n[e]},Du=(t,e)=>{let{values:n}=t;return n[e]},Ou=(t,e)=>{let{values:n}=t;return n[e]},Fu=(t,e)=>{let{values:n}=t;return n[e]},Mu=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[n];return Nu.visit(i,t.valueOffsets[e])},Bu=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[n];return Nu.visit(i,e)},Eu=(t,e)=>{let{values:n}=t;return n.subarray(2*e,2*(e+1))},Lu=(t,e)=>{let{values:n}=t;const i=n[e],r=new Int32Array(2);return r[0]=Math.trunc(i/12),r[1]=Math.trunc(i%12),r};vu.prototype.visitNull=bu(((t,e)=>null)),vu.prototype.visitBool=bu(((t,e)=>{let{offset:n,values:i}=t;const r=n+e;return 0!==(i[r>>3]&1<<r%8)})),vu.prototype.visitInt=bu(((t,e)=>{let{values:n}=t;return n[e]})),vu.prototype.visitInt8=bu(Au),vu.prototype.visitInt16=bu(Au),vu.prototype.visitInt32=bu(Au),vu.prototype.visitInt64=bu(Tu),vu.prototype.visitUint8=bu(Au),vu.prototype.visitUint16=bu(Au),vu.prototype.visitUint32=bu(Au),vu.prototype.visitUint64=bu(Tu),vu.prototype.visitFloat=bu(((t,e)=>{let{type:n,values:i}=t;return n.precision!==Wo.HALF?i[e]:$a(i[e])})),vu.prototype.visitFloat16=bu(((t,e)=>{let{stride:n,values:i}=t;return $a(i[n*e])})),vu.prototype.visitFloat32=bu(Au),vu.prototype.visitFloat64=bu(Au),vu.prototype.visitUtf8=bu(((t,e)=>{let{values:n,valueOffsets:i}=t;const r=wu(n,i,e);return null!==r?Is(r):null})),vu.prototype.visitBinary=bu(((t,e)=>{let{values:n,valueOffsets:i}=t;return wu(n,i,e)})),vu.prototype.visitFixedSizeBinary=bu(((t,e)=>{let{stride:n,values:i}=t;return i.subarray(n*e,n*(e+1))})),vu.prototype.visitDate=bu(((t,e)=>t.type.unit===qo.DAY?_u(t,e):Su(t,e))),vu.prototype.visitDateDay=bu(_u),vu.prototype.visitDateMillisecond=bu(Su),vu.prototype.visitTimestamp=bu(((t,e)=>{switch(t.type.unit){case Go.SECOND:return Iu(t,e);case Go.MILLISECOND:return Cu(t,e);case Go.MICROSECOND:return Pu(t,e);case Go.NANOSECOND:return ku(t,e)}})),vu.prototype.visitTimestampSecond=bu(Iu),vu.prototype.visitTimestampMillisecond=bu(Cu),vu.prototype.visitTimestampMicrosecond=bu(Pu),vu.prototype.visitTimestampNanosecond=bu(ku),vu.prototype.visitTime=bu(((t,e)=>{switch(t.type.unit){case Go.SECOND:return zu(t,e);case Go.MILLISECOND:return Du(t,e);case Go.MICROSECOND:return Ou(t,e);case Go.NANOSECOND:return Fu(t,e)}})),vu.prototype.visitTimeSecond=bu(zu),vu.prototype.visitTimeMillisecond=bu(Du),vu.prototype.visitTimeMicrosecond=bu(Ou),vu.prototype.visitTimeNanosecond=bu(Fu),vu.prototype.visitDecimal=bu(((t,e)=>{let{values:n,stride:i}=t;return Ys.decimal(n.subarray(i*e,i*(e+1)))})),vu.prototype.visitList=bu(((t,e)=>{const{valueOffsets:n,stride:i,children:r}=t,{[e*i]:o,[e*i+1]:s}=n,a=r[0].slice(o,s-o);return new Pl([a])})),vu.prototype.visitStruct=bu(((t,e)=>new pu(t,e))),vu.prototype.visitUnion=bu(((t,e)=>t.type.mode===$o.Dense?Mu(t,e):Bu(t,e))),vu.prototype.visitDenseUnion=bu(Mu),vu.prototype.visitSparseUnion=bu(Bu),vu.prototype.visitDictionary=bu(((t,e)=>{var n;return null===(n=t.dictionary)||void 0===n?void 0:n.get(t.values[e])})),vu.prototype.visitInterval=bu(((t,e)=>t.type.unit===Ho.DAY_TIME?Eu(t,e):Lu(t,e))),vu.prototype.visitIntervalDayTime=bu(Eu),vu.prototype.visitIntervalYearMonth=bu(Lu),vu.prototype.visitFixedSizeList=bu(((t,e)=>{const{stride:n,children:i}=t,r=i[0].slice(e*n,n);return new Pl([r])})),vu.prototype.visitMap=bu(((t,e)=>{const{valueOffsets:n,children:i}=t,{[e]:r,[e+1]:o}=n,s=i[0];return new Vu(s.slice(r,o-r))}));const Nu=new vu,ju=Symbol.for("keys"),Ru=Symbol.for("vals");class Vu{constructor(t){return this[ju]=new Pl([t.children[0]]).memoize(),this[Ru]=t.children[1],new Proxy(this,new $u)}[Symbol.iterator](){return new Uu(this[ju],this[Ru])}get size(){return this[ju].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[ju],e=this[Ru],n={};for(let i=-1,r=t.length;++i<r;)n[t.get(i)]=Nu.visit(e,i);return n}toString(){return`{${[...this].map((t=>{let[e,n]=t;return`${bs(e)}: ${bs(n)}`})).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class Uu{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Nu.visit(this.vals,t)]})}}class $u{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[ju].toArray().map(String)}has(t,e){return t[ju].includes(e)}getOwnPropertyDescriptor(t,e){if(-1!==t[ju].indexOf(e))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[ju].indexOf(e);if(-1!==n){const i=Nu.visit(Reflect.get(t,Ru),n);return Reflect.set(t,e,i),i}}set(t,e,n){const i=t[ju].indexOf(e);return-1!==i?(hu.visit(Reflect.get(t,Ru),i,n),Reflect.set(t,e,n)):!!Reflect.has(t,e)&&Reflect.set(t,e,n)}}let Wu;function qu(t,e,n,i){const{length:r=0}=t;let o="number"!==typeof e?0:e,s="number"!==typeof n?r:n;return o<0&&(o=(o%r+r)%r),s<0&&(s=(s%r+r)%r),s<o&&(Wu=o,o=s,s=Wu),s>r&&(s=r),i?i(t,o,s):[o,s]}Object.defineProperties(Vu.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[ju]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Ru]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const Gu=t=>t!==t;function Hu(t){if("object"!==typeof t||null===t)return Gu(t)?Gu:e=>e===t;if(t instanceof Date){const e=t.valueOf();return t=>t instanceof Date&&t.valueOf()===e}return ArrayBuffer.isView(t)?e=>!!e&&function(t,e){let n=0;const i=t.length;if(i!==e.length)return!1;if(i>0)do{if(t[n]!==e[n])return!1}while(++n<i);return!0}(t,e):t instanceof Map?function(t){let e=-1;const n=[];for(const i of t.values())n[++e]=Hu(i);return Yu(n)}(t):Array.isArray(t)?function(t){const e=[];for(let n=-1,i=t.length;++n<i;)e[n]=Hu(t[n]);return Yu(e)}(t):t instanceof Pl?function(t){const e=[];for(let n=-1,i=t.length;++n<i;)e[n]=Hu(t.get(n));return Yu(e)}(t):function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Object.keys(t);if(!e&&0===n.length)return()=>!1;const i=[];for(let r=-1,o=n.length;++r<o;)i[r]=Hu(t[n[r]]);return Yu(i,n)}(t,!0)}function Yu(t,e){return n=>{if(!n||"object"!==typeof n)return!1;switch(n.constructor){case Array:return function(t,e){const n=t.length;if(e.length!==n)return!1;for(let i=-1;++i<n;)if(!t[i](e[i]))return!1;return!0}(t,n);case Map:return Xu(t,n,n.keys());case Vu:case pu:case Object:case void 0:return Xu(t,n,e||Object.keys(n))}return n instanceof Pl&&function(t,e){const n=t.length;if(e.length!==n)return!1;for(let i=-1;++i<n;)if(!t[i](e.get(i)))return!1;return!0}(t,n)}}function Xu(t,e,n){const i=n[Symbol.iterator](),r=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),o=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let s=0;const a=t.length;let u=o.next(),l=i.next(),c=r.next();for(;s<a&&!l.done&&!c.done&&!u.done&&(l.value===c.value&&t[s](u.value));++s,l=i.next(),c=r.next(),u=o.next());return!!(s===a&&l.done&&c.done&&u.done)||(i.return&&i.return(),r.return&&r.return(),o.return&&o.return(),!1)}class Zu{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function Ku(t){return t.reduce(((t,e)=>t+e.nullCount),0)}function Qu(t){return t.reduce(((t,e,n)=>(t[n+1]=t[n]+e.length,t)),new Uint32Array(t.length+1))}function Ju(t,e,n,i){const r=[];for(let o=-1,s=t.length;++o<s;){const s=t[o],a=e[o],{length:u}=s;if(a>=i)break;if(n>=a+u)continue;if(a>=n&&a+u<=i){r.push(s);continue}const l=Math.max(0,n-a),c=Math.min(i-a,u);r.push(s.slice(l,c-l))}return 0===r.length&&r.push(t[0].slice(0,0)),r}function tl(t,e,n,i){let r=0,o=0,s=e.length-1;do{if(r>=s-1)return n<e[s]?i(t,r,n-e[r]):null;o=r+Math.trunc(.5*(s-r)),n<e[o]?s=o:r=o}while(r<s)}function el(t,e){return t.getValid(e)}function nl(t){function e(e,n,i){return t(e[n],i)}return function(t){return tl(this.data,this._offsets,t,e)}}function il(t){let e;function n(n,i,r){return t(n[i],r,e)}return function(t,i){const r=this.data;e=i;const o=tl(r,this._offsets,t,n);return e=void 0,o}}function rl(t){let e;function n(n,i,r){let o=r,s=0,a=0;for(let u=i-1,l=n.length;++u<l;){const i=n[u];if(~(s=t(i,e,o)))return a+s;o=0,a+=i.length}return-1}return function(t,i){e=t;const r=this.data,o="number"!==typeof i?n(r,0,0):tl(r,this._offsets,i,n);return e=void 0,o}}function ol(t,e,n,i){return 0!==(n&1<<i)}function sl(t,e,n,i){return(n&1<<i)>>i}function al(t,e,n){const i=n.byteLength+7&-8;if(t>0||n.byteLength<i){const r=new Uint8Array(i);return r.set(t%8===0?n.subarray(t>>3):ul(new ll(n,t,e,null,ol)).subarray(0,i)),r}return n}function ul(t){const e=[];let n=0,i=0,r=0;for(const s of t)s&&(r|=1<<i),8===++i&&(e[n++]=r,r=i=0);(0===n||i>0)&&(e[n++]=r);const o=new Uint8Array(e.length+7&-8);return o.set(e),o}class ll{constructor(t,e,n,i,r){this.bytes=t,this.length=n,this.context=i,this.get=r,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function cl(t,e,n){if(n-e<=0)return 0;if(n-e<8){let i=0;for(const r of new ll(t,e,n-e,t,sl))i+=r;return i}const i=n>>3<<3,r=e+(e%8===0?0:8-e%8);return cl(t,e,r)+cl(t,i,n)+function(t,e,n){let i=0,r=Math.trunc(e);const o=new DataView(t.buffer,t.byteOffset,t.byteLength),s=void 0===n?t.byteLength:r+n;for(;s-r>=4;)i+=hl(o.getUint32(r)),r+=4;for(;s-r>=2;)i+=hl(o.getUint16(r)),r+=2;for(;s-r>=1;)i+=hl(o.getUint8(r)),r+=1;return i}(t,r>>3,i-r>>3)}function hl(t){let e=Math.trunc(t);return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24}class fl extends Na{}function dl(t,e,n){if(void 0===e)return-1;if(null===e)return function(t,e){const{nullBitmap:n}=t;if(!n||t.nullCount<=0)return-1;let i=0;for(const r of new ll(n,t.offset+(e||0),t.length,n,ol)){if(!r)return i;++i}return-1}(t,n);const i=Nu.getVisitFn(t),r=Hu(e);for(let o=(n||0)-1,s=t.length;++o<s;)if(r(i(t,o)))return o;return-1}function pl(t,e,n){const i=Nu.getVisitFn(t),r=Hu(e);for(let o=(n||0)-1,s=t.length;++o<s;)if(r(i(t,o)))return o;return-1}fl.prototype.visitNull=function(t,e){return null===e&&t.length>0?0:-1},fl.prototype.visitBool=dl,fl.prototype.visitInt=dl,fl.prototype.visitInt8=dl,fl.prototype.visitInt16=dl,fl.prototype.visitInt32=dl,fl.prototype.visitInt64=dl,fl.prototype.visitUint8=dl,fl.prototype.visitUint16=dl,fl.prototype.visitUint32=dl,fl.prototype.visitUint64=dl,fl.prototype.visitFloat=dl,fl.prototype.visitFloat16=dl,fl.prototype.visitFloat32=dl,fl.prototype.visitFloat64=dl,fl.prototype.visitUtf8=dl,fl.prototype.visitBinary=dl,fl.prototype.visitFixedSizeBinary=dl,fl.prototype.visitDate=dl,fl.prototype.visitDateDay=dl,fl.prototype.visitDateMillisecond=dl,fl.prototype.visitTimestamp=dl,fl.prototype.visitTimestampSecond=dl,fl.prototype.visitTimestampMillisecond=dl,fl.prototype.visitTimestampMicrosecond=dl,fl.prototype.visitTimestampNanosecond=dl,fl.prototype.visitTime=dl,fl.prototype.visitTimeSecond=dl,fl.prototype.visitTimeMillisecond=dl,fl.prototype.visitTimeMicrosecond=dl,fl.prototype.visitTimeNanosecond=dl,fl.prototype.visitDecimal=dl,fl.prototype.visitList=dl,fl.prototype.visitStruct=dl,fl.prototype.visitUnion=dl,fl.prototype.visitDenseUnion=pl,fl.prototype.visitSparseUnion=pl,fl.prototype.visitDictionary=dl,fl.prototype.visitInterval=dl,fl.prototype.visitIntervalDayTime=dl,fl.prototype.visitIntervalYearMonth=dl,fl.prototype.visitFixedSizeList=dl,fl.prototype.visitMap=dl;const ml=new fl;class yl extends Na{}function vl(t){const{type:e}=t;if(0===t.nullCount&&1===t.stride&&(e.typeId===Xo.Timestamp||e instanceof va&&64!==e.bitWidth||e instanceof Ta&&64!==e.bitWidth||e instanceof ga&&e.precision!==Wo.HALF))return new Zu(t.data.length,(e=>{const n=t.data[e];return n.values.subarray(0,n.length)[Symbol.iterator]()}));let n=0;return new Zu(t.data.length,(e=>{const i=t.data[e].length,r=t.slice(n,n+i);return n+=i,new bl(r)}))}class bl{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}yl.prototype.visitNull=vl,yl.prototype.visitBool=vl,yl.prototype.visitInt=vl,yl.prototype.visitInt8=vl,yl.prototype.visitInt16=vl,yl.prototype.visitInt32=vl,yl.prototype.visitInt64=vl,yl.prototype.visitUint8=vl,yl.prototype.visitUint16=vl,yl.prototype.visitUint32=vl,yl.prototype.visitUint64=vl,yl.prototype.visitFloat=vl,yl.prototype.visitFloat16=vl,yl.prototype.visitFloat32=vl,yl.prototype.visitFloat64=vl,yl.prototype.visitUtf8=vl,yl.prototype.visitBinary=vl,yl.prototype.visitFixedSizeBinary=vl,yl.prototype.visitDate=vl,yl.prototype.visitDateDay=vl,yl.prototype.visitDateMillisecond=vl,yl.prototype.visitTimestamp=vl,yl.prototype.visitTimestampSecond=vl,yl.prototype.visitTimestampMillisecond=vl,yl.prototype.visitTimestampMicrosecond=vl,yl.prototype.visitTimestampNanosecond=vl,yl.prototype.visitTime=vl,yl.prototype.visitTimeSecond=vl,yl.prototype.visitTimeMillisecond=vl,yl.prototype.visitTimeMicrosecond=vl,yl.prototype.visitTimeNanosecond=vl,yl.prototype.visitDecimal=vl,yl.prototype.visitList=vl,yl.prototype.visitStruct=vl,yl.prototype.visitUnion=vl,yl.prototype.visitDenseUnion=vl,yl.prototype.visitSparseUnion=vl,yl.prototype.visitDictionary=vl,yl.prototype.visitInterval=vl,yl.prototype.visitIntervalDayTime=vl,yl.prototype.visitIntervalYearMonth=vl,yl.prototype.visitFixedSizeList=vl,yl.prototype.visitMap=vl;const gl=new yl,xl=(t,e)=>t+e;class wl extends Na{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return t.type.bitWidth/8}visitDate(t,e){return 4*(t.type.unit+1)}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===Go.SECOND?4:8}visitInterval(t,e){return 4*(t.type.unit+1)}visitStruct(t,e){return t.children.reduce(((t,n)=>t+Al.visit(n,e)),0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return 8+t.children.reduce(((t,n)=>t+Al.visit(n,e)),0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+((null===(n=t.dictionary)||void 0===n?void 0:n.getByteLength(t.values[e]))||0)}}const _l=(t,e)=>{let{type:n,children:i,typeIds:r,valueOffsets:o}=t;const s=n.typeIdToChildIndex[r[e]];return 8+Al.visit(i[s],o[e])},Sl=(t,e)=>{let{children:n}=t;return 4+Al.visitMany(n,n.map((()=>e))).reduce(xl,0)};wl.prototype.visitUtf8=(t,e)=>{let{valueOffsets:n}=t;return n[e+1]-n[e]+8},wl.prototype.visitBinary=(t,e)=>{let{valueOffsets:n}=t;return n[e+1]-n[e]+8},wl.prototype.visitList=(t,e)=>{let{valueOffsets:n,stride:i,children:r}=t;const o=r[0],{[e*i]:s}=n,{[e*i+1]:a}=n,u=Al.getVisitFn(o.type),l=o.slice(s,a-s);let c=8;for(let h=-1,f=a-s;++h<f;)c+=u(l,h);return c},wl.prototype.visitFixedSizeList=(t,e)=>{let{stride:n,children:i}=t;const r=i[0],o=r.slice(e*n,n),s=Al.getVisitFn(r.type);let a=0;for(let u=-1,l=o.length;++u<l;)a+=s(o,u);return a},wl.prototype.visitUnion=(t,e)=>t.type.mode===$o.Dense?_l(t,e):Sl(t,e),wl.prototype.visitDenseUnion=_l,wl.prototype.visitSparseUnion=Sl;const Al=new wl;var Tl;const Il={},Cl={};class Pl{constructor(t){var e,n,i;const r=t[0]instanceof Pl?t.flatMap((t=>t.data)):t;if(0===r.length||r.some((t=>!(t instanceof zl))))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=null===(e=r[0])||void 0===e?void 0:e.type;switch(r.length){case 0:this._offsets=[0];break;case 1:{const{get:t,set:e,indexOf:n,byteLength:i}=Il[o.typeId],s=r[0];this.isValid=t=>el(s,t),this.get=e=>t(s,e),this.set=(t,n)=>e(s,t,n),this.indexOf=t=>n(s,t),this.getByteLength=t=>i(s,t),this._offsets=[0,s.length];break}default:Object.setPrototypeOf(this,Cl[o.typeId]),this._offsets=Qu(r)}this.data=r,this.type=o,this.stride=La(o),this.numChildren=null!==(i=null===(n=o.children)||void 0===n?void 0:n.length)&&void 0!==i?i:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return-1===this._byteLength&&(this._byteLength=this.data.reduce(((t,e)=>t+e.byteLength),0)),this._byteLength}get nullCount(){return-1===this._nullCount&&(this._nullCount=Ku(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Xo[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return gl.visit(this)}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Pl(this.data.concat(e.flatMap((t=>t.data)).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new Pl(qu(this,t,e,((t,e,n)=>{let{data:i,_offsets:r}=t;return Ju(i,r,e,n)})))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:n,stride:i,ArrayType:r}=this;switch(t.typeId){case Xo.Int:case Xo.Float:case Xo.Decimal:case Xo.Time:case Xo.Timestamp:switch(e.length){case 0:return new r;case 1:return e[0].values.subarray(0,n*i);default:return e.reduce(((t,e)=>{let{values:n,length:r}=e;return t.array.set(n.subarray(0,r*i),t.offset),t.offset+=r*i,t}),{array:new r(n*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt(null===(e=this.type.children)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.numChildren?new Pl(this.data.map((e=>{let{children:n}=e;return n[t]}))):null}get isMemoized(){return!!ma.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(ma.isDictionary(this.type)){const t=new kl(this.data[0].dictionary),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new Pl(e)}return new kl(this)}unmemoize(){if(ma.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new Pl(e)}return this}}Tl=Symbol.toStringTag,Pl[Tl]=(t=>{t.type=ma.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._nullCount=-1,t._byteLength=-1,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(Xo).map((t=>Xo[t])).filter((t=>"number"===typeof t&&t!==Xo.NONE));for(const n of e){const e=Nu.getVisitFnByTypeId(n),i=hu.getVisitFnByTypeId(n),r=ml.getVisitFnByTypeId(n),o=Al.getVisitFnByTypeId(n);Il[n]={get:e,set:i,indexOf:r,byteLength:o},Cl[n]=Object.create(t,{isValid:{value:nl(el)},get:{value:nl(Nu.getVisitFnByTypeId(n))},set:{value:il(hu.getVisitFnByTypeId(n))},indexOf:{value:rl(ml.getVisitFnByTypeId(n))},getByteLength:{value:nl(Al.getVisitFnByTypeId(n))}})}return"Vector"})(Pl.prototype);class kl extends Pl{constructor(t){super(t.data);const e=this.get,n=this.set,i=this.slice,r=new Array(this.length);Object.defineProperty(this,"get",{value(t){const n=r[t];if(void 0!==n)return n;const i=e.call(this,t);return r[t]=i,i}}),Object.defineProperty(this,"set",{value(t,e){n.call(this,t,e),r[t]=e}}),Object.defineProperty(this,"slice",{value:(t,e)=>new kl(i.call(this,t,e))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Pl(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class zl{constructor(t,e,n,i,r){let o,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],a=arguments.length>6?arguments[6]:void 0;this.type=t,this.children=s,this.dictionary=a,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1)),r instanceof zl?(this.stride=r.stride,this.values=r.values,this.typeIds=r.typeIds,this.nullBitmap=r.nullBitmap,this.valueOffsets=r.valueOffsets):(this.stride=La(t),r&&((o=r[0])&&(this.valueOffsets=o),(o=r[1])&&(this.values=o),(o=r[2])&&(this.nullBitmap=o),(o=r[3])&&(this.typeIds=o))),this.nullable=0!==this._nullCount&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:e,values:n,nullBitmap:i,typeIds:r}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),i&&(t+=i.byteLength),r&&(t+=r.byteLength),this.children.reduce(((t,e)=>t+e.byteLength),t)}get nullCount(){let t,e=this._nullCount;return e<=-1&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-cl(t,this.offset,this.offset+this.length)),e}getValid(t){if(this.nullable&&this.nullCount>0){const e=this.offset+t;return 0!==(this.nullBitmap[e>>3]&1<<e%8)}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:t}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:t,_nullCount:0})}const{nullBitmap:n,offset:i}=this,r=i+t>>3,o=(i+t)%8,s=n[r]>>o&1;return e?0===s&&(n[r]|=1<<o,this._nullCount=this.nullCount+1):1===s&&(n[r]&=~(1<<o),this._nullCount=this.nullCount-1),e}clone(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.type,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.offset,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.length,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._nullCount,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.children;return new zl(t,e,n,i,r,o,this.dictionary)}slice(t,e){const{stride:n,typeId:i,children:r}=this,o=+(0===this._nullCount)-1,s=16===i?n:1,a=this._sliceBuffers(t,e,n,i);return this.clone(this.type,this.offset+t,e,o,a,0===r.length||this.valueOffsets?r:this._sliceChildren(r,s*t,s*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===Xo.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:n}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);i[e>>3]=(1<<e-(-8&e))-1,n>0&&i.set(al(this.offset,e,this.nullBitmap),0);const r=this.buffers;return r[Zo.VALIDITY]=i,this.clone(this.type,0,t,n+(t-e),r)}_sliceBuffers(t,e,n,i){let r;const{buffers:o}=this;return(r=o[Zo.TYPE])&&(o[Zo.TYPE]=r.subarray(t,t+e)),(r=o[Zo.OFFSET])&&(o[Zo.OFFSET]=r.subarray(t,t+e+1))||(r=o[Zo.DATA])&&(o[Zo.DATA]=6===i?r:r.subarray(n*t,n*(t+e))),o}_sliceChildren(t,e,n){return t.map((t=>t.slice(e,n)))}}zl.prototype.children=Object.freeze([]);class Dl extends Na{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{type:e,offset:n=0,length:i=0}=t;return new zl(e,n,i,0)}visitBool(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length>>3,nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitInt(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length,nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitFloat(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length,nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitUtf8(t){const{type:e,offset:n=0}=t,i=Ms(t.data),r=Ms(t.nullBitmap),o=Fs(t.valueOffsets),{length:s=o.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zl(e,n,s,a,[o,i,r])}visitBinary(t){const{type:e,offset:n=0}=t,i=Ms(t.data),r=Ms(t.nullBitmap),o=Fs(t.valueOffsets),{length:s=o.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zl(e,n,s,a,[o,i,r])}visitFixedSizeBinary(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length/La(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitDate(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length/La(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitTimestamp(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length/La(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitTime(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length/La(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitDecimal(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length/La(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitList(t){const{type:e,offset:n=0,child:i}=t,r=Ms(t.nullBitmap),o=Fs(t.valueOffsets),{length:s=o.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zl(e,n,s,a,[o,void 0,r],[i])}visitStruct(t){const{type:e,offset:n=0,children:i=[]}=t,r=Ms(t.nullBitmap),{length:o=i.reduce(((t,e)=>{let{length:n}=e;return Math.max(t,n)}),0),nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,void 0,r],i)}visitUnion(t){const{type:e,offset:n=0,children:i=[]}=t,r=Ms(t.nullBitmap),o=Os(e.ArrayType,t.typeIds),{length:s=o.length,nullCount:a=(t.nullBitmap?-1:0)}=t;if(ma.isSparseUnion(e))return new zl(e,n,s,a,[void 0,void 0,r,o],i);const u=Fs(t.valueOffsets);return new zl(e,n,s,a,[u,void 0,r,o],i)}visitDictionary(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.indices.ArrayType,t.data),{dictionary:o=new Pl([(new Dl).visit({type:e.dictionary})])}=t,{length:s=r.length,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zl(e,n,s,a,[void 0,r,i],[],o)}visitInterval(t){const{type:e,offset:n=0}=t,i=Ms(t.nullBitmap),r=Os(e.ArrayType,t.data),{length:o=r.length/La(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,r,i])}visitFixedSizeList(t){const{type:e,offset:n=0,child:i=(new Dl).visit({type:e.valueType})}=t,r=Ms(t.nullBitmap),{length:o=i.length/La(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new zl(e,n,o,s,[void 0,void 0,r],[i])}visitMap(t){const{type:e,offset:n=0,child:i=(new Dl).visit({type:e.childType})}=t,r=Ms(t.nullBitmap),o=Fs(t.valueOffsets),{length:s=o.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new zl(e,n,s,a,[o,void 0,r],[i])}}function Ol(t){return(new Dl).visit(t)}class Fl{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.fields=t||[],this.metadata=e||new Map,n||(n=El(t)),this.dictionaries=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((t=>t.name))}toString(){return`Schema<{ ${this.fields.map(((t,e)=>`${e}: ${t}`)).join(", ")} }>`}select(t){const e=new Set(t),n=this.fields.filter((t=>e.has(t.name)));return new Fl(n,this.metadata)}selectAt(t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new Fl(e,this.metadata)}assign(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e[0]instanceof Fl?e[0]:Array.isArray(e[0])?new Fl(e[0]):new Fl(e),r=[...this.fields],o=Bl(Bl(new Map,this.metadata),i.metadata),s=i.fields.filter((t=>{const e=r.findIndex((e=>e.name===t.name));return!~e||(r[e]=t.clone({metadata:Bl(Bl(new Map,r[e].metadata),t.metadata)}))&&!1})),a=El(s,new Map);return new Fl([...r,...s],o,new Map([...this.dictionaries,...a]))}}Fl.prototype.fields=null,Fl.prototype.metadata=null,Fl.prototype.dictionaries=null;class Ml{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;this.name=t,this.type=e,this.nullable=n,this.metadata=i||new Map}static new(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];let[i,r,o,s]=e;return e[0]&&"object"===typeof e[0]&&(({name:i}=e[0]),void 0===r&&(r=e[0].type),void 0===o&&(o=e[0].nullable),void 0===s&&(s=e[0].metadata)),new Ml(`${i}`,r,o,s)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];let[i,r,o,s]=e;return e[0]&&"object"===typeof e[0]?({name:i=this.name,type:r=this.type,nullable:o=this.nullable,metadata:s=this.metadata}=e[0]):[i=this.name,r=this.type,o=this.nullable,s=this.metadata]=e,Ml.new(i,r,o,s)}}function Bl(t,e){return new Map([...t||new Map,...e||new Map])}function El(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;for(let n=-1,i=t.length;++n<i;){const i=t[n].type;if(ma.isDictionary(i))if(e.has(i.id)){if(e.get(i.id)!==i.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else e.set(i.id,i.dictionary);i.children&&i.children.length>0&&El(i.children,e)}return e}Ml.prototype.type=null,Ml.prototype.name=null,Ml.prototype.nullable=null,Ml.prototype.metadata=null;class Ll extends Na{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,n)=>this.compareFields(t,e[n])))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function Nl(t,e){return e instanceof t.constructor}function jl(t,e){return t===e||Nl(t,e)}function Rl(t,e){return t===e||Nl(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function Vl(t,e){return t===e||Nl(t,e)&&t.precision===e.precision}function Ul(t,e){return t===e||Nl(t,e)&&t.unit===e.unit}function $l(t,e){return t===e||Nl(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function Wl(t,e){return t===e||Nl(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function ql(t,e){return t===e||Nl(t,e)&&t.mode===e.mode&&t.typeIds.every(((t,n)=>t===e.typeIds[n]))&&Hl.compareManyFields(t.children,e.children)}function Gl(t,e){return t===e||Nl(t,e)&&t.unit===e.unit}Ll.prototype.visitNull=jl,Ll.prototype.visitBool=jl,Ll.prototype.visitInt=Rl,Ll.prototype.visitInt8=Rl,Ll.prototype.visitInt16=Rl,Ll.prototype.visitInt32=Rl,Ll.prototype.visitInt64=Rl,Ll.prototype.visitUint8=Rl,Ll.prototype.visitUint16=Rl,Ll.prototype.visitUint32=Rl,Ll.prototype.visitUint64=Rl,Ll.prototype.visitFloat=Vl,Ll.prototype.visitFloat16=Vl,Ll.prototype.visitFloat32=Vl,Ll.prototype.visitFloat64=Vl,Ll.prototype.visitUtf8=jl,Ll.prototype.visitBinary=jl,Ll.prototype.visitFixedSizeBinary=function(t,e){return t===e||Nl(t,e)&&t.byteWidth===e.byteWidth},Ll.prototype.visitDate=Ul,Ll.prototype.visitDateDay=Ul,Ll.prototype.visitDateMillisecond=Ul,Ll.prototype.visitTimestamp=$l,Ll.prototype.visitTimestampSecond=$l,Ll.prototype.visitTimestampMillisecond=$l,Ll.prototype.visitTimestampMicrosecond=$l,Ll.prototype.visitTimestampNanosecond=$l,Ll.prototype.visitTime=Wl,Ll.prototype.visitTimeSecond=Wl,Ll.prototype.visitTimeMillisecond=Wl,Ll.prototype.visitTimeMicrosecond=Wl,Ll.prototype.visitTimeNanosecond=Wl,Ll.prototype.visitDecimal=jl,Ll.prototype.visitList=function(t,e){return t===e||Nl(t,e)&&t.children.length===e.children.length&&Hl.compareManyFields(t.children,e.children)},Ll.prototype.visitStruct=function(t,e){return t===e||Nl(t,e)&&t.children.length===e.children.length&&Hl.compareManyFields(t.children,e.children)},Ll.prototype.visitUnion=ql,Ll.prototype.visitDenseUnion=ql,Ll.prototype.visitSparseUnion=ql,Ll.prototype.visitDictionary=function(t,e){return t===e||Nl(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&Hl.visit(t.indices,e.indices)&&Hl.visit(t.dictionary,e.dictionary)},Ll.prototype.visitInterval=Gl,Ll.prototype.visitIntervalDayTime=Gl,Ll.prototype.visitIntervalYearMonth=Gl,Ll.prototype.visitFixedSizeList=function(t,e){return t===e||Nl(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&Hl.compareManyFields(t.children,e.children)},Ll.prototype.visitMap=function(t,e){return t===e||Nl(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&Hl.compareManyFields(t.children,e.children)};const Hl=new Ll;function Yl(t,e){return Hl.compareSchemas(t,e)}var Xl,Zl;class Kl{constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];switch(e.length){case 2:if([this.schema]=e,!(this.schema instanceof Fl))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Ol({nullCount:0,type:new ka(this.schema.fields),children:this.schema.fields.map((t=>Ol({type:t.type,nullCount:0})))})]=e,!(this.data instanceof zl))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Ql(this.schema,this.data.children);break;case 1:{const[t]=e,{fields:n,children:i,length:r}=Object.keys(t).reduce(((e,n,i)=>(e.children[i]=t[n],e.length=Math.max(e.length,t[n].length),e.fields[i]=Ml.new({name:n,type:t[n].type,nullable:!0}),e)),{length:0,fields:new Array,children:new Array}),o=new Fl(n),s=Ol({type:new ka(n),length:r,children:i,nullCount:0});[this.schema,this.data]=Ql(o,s.children,r);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Jl(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Nu.visit(this.data,t)}set(t,e){return hu.visit(this.data,t,e)}indexOf(t,e){return ml.visit(this.data,t,e)}getByteLength(t){return Al.visit(this.data,t)}[Symbol.iterator](){return gl.visit(new Pl([this.data]))}toArray(){return[...this]}concat(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new ic(this.schema,[this,...e])}slice(t,e){const[n]=new Pl([this.data]).slice(t,e).data;return new Kl(this.schema,n)}getChild(t){var e;return this.getChildAt(null===(e=this.schema.fields)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new Pl([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,i=this.data;if(t>-1&&t<this.numCols){e||(e=new Pl([Ol({type:new ya,length:this.numRows})]));const r=n.fields.slice(),o=i.children.slice(),s=r[t].clone({type:e.type});[r[t],o[t]]=[s,e.data[0]],n=new Fl(r,new Map(this.schema.metadata)),i=Ol({type:new ka(r),children:o})}return new Kl(n,i)}select(t){const e=this.schema.select(t),n=new ka(e.fields),i=[];for(const r of t){const t=this.schema.fields.findIndex((t=>t.name===r));~t&&(i[t]=this.data.children[t])}return new Kl(e,Ol({type:n,length:this.numRows,children:i}))}selectAt(t){const e=this.schema.selectAt(t),n=t.map((t=>this.data.children[t])).filter(Boolean),i=Ol({type:new ka(e.fields),length:this.numRows,children:n});return new Kl(e,i)}}function Ql(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.reduce(((t,e)=>Math.max(t,e.length)),0);var i;const r=[...t.fields],o=[...e],s=(n+63&-64)>>3;for(const[a,u]of t.fields.entries()){const t=e[a];t&&t.length===n||(r[a]=u.clone({nullable:!0}),o[a]=null!==(i=null===t||void 0===t?void 0:t._changeLengthAndBackfillNullBitmap(n))&&void 0!==i?i:Ol({type:u.type,length:n,nullCount:n,nullBitmap:new Uint8Array(s)}))}return[t.assign(r),Ol({type:new ka(r),length:n,children:o})]}function Jl(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map;for(let i=-1,r=t.length;++i<r;){const r=t[i].type,o=e[i];if(ma.isDictionary(r))if(n.has(r.id)){if(n.get(r.id)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else o.dictionary&&n.set(r.id,o.dictionary);r.children&&r.children.length>0&&Jl(r.children,o.children,n)}return n}Xl=Symbol.toStringTag,Kl[Xl]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Kl.prototype);class tc extends Kl{constructor(t){const e=t.fields.map((t=>Ol({type:t.type})));super(t,Ol({type:new ka(t.fields),nullCount:0,children:e}))}}function ec(t,e){return function(t,e){const n=[...t.fields],i=[],r={numBatches:e.reduce(((t,e)=>Math.max(t,e.length)),0)};let o=0,s=0,a=-1;const u=e.length;let l,c=[];for(;r.numBatches-- >0;){for(s=Number.POSITIVE_INFINITY,a=-1;++a<u;)c[a]=l=e[a].shift(),s=Math.min(s,l?l.length:s);Number.isFinite(s)&&(c=nc(n,s,c,e,r),s>0&&(i[o++]=Ol({type:new ka(n),length:s,nullCount:0,children:c.slice()})))}return[t=t.assign(n),i.map((e=>new Kl(t,e)))]}(t,e.map((t=>t.data.concat())))}function nc(t,e,n,i,r){var o;const s=(e+63&-64)>>3;for(let a=-1,u=i.length;++a<u;){const u=n[a],l=null===u||void 0===u?void 0:u.length;if(l>=e)l===e?n[a]=u:(n[a]=u.slice(0,e),r.numBatches=Math.max(r.numBatches,i[a].unshift(u.slice(e,l-e))));else{const i=t[a];t[a]=i.clone({nullable:!0}),n[a]=null!==(o=null===u||void 0===u?void 0:u._changeLengthAndBackfillNullBitmap(e))&&void 0!==o?o:Ol({type:i.type,length:e,nullCount:e,nullBitmap:new Uint8Array(s)})}}return n}class ic{constructor(){for(var t,e,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];if(0===i.length)return this.batches=[],this.schema=new Fl([]),this._offsets=[0],this;let o,s;i[0]instanceof Fl&&(o=i.shift()),i[i.length-1]instanceof Uint32Array&&(s=i.pop());const a=t=>{if(t){if(t instanceof Kl)return[t];if(t instanceof ic)return t.batches;if(t instanceof zl){if(t.type instanceof ka)return[new Kl(new Fl(t.type.children),t)]}else{if(Array.isArray(t))return t.flatMap((t=>a(t)));if("function"===typeof t[Symbol.iterator])return[...t].flatMap((t=>a(t)));if("object"===typeof t){const e=Object.keys(t),n=e.map((e=>new Pl([t[e]]))),i=new Fl(e.map(((t,e)=>new Ml(String(t),n[e].type)))),[,r]=ec(i,n);return 0===r.length?[new Kl(t)]:r}}}return[]},u=i.flatMap((t=>a(t)));if(o=null!==(e=null!==o&&void 0!==o?o:null===(t=u[0])||void 0===t?void 0:t.schema)&&void 0!==e?e:new Fl([]),!(o instanceof Fl))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const l of u){if(!(l instanceof Kl))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!Yl(o,l.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=o,this.batches=u,this._offsets=null!==s&&void 0!==s?s:Qu(this.data)}get data(){return this.batches.map((t=>{let{data:e}=t;return e}))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((t,e)=>t+e.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=Ku(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?gl.visit(new Pl(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(){const t=this.schema;for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];const r=this.data.concat(n.flatMap((t=>{let{data:e}=t;return e})));return new ic(t,r.map((e=>new Kl(t,e))))}slice(t,e){const n=this.schema;[t,e]=qu({length:this.numRows},t,e);const i=Ju(this.data,this._offsets,t,e);return new ic(n,i.map((t=>new Kl(n,t))))}getChild(t){return this.getChildAt(this.schema.fields.findIndex((e=>e.name===t)))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map((e=>e.children[t]));if(0===e.length){const{type:n}=this.schema.fields[t],i=Ol({type:n,length:0,nullCount:0});e.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new Pl(e)}return null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new Pl([Ol({type:new ya,length:this.numRows})]));const r=n.fields.slice(),o=r[t].clone({type:e.type}),s=this.schema.fields.map(((t,e)=>this.getChildAt(e)));[r[t],s[t]]=[o,e],[n,i]=ec(n,s)}return new ic(n,i)}select(t){const e=this.schema.fields.reduce(((t,e,n)=>t.set(e.name,n)),new Map);return this.selectAt(t.map((t=>e.get(t))).filter((t=>t>-1)))}selectAt(t){const e=this.schema.selectAt(t),n=this.batches.map((e=>e.selectAt(t)));return new ic(e,n)}assign(t){const e=this.schema.fields,[n,i]=t.schema.fields.reduce(((t,n,i)=>{const[r,o]=t,s=e.findIndex((t=>t.name===n.name));return~s?o[s]=i:r.push(i),t}),[[],[]]),r=this.schema.assign(t.schema),o=[...e.map(((t,e)=>[e,i[e]])).map((e=>{let[n,i]=e;return void 0===i?this.getChildAt(n):t.getChildAt(i)})),...n.map((e=>t.getChildAt(e)))].filter(Boolean);return new ic(...ec(r,o))}}Zl=Symbol.toStringTag,ic[Zl]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=nl(el),t.get=nl(Nu.getVisitFn(Xo.Struct)),t.set=il(hu.getVisitFn(Xo.Struct)),t.indexOf=rl(ml.getVisitFn(Xo.Struct)),t.getByteLength=nl(Al.getVisitFn(Xo.Struct)),"Table"))(ic.prototype);class rc{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,i){return t.prep(8,24),t.writeInt64(i),t.pad(4),t.writeInt32(n),t.writeInt64(e),t.offset()}}const oc=new Int32Array(2),sc=new Float32Array(oc.buffer),ac=new Float64Array(oc.buffer),uc=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];class lc{constructor(t,e){this.low=0|t,this.high=0|e}static create(t,e){return 0==t&&0==e?lc.ZERO:new lc(t,e)}toFloat64(){return(this.low>>>0)+4294967296*this.high}equals(t){return this.low==t.low&&this.high==t.high}}var cc,hc,fc,dc,pc;lc.ZERO=new lc(0,0),function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"}(cc||(cc={}));class mc{constructor(t){this.bytes_=t,this.position_=0}static allocate(t){return new mc(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return new lc(this.readInt32(t),this.readInt32(t+4))}readUint64(t){return new lc(this.readUint32(t),this.readUint32(t+4))}readFloat32(t){return oc[0]=this.readInt32(t),sc[0]}readFloat64(t){return oc[uc?0:1]=this.readInt32(t),oc[uc?1:0]=this.readInt32(t+4),ac[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,e.low),this.writeInt32(t+4,e.high)}writeUint64(t,e){this.writeUint32(t,e.low),this.writeUint32(t+4,e.high)}writeFloat32(t,e){sc[0]=e,this.writeInt32(t,oc[0])}writeFloat64(t,e){ac[0]=e,this.writeInt32(t,oc[uc?0:1]),this.writeInt32(t+4,oc[uc?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);let i="",r=0;if(t+=4,e===cc.UTF8_BYTES)return this.bytes_.subarray(t,t+n);for(;r<n;){let e;const n=this.readUint8(t+r++);if(n<192)e=n;else{const i=this.readUint8(t+r++);if(n<224)e=(31&n)<<6|63&i;else{const o=this.readUint8(t+r++);if(n<240)e=(15&n)<<12|(63&i)<<6|63&o;else{e=(7&n)<<18|(63&i)<<12|(63&o)<<6|63&this.readUint8(t+r++)}}}e<65536?i+=String.fromCharCode(e):(e-=65536,i+=String.fromCharCode(55296+(e>>10),56320+(1023&e)))}return i}__union_with_string(t,e){return"string"===typeof t?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createLong(t,e){return lc.create(t,e)}createScalarList(t,e){const n=[];for(let i=0;i<e;++i)null!==t(i)&&n.push(t(i));return n}createObjList(t,e){const n=[];for(let i=0;i<e;++i){const e=t(i);null!==e&&n.push(e.unpack())}return n}}class yc{constructor(t){let e;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,e=t||1024,this.bb=mc.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=1+~(this.bb.capacity()-this.space+e)&t-1;for(;this.space<n+t+e;){const t=this.bb.capacity();this.bb=yc.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){!this.force_defaults&&e.equals(n)||(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")}slot(t){null!==this.vtable&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,i=mc.allocate(n);return i.setPosition(n-e),i.bytes().set(t.bytes(),n-e),i}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&0==this.vtable[e];e--);const n=e+1;for(;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);const i=2*(n+2);this.addInt16(i);let r=0;const o=this.space;t:for(e=0;e<this.vtables.length;e++){const t=this.bb.capacity()-this.vtables[e];if(i==this.bb.readInt16(t)){for(let e=2;e<i;e+=2)if(this.bb.readInt16(o+e)!=this.bb.readInt16(t+e))continue t;r=this.vtables[e];break}}return r?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,r-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const i=n?4:0;if(e){const t=e;if(this.prep(this.minalign,8+i),4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=3;e>=0;e--)this.writeInt8(t.charCodeAt(e))}this.prep(this.minalign,4+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,i=n-this.bb.readInt32(n);if(!(0!=this.bb.readInt16(i+e)))throw new Error("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(!t)return 0;let e;if(t instanceof Uint8Array)e=t;else{e=[];let n=0;for(;n<t.length;){let i;const r=t.charCodeAt(n++);if(r<55296||r>=56320)i=r;else{i=(r<<10)+t.charCodeAt(n++)+-56613888}i<128?e.push(i):(i<2048?e.push(i>>6&31|192):(i<65536?e.push(i>>12&15|224):e.push(i>>18&7|240,i>>12&63|128),e.push(i>>6&63|128)),e.push(63&i|128))}}this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let n=0,i=this.space,r=this.bb.bytes();n<e.length;n++)r[i++]=e[n];return this.endVector()}createLong(t,e){return lc.create(t,e)}createObjectOffset(t){return null===t?0:"string"===typeof t?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const i=t[n];if(null===i)throw new Error("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");e.push(this.createObjectOffset(i))}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t),this.endVector()}}class vc{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new vc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new vc).__init(t.readInt32(t.position())+t.position(),t)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return vc.startKeyValue(t),vc.addKey(t,e),vc.addValue(t,n),vc.endKeyValue(t)}}!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(hc||(hc={})),function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"}(fc||(fc={})),function(t){t[t.DenseArray=0]="DenseArray"}(dc||(dc={}));class bc{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new bc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new bc).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return bc.startInt(t),bc.addBitWidth(t,e),bc.addIsSigned(t,n),bc.endInt(t)}}class gc{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new gc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new gc).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new bc).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):dc.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,dc.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList"}(pc||(pc={}));class xc{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new xc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+4),(e||new xc).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):pc.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new gc).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){const n=this.bb.__offset(this.bb_pos,14);return n?(e||new xc).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,16);return n?(e||new vc).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,pc.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}}class wc{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new wc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+4),(e||new wc).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):fc.Little}fields(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new xc).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new vc).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*t):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,fc.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,n,i,r){return wc.startSchema(t),wc.addEndianness(t,e),wc.addFields(t,n),wc.addCustomMetadata(t,i),wc.addFeatures(t,r),wc.endSchema(t)}}class _c{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new _c).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new _c).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):hc.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new wc).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new rc).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new rc).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new vc).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,hc.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}var Sc=lc,Ac=yc,Tc=mc;class Ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uo.V4,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.schema=t,this.version=e,n&&(this._recordBatches=n),i&&(this._dictionaryBatches=i)}static decode(t){t=new Tc(Ms(t));const e=_c.getRootAsFooter(t),n=Fl.decode(e.schema());return new Cc(n,e)}static encode(t){const e=new Ac,n=Fl.encode(e,t.schema);_c.startRecordBatchesVector(e,t.numRecordBatches);for(const o of[...t.recordBatches()].slice().reverse())Pc.encode(e,o);const i=e.endVector();_c.startDictionariesVector(e,t.numDictionaries);for(const o of[...t.dictionaryBatches()].slice().reverse())Pc.encode(e,o);const r=e.endVector();return _c.startFooter(e),_c.addSchema(e,n),_c.addVersion(e,Uo.V4),_c.addRecordBatches(e,i),_c.addDictionaries(e,r),_c.finishFooterBuffer(e,_c.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class Cc extends Ic{constructor(t,e){super(t,e.version()),this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return Pc.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return Pc.decode(e)}return null}}class Pc{constructor(t,e,n){this.metaDataLength=t,this.offset="number"===typeof n?n:n.low,this.bodyLength="number"===typeof e?e:e.low}static decode(t){return new Pc(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:n}=e,i=new Sc(e.offset,0),r=new Sc(e.bodyLength,0);return rc.createBlock(t,i,n,r)}}const kc={fromIterable:t=>zc(function*(t){let e,n,i,r,o=!1,s=[],a=0;function u(){return"peek"===i?Ds(s,r)[0]:([n,s,a]=Ds(s,r),n)}({cmd:i,size:r}=yield null);const l=(c=t,Es(Uint8Array,c))[Symbol.iterator]();var c;try{do{if(({done:e,value:n}=Number.isNaN(r-a)?l.next():l.next(r-a)),!e&&n.byteLength>0&&(s.push(n),a+=n.byteLength),e||r<=a)do{({cmd:i,size:r}=yield u())}while(r<a)}while(!e)}catch(h){(o=!0)&&"function"===typeof l.throw&&l.throw(h)}finally{!1===o&&"function"===typeof l.return&&l.return(null)}return null}(t)),fromAsyncIterable:t=>zc(function(t){return _s(this,arguments,(function*(){let e,n,i,r,o=!1,s=[],a=0;function u(){return"peek"===i?Ds(s,r)[0]:([n,s,a]=Ds(s,r),n)}({cmd:i,size:r}=yield yield ws(null));const l=(c=t,Ls(Uint8Array,c))[Symbol.asyncIterator]();var c;try{do{if(({done:e,value:n}=Number.isNaN(r-a)?yield ws(l.next()):yield ws(l.next(r-a))),!e&&n.byteLength>0&&(s.push(n),a+=n.byteLength),e||r<=a)do{({cmd:i,size:r}=yield yield ws(u()))}while(r<a)}while(!e)}catch(h){(o=!0)&&"function"===typeof l.throw&&(yield ws(l.throw(h)))}finally{!1===o&&"function"===typeof l.return&&(yield ws(l.return(new Uint8Array(0))))}return yield ws(null)}))}(t)),fromDOMStream:t=>zc(function(t){return _s(this,arguments,(function*(){let e,n,i,r=!1,o=!1,s=[],a=0;function u(){return"peek"===n?Ds(s,i)[0]:([e,s,a]=Ds(s,i),e)}({cmd:n,size:i}=yield yield ws(null));const l=new Dc(t);try{do{if(({done:r,value:e}=Number.isNaN(i-a)?yield ws(l.read()):yield ws(l.read(i-a))),!r&&e.byteLength>0&&(s.push(Ms(e)),a+=e.byteLength),r||i<=a)do{({cmd:n,size:i}=yield yield ws(u()))}while(i<a)}while(!r)}catch(c){(o=!0)&&(yield ws(l.cancel(c)))}finally{!1===o?yield ws(l.cancel()):t.locked&&l.releaseLock()}return yield ws(null)}))}(t)),fromNodeStream:t=>zc(function(t){return _s(this,arguments,(function*(){const e=[];let n,i,r,o="error",s=!1,a=null,u=0,l=[];function c(){return"peek"===n?Ds(l,i)[0]:([r,l,u]=Ds(l,i),r)}if(({cmd:n,size:i}=yield yield ws(null)),t.isTTY)return yield yield ws(new Uint8Array(0)),yield ws(null);try{e[0]=Oc(t,"end"),e[1]=Oc(t,"error");do{if(e[2]=Oc(t,"readable"),[o,a]=yield ws(Promise.race(e.map((t=>t[2])))),"error"===o)break;if((s="end"===o)||(Number.isFinite(i-u)?(r=Ms(t.read(i-u)),r.byteLength<i-u&&(r=Ms(t.read()))):r=Ms(t.read()),r.byteLength>0&&(l.push(r),u+=r.byteLength)),s||i<=u)do{({cmd:n,size:i}=yield yield ws(c()))}while(i<u)}while(!s)}finally{yield ws(h(e,"error"===o?a:null))}return yield ws(null);function h(e,n){return r=l=null,new Promise(((i,r)=>{for(const[n,s]of e)t.off(n,s);try{const e=t.destroy;e&&e.call(t,n),n=void 0}catch(o){n=o||n}finally{null!=n?r(n):i()}}))}}))}(t)),toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},zc=t=>(t.next(),t);class Dc{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch((()=>{}))}get closed(){return this.reader?this.reader.closed.catch((()=>{})):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return gs(this,void 0,void 0,(function*(){const{reader:e,source:n}=this;e&&(yield e.cancel(t).catch((()=>{}))),n&&n.locked&&this.releaseLock()}))}read(t){return gs(this,void 0,void 0,(function*(){if(0===t)return{done:null==this.reader,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=Ms(e)),e}))}}const Oc=(t,e)=>{const n=t=>i([e,t]);let i;return[e,n,new Promise((r=>(i=r)&&t.once(e,n)))]};const Fc=Object.freeze({done:!0,value:void 0});class Mc{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class Bc{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class Ec extends Bc{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}get closed(){return this._closedPromise}cancel(t){return gs(this,void 0,void 0,(function*(){yield this.return(t)}))}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(Fc);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return kc.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return kc.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return gs(this,void 0,void 0,(function*(){return yield this.abort(t),Fc}))}return(t){return gs(this,void 0,void 0,(function*(){return yield this.close(),Fc}))}read(t){return gs(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return gs(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise(((t,e)=>{this.resolvers.push({resolve:t,reject:e})})):Promise.resolve(Fc)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class Lc extends Ec{write(t){if((t=Ms(t)).byteLength>0)return super.write(t)}toString(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Is(this.toUint8Array(!0)):this.toUint8Array(!1).then(Is)}toUint8Array(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Ds(this._values)[0]:(()=>gs(this,void 0,void 0,(function*(){var t,e;const n=[];let i=0;try{for(var r,o=As(this);!(r=yield o.next()).done;){const t=r.value;n.push(t),i+=t.byteLength}}catch(s){t={error:s}}finally{try{r&&!r.done&&(e=o.return)&&(yield e.call(o))}finally{if(t)throw t.error}}return Ds(n,i)[0]})))()}}class Nc{constructor(t){t&&(this.source=new Rc(kc.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class jc{constructor(t){t instanceof jc?this.source=t.source:t instanceof Lc?this.source=new Vc(kc.fromAsyncIterable(t)):vs(t)?this.source=new Vc(kc.fromNodeStream(t)):ys(t)?this.source=new Vc(kc.fromDOMStream(t)):ps(t)?this.source=new Vc(kc.fromDOMStream(t.body)):ls(t)?this.source=new Vc(kc.fromIterable(t)):(us(t)||cs(t))&&(this.source=new Vc(kc.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class Rc{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||Fc)}return(t){return Object.create(this.source.return&&this.source.return(t)||Fc)}}class Vc{constructor(t){this.source=t,this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}cancel(t){return gs(this,void 0,void 0,(function*(){yield this.return(t)}))}get closed(){return this._closedPromise}read(t){return gs(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return gs(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";return gs(this,void 0,void 0,(function*(){return yield this.source.next({cmd:e,size:t})}))}throw(t){return gs(this,void 0,void 0,(function*(){const e=this.source.throw&&(yield this.source.throw(t))||Fc;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}return(t){return gs(this,void 0,void 0,(function*(){const e=this.source.return&&(yield this.source.return(t))||Fc;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}}class Uc extends Nc{constructor(t,e){super(),this.position=0,this.buffer=Ms(t),this.size="undefined"===typeof e?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:n,position:i}=this;return e&&i<n?("number"!==typeof t&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,i+Math.min(n-i,t)),e.subarray(i,this.position)):null}readAt(t,e){const n=this.buffer,i=Math.min(this.size,t+e);return n?n.subarray(t,i):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class $c extends jc{constructor(t,e){super(),this.position=0,this._handle=t,"number"===typeof e?this.size=e:this._pending=(()=>gs(this,void 0,void 0,(function*(){this.size=(yield t.stat()).size,delete this._pending})))()}readInt32(t){return gs(this,void 0,void 0,(function*(){const{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}))}seek(t){return gs(this,void 0,void 0,(function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size}))}read(t){return gs(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:e,size:n,position:i}=this;if(e&&i<n){"number"!==typeof t&&(t=Number.POSITIVE_INFINITY);let r=i,o=0,s=0;const a=Math.min(n,r+Math.min(n-r,t)),u=new Uint8Array(Math.max(0,(this.position=a)-r));for(;(r+=s)<a&&(o+=s)<u.byteLength;)({bytesRead:s}=yield e.read(u,o,u.byteLength-o,r));return u}return null}))}readAt(t,e){return gs(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:n,size:i}=this;if(n&&t+e<i){const r=Math.min(i,t+e),o=new Uint8Array(r-t);return(yield n.read(o,0,e,t)).buffer}return new Uint8Array(e)}))}close(){return gs(this,void 0,void 0,(function*(){const t=this._handle;this._handle=null,t&&(yield t.close())}))}throw(t){return gs(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}return(t){return gs(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}}function Wc(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}const qc=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class Gc{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),n=new Uint32Array([t.buffer[1]>>>16,65535&t.buffer[1],t.buffer[0]>>>16,65535&t.buffer[0]]);let i=e[3]*n[3];this.buffer[0]=65535&i;let r=i>>>16;return i=e[2]*n[3],r+=i,i=e[3]*n[2]>>>0,r+=i,this.buffer[0]+=r<<16,this.buffer[1]=r>>>0<i?65536:0,this.buffer[1]+=r>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Wc(this.buffer[1])} ${Wc(this.buffer[0])}`}}class Hc extends Gc{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return Hc.fromString("string"===typeof t?t:t.toString(),e)}static fromNumber(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return Hc.fromString(t.toString(),e)}static fromString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);const n=t.length,i=new Hc(e);for(let r=0;r<n;){const e=8<n-r?8:n-r,o=new Hc(new Uint32Array([Number.parseInt(t.slice(r,r+e),10),0])),s=new Hc(new Uint32Array([qc[e],0]));i.times(s),i.plus(o),r+=e}return i}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,i=t.length;++n<i;)Hc.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new Hc(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Hc(new Uint32Array(t.buffer)).plus(e)}}class Yc extends Gc{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=this.buffer[1]|0,n=t.buffer[1]|0;return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return Yc.fromString("string"===typeof t?t:t.toString(),e)}static fromNumber(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);return Yc.fromString(t.toString(),e)}static fromString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(2);const n=t.startsWith("-"),i=t.length,r=new Yc(e);for(let o=n?1:0;o<i;){const e=8<i-o?8:i-o,n=new Yc(new Uint32Array([Number.parseInt(t.slice(o,o+e),10),0])),s=new Yc(new Uint32Array([qc[e],0]));r.times(s),r.plus(n),o+=e}return n?r.negate():r}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,i=t.length;++n<i;)Yc.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new Yc(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Yc(new Uint32Array(t.buffer)).plus(e)}}class Xc{constructor(t){this.buffer=t}high(){return new Yc(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Yc(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(t){const e=new Hc(new Uint32Array([this.buffer[3],0])),n=new Hc(new Uint32Array([this.buffer[2],0])),i=new Hc(new Uint32Array([this.buffer[1],0])),r=new Hc(new Uint32Array([this.buffer[0],0])),o=new Hc(new Uint32Array([t.buffer[3],0])),s=new Hc(new Uint32Array([t.buffer[2],0])),a=new Hc(new Uint32Array([t.buffer[1],0])),u=new Hc(new Uint32Array([t.buffer[0],0]));let l=Hc.multiply(r,u);this.buffer[0]=l.low();const c=new Hc(new Uint32Array([l.high(),0]));l=Hc.multiply(i,u),c.plus(l),l=Hc.multiply(r,a),c.plus(l),this.buffer[1]=c.low(),this.buffer[3]=c.lessThan(l)?1:0,this.buffer[2]=c.high();return new Hc(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Hc.multiply(n,u)).plus(Hc.multiply(i,a)).plus(Hc.multiply(r,s)),this.buffer[3]+=Hc.multiply(e,u).plus(Hc.multiply(n,a)).plus(Hc.multiply(i,s)).plus(Hc.multiply(r,o)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${Wc(this.buffer[3])} ${Wc(this.buffer[2])} ${Wc(this.buffer[1])} ${Wc(this.buffer[0])}`}static multiply(t,e){return new Xc(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Xc(new Uint32Array(t.buffer)).plus(e)}static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);return Xc.fromString("string"===typeof t?t:t.toString(),e)}static fromNumber(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);return Xc.fromString(t.toString(),e)}static fromString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint32Array(4);const n=t.startsWith("-"),i=t.length,r=new Xc(e);for(let o=n?1:0;o<i;){const e=8<i-o?8:i-o,n=new Xc(new Uint32Array([Number.parseInt(t.slice(o,o+e),10),0,0,0])),s=new Xc(new Uint32Array([qc[e],0,0,0]));r.times(s),r.plus(n),o+=e}return n?r.negate():r}static convertArray(t){const e=new Uint32Array(4*t.length);for(let n=-1,i=t.length;++n<i;)Xc.from(t[n],new Uint32Array(e.buffer,e.byteOffset+16*n,4));return e}}class Zc extends Na{constructor(t,e,n,i){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=i}visit(t){return super.visit(t instanceof Ml?t.type:t)}visitNull(t){let{length:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e})}visitBool(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===$o.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t){let{length:e,nullCount:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextFieldNode();return Ol({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.nextBufferRange();return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t){let{length:e,offset:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class Kc extends Zc{constructor(t,e,n,i){super(new Uint8Array(0),e,n,i),this.sources=t}readNullBitmap(t,e){let{offset:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.nextBufferRange();return e<=0?new Uint8Array(0):ul(this.sources[n])}readOffsets(t){let{offset:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return Os(Uint8Array,Os(Int32Array,this.sources[e]))}readTypeIds(t){let{offset:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();return Os(Uint8Array,Os(t.ArrayType,this.sources[e]))}readData(t){let{offset:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.nextBufferRange();const{sources:n}=this;return ma.isTimestamp(t)||(ma.isInt(t)||ma.isTime(t))&&64===t.bitWidth||ma.isDate(t)&&t.unit===qo.MILLISECOND?Os(Uint8Array,Yc.convertArray(n[e])):ma.isDecimal(t)?Os(Uint8Array,Xc.convertArray(n[e])):ma.isBinary(t)||ma.isFixedSizeBinary(t)?function(t){const e=t.join(""),n=new Uint8Array(e.length/2);for(let i=0;i<e.length;i+=2)n[i>>1]=Number.parseInt(e.slice(i,i+2),16);return n}(n[e]):ma.isBool(t)?ul(n[e]):ma.isUtf8(t)?Ps(n[e].join("")):Os(Uint8Array,Os(t.ArrayType,n[e].map((t=>+t))))}}var Qc,Jc,th,eh,nh,ih,rh,oh;!function(t){t[t.BUFFER=0]="BUFFER"}(Qc||(Qc={})),function(t){t[t.LZ4_FRAME=0]="LZ4_FRAME",t[t.ZSTD=1]="ZSTD"}(Jc||(Jc={}));class sh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new sh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new sh).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):Jc.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Qc.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,Jc.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,Qc.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return sh.startBodyCompression(t),sh.addCodec(t,e),sh.addMethod(t,n),sh.endBodyCompression(t)}}class ah{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}class uh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(n),t.writeInt64(e),t.offset()}}class lh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new lh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+4),(e||new lh).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new uh).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new ah).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new sh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}}class ch{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new ch).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+4),(e||new ch).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new lh).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}}!function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(th||(th={}));class hh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new hh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new hh).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):th.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,th.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return hh.startFloatingPoint(t),hh.addPrecision(t,e),hh.endFloatingPoint(t)}}class fh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new fh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new fh).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,i){return fh.startDecimal(t),fh.addPrecision(t,e),fh.addScale(t,n),fh.addBitWidth(t,i),fh.endDecimal(t)}}!function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(eh||(eh={}));class dh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new dh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+4),(e||new dh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):eh.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,eh.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return dh.startDate(t),dh.addUnit(t,e),dh.endDate(t)}}!function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(nh||(nh={}));class ph{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new ph).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new ph).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):nh.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,nh.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return ph.startTime(t),ph.addUnit(t,e),ph.addBitWidth(t,n),ph.endTime(t)}}class mh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new mh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new mh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):nh.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,nh.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return mh.startTimestamp(t),mh.addUnit(t,e),mh.addTimezone(t,n),mh.endTimestamp(t)}}!function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(ih||(ih={}));class yh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new yh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new yh).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):ih.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,ih.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return yh.startInterval(t),yh.addUnit(t,e),yh.endInterval(t)}}!function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(rh||(rh={}));class vh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new vh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new vh).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):rh.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*t):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,rh.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return vh.startUnion(t),vh.addMode(t,e),vh.addTypeIds(t,n),vh.endUnion(t)}}class bh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new bh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new bh).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return bh.startFixedSizeBinary(t),bh.addByteWidth(t,e),bh.endFixedSizeBinary(t)}}class gh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new gh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new gh).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return gh.startFixedSizeList(t),gh.addListSize(t,e),gh.endFixedSizeList(t)}}class xh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new xh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+4),(e||new xh).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return xh.startMap(t),xh.addKeysSorted(t,e),xh.endMap(t)}}!function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(oh||(oh={}));class wh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new wh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+4),(e||new wh).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):hc.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):oh.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new vc).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,hc.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,oh.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,n,i,r,o){return wh.startMessage(t),wh.addVersion(t,e),wh.addHeaderType(t,n),wh.addHeader(t,i),wh.addBodyLength(t,r),wh.addCustomMetadata(t,o),wh.endMessage(t)}}class _h{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new _h).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new _h).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return _h.startNull(t),_h.endNull(t)}}class Sh{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new Sh).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new Sh).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return Sh.startBinary(t),Sh.endBinary(t)}}class Ah{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new Ah).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new Ah).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return Ah.startBool(t),Ah.endBool(t)}}class Th{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new Th).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new Th).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return Th.startUtf8(t),Th.endUtf8(t)}}class Ih{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new Ih).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new Ih).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return Ih.startList(t),Ih.endList(t)}}class Ch{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new Ch).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new Ch).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return Ch.startStruct_(t),Ch.endStruct_(t)}}var Ph=lc;const kh=new class extends Na{visit(t,e){return null==t||null==e?void 0:super.visit(t,e)}visitNull(t,e){return _h.startNull(e),_h.endNull(e)}visitInt(t,e){return bc.startInt(e),bc.addBitWidth(e,t.bitWidth),bc.addIsSigned(e,t.isSigned),bc.endInt(e)}visitFloat(t,e){return hh.startFloatingPoint(e),hh.addPrecision(e,t.precision),hh.endFloatingPoint(e)}visitBinary(t,e){return Sh.startBinary(e),Sh.endBinary(e)}visitBool(t,e){return Ah.startBool(e),Ah.endBool(e)}visitUtf8(t,e){return Th.startUtf8(e),Th.endUtf8(e)}visitDecimal(t,e){return fh.startDecimal(e),fh.addScale(e,t.scale),fh.addPrecision(e,t.precision),fh.addBitWidth(e,t.bitWidth),fh.endDecimal(e)}visitDate(t,e){return dh.startDate(e),dh.addUnit(e,t.unit),dh.endDate(e)}visitTime(t,e){return ph.startTime(e),ph.addUnit(e,t.unit),ph.addBitWidth(e,t.bitWidth),ph.endTime(e)}visitTimestamp(t,e){const n=t.timezone&&e.createString(t.timezone)||void 0;return mh.startTimestamp(e),mh.addUnit(e,t.unit),void 0!==n&&mh.addTimezone(e,n),mh.endTimestamp(e)}visitInterval(t,e){return yh.startInterval(e),yh.addUnit(e,t.unit),yh.endInterval(e)}visitList(t,e){return Ih.startList(e),Ih.endList(e)}visitStruct(t,e){return Ch.startStruct_(e),Ch.endStruct_(e)}visitUnion(t,e){vh.startTypeIdsVector(e,t.typeIds.length);const n=vh.createTypeIdsVector(e,t.typeIds);return vh.startUnion(e),vh.addMode(e,t.mode),vh.addTypeIds(e,n),vh.endUnion(e)}visitDictionary(t,e){const n=this.visit(t.indices,e);return gc.startDictionaryEncoding(e),gc.addId(e,new Ph(t.id,0)),gc.addIsOrdered(e,t.isOrdered),void 0!==n&&gc.addIndexType(e,n),gc.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return bh.startFixedSizeBinary(e),bh.addByteWidth(e,t.byteWidth),bh.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return gh.startFixedSizeList(e),gh.addListSize(e,t.listSize),gh.endFixedSizeList(e)}visitMap(t,e){return xh.startMap(e),xh.addKeysSorted(e,t.keysSorted),xh.endMap(e)}};function zh(t){return new Vh(t.count,Oh(t.columns),Fh(t.columns))}function Dh(t,e){return(t.children||[]).filter(Boolean).map((t=>Ml.fromJSON(t,e)))}function Oh(t){return(t||[]).reduce(((t,e)=>{return[...t,new Wh(e.count,(n=e.VALIDITY,(n||[]).reduce(((t,e)=>t+ +(0===e)),0))),...Oh(e.children)];var n}),[])}function Fh(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(let n=-1,i=(t||[]).length;++n<i;){const i=t[n];i.VALIDITY&&e.push(new $h(e.length,i.VALIDITY.length)),i.TYPE&&e.push(new $h(e.length,i.TYPE.length)),i.OFFSET&&e.push(new $h(e.length,i.OFFSET.length)),i.DATA&&e.push(new $h(e.length,i.DATA.length)),e=Fh(i.children,e)}return e}function Mh(t){return new Map(Object.entries(t||{}))}function Bh(t){return new va(t.isSigned,t.bitWidth)}function Eh(t,e){const n=t.type.name;switch(n){case"NONE":case"null":return new ya;case"binary":return new xa;case"utf8":return new wa;case"bool":return new _a;case"list":return new Pa((e||[])[0]);case"struct":case"struct_":return new ka(e||[])}switch(n){case"int":{const e=t.type;return new va(e.isSigned,e.bitWidth)}case"floatingpoint":{const e=t.type;return new ga(Wo[e.precision])}case"decimal":{const e=t.type;return new Sa(e.scale,e.precision,e.bitWidth)}case"date":{const e=t.type;return new Aa(qo[e.unit])}case"time":{const e=t.type;return new Ta(Go[e.unit],e.bitWidth)}case"timestamp":{const e=t.type;return new Ia(Go[e.unit],e.timezone)}case"interval":{const e=t.type;return new Ca(Ho[e.unit])}case"union":{const n=t.type;return new za($o[n.mode],n.typeIds||[],e||[])}case"fixedsizebinary":{const e=t.type;return new Da(e.byteWidth)}case"fixedsizelist":{const n=t.type;return new Oa(n.listSize,(e||[])[0])}case"map":{const n=t.type;return new Fa((e||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var Lh=lc,Nh=yc,jh=mc;class Rh{constructor(t,e,n,i){this._version=e,this._headerType=n,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength="number"===typeof t?t:t.low}static fromJSON(t,e){const n=new Rh(0,Uo.V4,e);return n._createHeader=function(t,e){return()=>{switch(e){case Yo.Schema:return Fl.fromJSON(t);case Yo.RecordBatch:return Vh.fromJSON(t);case Yo.DictionaryBatch:return Uh.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${Yo[e]}, type: ${e} }`)}}(t,e),n}static decode(t){t=new jh(Ms(t));const e=wh.getRootAsMessage(t),n=e.bodyLength(),i=e.version(),r=e.headerType(),o=new Rh(n,i,r);return o._createHeader=function(t,e){return()=>{switch(e){case Yo.Schema:return Fl.decode(t.header(new wc));case Yo.RecordBatch:return Vh.decode(t.header(new lh),t.version());case Yo.DictionaryBatch:return Uh.decode(t.header(new ch),t.version())}throw new Error(`Unrecognized Message type: { name: ${Yo[e]}, type: ${e} }`)}}(e,r),o}static encode(t){const e=new Nh;let n=-1;return t.isSchema()?n=Fl.encode(e,t.header()):t.isRecordBatch()?n=Vh.encode(e,t.header()):t.isDictionaryBatch()&&(n=Uh.encode(e,t.header())),wh.startMessage(e),wh.addVersion(e,Uo.V4),wh.addHeader(e,n),wh.addHeaderType(e,t.headerType),wh.addBodyLength(e,new Lh(t.bodyLength,0)),wh.finishMessageBuffer(e,wh.endMessage(e)),e.asUint8Array()}static from(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t instanceof Fl)return new Rh(0,Uo.V4,Yo.Schema,t);if(t instanceof Vh)return new Rh(e,Uo.V4,Yo.RecordBatch,t);if(t instanceof Uh)return new Rh(e,Uo.V4,Yo.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Yo.Schema}isRecordBatch(){return this.headerType===Yo.RecordBatch}isDictionaryBatch(){return this.headerType===Yo.DictionaryBatch}}class Vh{constructor(t,e,n){this._nodes=e,this._buffers=n,this._length="number"===typeof t?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class Uh{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._data=t,this._isDelta=n,this._id="number"===typeof e?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class $h{constructor(t,e){this.offset="number"===typeof t?t:t.low,this.length="number"===typeof e?e:e.low}}class Wh{constructor(t,e){this.length="number"===typeof t?t:t.low,this.nullCount="number"===typeof e?e:e.low}}function qh(t,e){const n=[];for(let i,r=-1,o=-1,s=t.childrenLength();++r<s;)(i=t.children(r))&&(n[++o]=Ml.decode(i,e));return n}function Gh(t){const e=new Map;if(t)for(let n,i,r=-1,o=Math.trunc(t.customMetadataLength());++r<o;)(n=t.customMetadata(r))&&null!=(i=n.key())&&e.set(i,n.value());return e}function Hh(t){return new va(t.isSigned(),t.bitWidth())}function Yh(t,e){const n=t.typeType();switch(n){case pc.NONE:case pc.Null:return new ya;case pc.Binary:return new xa;case pc.Utf8:return new wa;case pc.Bool:return new _a;case pc.List:return new Pa((e||[])[0]);case pc.Struct_:return new ka(e||[])}switch(n){case pc.Int:{const e=t.type(new bc);return new va(e.isSigned(),e.bitWidth())}case pc.FloatingPoint:{const e=t.type(new hh);return new ga(e.precision())}case pc.Decimal:{const e=t.type(new fh);return new Sa(e.scale(),e.precision(),e.bitWidth())}case pc.Date:{const e=t.type(new dh);return new Aa(e.unit())}case pc.Time:{const e=t.type(new ph);return new Ta(e.unit(),e.bitWidth())}case pc.Timestamp:{const e=t.type(new mh);return new Ia(e.unit(),e.timezone())}case pc.Interval:{const e=t.type(new yh);return new Ca(e.unit())}case pc.Union:{const n=t.type(new vh);return new za(n.mode(),n.typeIdsArray()||[],e||[])}case pc.FixedSizeBinary:{const e=t.type(new bh);return new Da(e.byteWidth())}case pc.FixedSizeList:{const n=t.type(new gh);return new Oa(n.listSize(),(e||[])[0])}case pc.Map:{const n=t.type(new xh);return new Fa((e||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${pc[n]}" (${n})`)}Ml.encode=function(t,e){let n=-1,i=-1,r=-1;const o=e.type;let s=e.typeId;ma.isDictionary(o)?(s=o.dictionary.typeId,r=kh.visit(o,t),i=kh.visit(o.dictionary,t)):i=kh.visit(o,t);const a=(o.children||[]).map((e=>Ml.encode(t,e))),u=xc.createChildrenVector(t,a),l=e.metadata&&e.metadata.size>0?xc.createCustomMetadataVector(t,[...e.metadata].map((e=>{let[n,i]=e;const r=t.createString(`${n}`),o=t.createString(`${i}`);return vc.startKeyValue(t),vc.addKey(t,r),vc.addValue(t,o),vc.endKeyValue(t)}))):-1;e.name&&(n=t.createString(e.name));xc.startField(t),xc.addType(t,i),xc.addTypeType(t,s),xc.addChildren(t,u),xc.addNullable(t,!!e.nullable),-1!==n&&xc.addName(t,n);-1!==r&&xc.addDictionary(t,r);-1!==l&&xc.addCustomMetadata(t,l);return xc.endField(t)},Ml.decode=function(t,e){let n,i,r,o,s,a;e&&(a=t.dictionary())?e.has(n=a.id().low)?(o=(o=a.indexType())?Hh(o):new ba,s=new Ea(e.get(n),o,n,a.isOrdered()),i=new Ml(t.name(),s,t.nullable(),Gh(t))):(o=(o=a.indexType())?Hh(o):new ba,e.set(n,r=Yh(t,qh(t,e))),s=new Ea(r,o,n,a.isOrdered()),i=new Ml(t.name(),s,t.nullable(),Gh(t))):(r=Yh(t,qh(t,e)),i=new Ml(t.name(),r,t.nullable(),Gh(t)));return i||null},Ml.fromJSON=function(t,e){let n,i,r,o,s,a;return e&&(o=t.dictionary)?e.has(n=o.id)?(i=(i=o.indexType)?Bh(i):new ba,a=new Ea(e.get(n),i,n,o.isOrdered),r=new Ml(t.name,a,t.nullable,Mh(t.customMetadata))):(i=(i=o.indexType)?Bh(i):new ba,e.set(n,s=Eh(t,Dh(t,e))),a=new Ea(s,i,n,o.isOrdered),r=new Ml(t.name,a,t.nullable,Mh(t.customMetadata))):(s=Eh(t,Dh(t,e)),r=new Ml(t.name,s,t.nullable,Mh(t.customMetadata))),r||null},Fl.encode=function(t,e){const n=e.fields.map((e=>Ml.encode(t,e)));wc.startFieldsVector(t,n.length);const i=wc.createFieldsVector(t,n),r=e.metadata&&e.metadata.size>0?wc.createCustomMetadataVector(t,[...e.metadata].map((e=>{let[n,i]=e;const r=t.createString(`${n}`),o=t.createString(`${i}`);return vc.startKeyValue(t),vc.addKey(t,r),vc.addValue(t,o),vc.endKeyValue(t)}))):-1;wc.startSchema(t),wc.addFields(t,i),wc.addEndianness(t,Xh?fc.Little:fc.Big),-1!==r&&wc.addCustomMetadata(t,r);return wc.endSchema(t)},Fl.decode=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;const n=function(t,e){const n=[];for(let i,r=-1,o=-1,s=t.fieldsLength();++r<s;)(i=t.fields(r))&&(n[++o]=Ml.decode(i,e));return n}(t,e);return new Fl(n,Gh(t),e)},Fl.fromJSON=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;return new Fl(function(t,e){return(t.fields||[]).filter(Boolean).map((t=>Ml.fromJSON(t,e)))}(t,e),Mh(t.customMetadata),e)},Vh.encode=function(t,e){const n=e.nodes||[],i=e.buffers||[];lh.startNodesVector(t,n.length);for(const s of n.slice().reverse())Wh.encode(t,s);const r=t.endVector();lh.startBuffersVector(t,i.length);for(const s of i.slice().reverse())$h.encode(t,s);const o=t.endVector();return lh.startRecordBatch(t),lh.addLength(t,new Lh(e.length,0)),lh.addNodes(t,r),lh.addBuffers(t,o),lh.endRecordBatch(t)},Vh.decode=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uo.V4;if(null!==t.compression())throw new Error("Record batch compression not implemented");return new Vh(t.length(),function(t){const e=[];for(let n,i=-1,r=-1,o=t.nodesLength();++i<o;)(n=t.nodes(i))&&(e[++r]=Wh.decode(n));return e}(t),function(t,e){const n=[];for(let i,r=-1,o=-1,s=t.buffersLength();++r<s;)(i=t.buffers(r))&&(e<Uo.V4&&(i.bb_pos+=8*(r+1)),n[++o]=$h.decode(i));return n}(t,e))},Vh.fromJSON=zh,Uh.encode=function(t,e){const n=Vh.encode(t,e.data);return ch.startDictionaryBatch(t),ch.addId(t,new Lh(e.id,0)),ch.addIsDelta(t,e.isDelta),ch.addData(t,n),ch.endDictionaryBatch(t)},Uh.decode=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Uo.V4;return new Uh(Vh.decode(t.data(),e),t.id(),t.isDelta())},Uh.fromJSON=function(t){return new Uh(zh(t.data),t.id,t.isDelta)},Wh.encode=function(t,e){return uh.createFieldNode(t,new Lh(e.length,0),new Lh(e.nullCount,0))},Wh.decode=function(t){return new Wh(t.length(),t.nullCount())},$h.encode=function(t,e){return ah.createBuffer(t,new Lh(e.offset,0),new Lh(e.length,0))},$h.decode=function(t){return new $h(t.offset(),t.length())};const Xh=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256===new Int16Array(t)[0]})(),Zh=t=>`Expected ${Yo[t]} Message in stream, but was null or length 0.`,Kh=t=>`Header pointer of flatbuffer-encoded ${Yo[t]} Message is null or length 0.`,Qh=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,Jh=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`;class tf{constructor(t){this.source=t instanceof Nc?t:new Nc(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||-1===t.value&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?Fc:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Zh(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=Ms(this.source.read(t));if(e.byteLength<t)throw new Error(Jh(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=Yo.Schema,n=this.readMessage(e),i=null===n||void 0===n?void 0:n.header();if(t&&!i)throw new Error(Kh(e));return i}readMetadataLength(){const t=this.source.read(rf),e=t&&new mc(t),n=(null===e||void 0===e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(t){const e=this.source.read(t);if(!e)return Fc;if(e.byteLength<t)throw new Error(Qh(t,e.byteLength));return{done:!1,value:Rh.decode(e)}}}class ef{constructor(t,e){this.source=t instanceof jc?t:ds(t)?new $c(t,e):new jc(t)}[Symbol.asyncIterator](){return this}next(){return gs(this,void 0,void 0,(function*(){let t;return(t=yield this.readMetadataLength()).done||-1===t.value&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?Fc:t}))}throw(t){return gs(this,void 0,void 0,(function*(){return yield this.source.throw(t)}))}return(t){return gs(this,void 0,void 0,(function*(){return yield this.source.return(t)}))}readMessage(t){return gs(this,void 0,void 0,(function*(){let e;if((e=yield this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Zh(t));return e.value}))}readMessageBody(t){return gs(this,void 0,void 0,(function*(){if(t<=0)return new Uint8Array(0);const e=Ms(yield this.source.read(t));if(e.byteLength<t)throw new Error(Jh(t,e.byteLength));return e.byteOffset%8===0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}))}readSchema(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return gs(this,void 0,void 0,(function*(){const e=Yo.Schema,n=yield this.readMessage(e),i=null===n||void 0===n?void 0:n.header();if(t&&!i)throw new Error(Kh(e));return i}))}readMetadataLength(){return gs(this,void 0,void 0,(function*(){const t=yield this.source.read(rf),e=t&&new mc(t),n=(null===e||void 0===e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}))}readMetadata(t){return gs(this,void 0,void 0,(function*(){const e=yield this.source.read(t);if(!e)return Fc;if(e.byteLength<t)throw new Error(Qh(t,e.byteLength));return{done:!1,value:Rh.decode(e)}}))}}class nf extends tf{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof Mc?t:new Mc(t)}next(){const{_json:t}=this;if(!this._schema){this._schema=!0;return{done:!1,value:Rh.fromJSON(t.schema,Yo.Schema)}}if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];this._body=e.data.columns;return{done:!1,value:Rh.fromJSON(e,Yo.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];this._body=e.columns;return{done:!1,value:Rh.fromJSON(e,Yo.RecordBatch)}}return this._body=[],Fc}readMessageBody(t){return function t(e){return(e||[]).reduce(((e,n)=>[...e,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE&&[n.TYPE]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...t(n.children)]),[])}(this._body)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Zh(t));return e.value}readSchema(){const t=Yo.Schema,e=this.readMessage(t),n=null===e||void 0===e?void 0:e.header();if(!e||!n)throw new Error(Kh(t));return n}}const rf=4,of="ARROW1",sf=new Uint8Array(6);for(let ed=0;ed<6;ed+=1)sf[ed]=of.codePointAt(ed);function af(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=-1,i=sf.length;++n<i;)if(sf[n]!==t[e+n])return!1;return!0}const uf=sf.length,lf=uf+rf,cf=2*uf+rf;class hf extends Bc{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return us(e)?e.then((()=>this)):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return kc.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return kc.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof hf?t:hs(t)?function(t){return new ff(new wf(t))}(t):ds(t)?function(t){return gs(this,void 0,void 0,(function*(){const{size:e}=yield t.stat(),n=new $c(t,e);return e>=cf&&af(yield n.readAt(0,uf+7&-8))?new mf(new xf(n)):new df(new bf(n))}))}(t):us(t)?(()=>gs(this,void 0,void 0,(function*(){return yield hf.from(yield t)})))():ps(t)||ys(t)||vs(t)||cs(t)?function(t){return gs(this,void 0,void 0,(function*(){const e=yield t.peek(uf+7&-8);return e&&e.byteLength>=4?af(e)?new pf(new gf(yield t.read())):new df(new bf(t)):new df(new bf(function(){return _s(this,arguments,(function*(){}))}()))}))}(new jc(t)):function(t){const e=t.peek(uf+7&-8);return e&&e.byteLength>=4?af(e)?new pf(new gf(t.read())):new ff(new vf(t)):new ff(new vf(function*(){}()))}(new Nc(t))}static readAll(t){return t instanceof hf?t.isSync()?Sf(t):Af(t):hs(t)||ArrayBuffer.isView(t)||ls(t)||fs(t)?Sf(t):Af(t)}}class ff extends hf{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return _s(this,arguments,(function*(){yield ws(yield*Ss(As(this[Symbol.iterator]())))}))}}class df extends hf{constructor(t){super(t),this._impl=t}readAll(){var t,e;return gs(this,void 0,void 0,(function*(){const n=new Array;try{for(var i,r=As(this);!(i=yield r.next()).done;){const t=i.value;n.push(t)}}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=r.return)&&(yield e.call(r))}finally{if(t)throw t.error}}return n}))}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class pf extends ff{constructor(t){super(t),this._impl=t}}class mf extends df{constructor(t){super(t),this._impl=t}}class yf{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Map;this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const n=this._loadVectors(t,e,this.schema.fields),i=Ol({type:new ka(this.schema.fields),length:t.length,children:n});return new Kl(this.schema,i)}_loadDictionaryBatch(t,e){const{id:n,isDelta:i}=t,{dictionaries:r,schema:o}=this,s=r.get(n);if(i||!s){const r=o.dictionaries.get(n),a=this._loadVectors(t.data,e,[r]);return(s&&i?s.concat(new Pl(a)):new Pl(a)).memoize()}return s.memoize()}_loadVectors(t,e,n){return new Zc(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}class vf extends yf{constructor(t,e){super(e),this._reader=hs(t)?new nf(this._handle=t):new tf(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=_f(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):Fc}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):Fc}next(){if(this.closed)return Fc;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),i=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),i=e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,r)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new tc(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class bf extends yf{constructor(t,e){super(e),this._reader=new ef(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return gs(this,void 0,void 0,(function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}))}open(t){return gs(this,void 0,void 0,(function*(){return this.closed||(this.autoDestroy=_f(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this}))}throw(t){return gs(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):Fc}))}return(t){return gs(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):Fc}))}next(){return gs(this,void 0,void 0,(function*(){if(this.closed)return Fc;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),i=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,i)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),i=yield e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(n,i);this.dictionaries.set(n.id,r)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new tc(this.schema)}):yield this.return()}))}_readNextMessageAndValidate(t){return gs(this,void 0,void 0,(function*(){return yield this._reader.readMessage(t)}))}}class gf extends vf{constructor(t,e){super(t instanceof Uc?t:new Uc(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(Yo.RecordBatch);if(null===t||void 0===t?void 0:t.isRecordBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}_readDictionaryBatch(t){var e;const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(Yo.DictionaryBatch);if(null===t||void 0===t?void 0:t.isDictionaryBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,i)}}}_readFooter(){const{_handle:t}=this,e=t.size-lf,n=t.readInt32(e),i=t.readAt(e-n,n);return Ic.decode(i)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}}class xf extends bf{constructor(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r="number"!==typeof n[0]?n.shift():void 0,o=n[0]instanceof Map?n.shift():void 0;super(t instanceof $c?t:new $c(t,r),o)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return gs(this,void 0,void 0,(function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)}))}readRecordBatch(t){var e;return gs(this,void 0,void 0,(function*(){if(this.closed)return null;this._footer||(yield this.open());const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(Yo.RecordBatch);if(null===t||void 0===t?void 0:t.isRecordBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}))}_readDictionaryBatch(t){var e;return gs(this,void 0,void 0,(function*(){const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(Yo.DictionaryBatch);if(null===t||void 0===t?void 0:t.isDictionaryBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,i)}}}))}_readFooter(){return gs(this,void 0,void 0,(function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-lf,n=yield t.readInt32(e),i=yield t.readAt(e-n,n);return Ic.decode(i)}))}_readNextMessageAndValidate(t){return gs(this,void 0,void 0,(function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null}))}}class wf extends vf{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new Kc(e,t.nodes,t.buffers,this.dictionaries).visitMany(n)}}function _f(t,e){return e&&"boolean"===typeof e.autoDestroy?e.autoDestroy:t.autoDestroy}function*Sf(t){const e=hf.from(t);try{if(!e.open({autoDestroy:!1}).closed)do{yield e}while(!e.reset().open().closed)}finally{e.cancel()}}function Af(t){return _s(this,arguments,(function*(){const e=yield ws(hf.from(t));try{if(!(yield ws(e.open({autoDestroy:!1}))).closed)do{yield yield ws(e)}while(!(yield ws(e.reset().open())).closed)}finally{yield ws(e.cancel())}}))}class Tf extends Na{constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}static assemble(){const t=e=>e.flatMap((e=>Array.isArray(e)?t(e):e instanceof Kl?e.data.children:e.data)),e=new Tf;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.visitMany(t(i)),e}visit(t){if(t instanceof Pl)return this.visitMany(t.data),this;const{type:e}=t;if(!ma.isDictionary(e)){const{length:n,nullCount:i}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");ma.isNull(e)||If.call(this,i<=0?new Uint8Array(0):al(t.offset,n,t.nullBitmap)),this.nodes.push(new Wh(n,i))}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function If(t){const e=t.byteLength+7&-8;return this.buffers.push(t),this.bufferRegions.push(new $h(this._byteLength,e)),this._byteLength+=e,this}function Cf(t){return If.call(this,t.values.subarray(0,t.length*t.stride))}function Pf(t){const{length:e,values:n,valueOffsets:i}=t,r=i[0],o=i[e],s=Math.min(o-r,n.byteLength-r);return If.call(this,Ns(-i[0],e,i)),If.call(this,n.subarray(r,r+s)),this}function kf(t){const{length:e,valueOffsets:n}=t;return n&&If.call(this,Ns(n[0],e,n)),this.visit(t.children[0])}function zf(t){return this.visitMany(t.type.children.map(((e,n)=>t.children[n])).filter(Boolean))[0]}Tf.prototype.visitBool=function(t){let e;return t.nullCount>=t.length?If.call(this,new Uint8Array(0)):(e=t.values)instanceof Uint8Array?If.call(this,al(t.offset,t.length,e)):If.call(this,ul(t.values))},Tf.prototype.visitInt=Cf,Tf.prototype.visitFloat=Cf,Tf.prototype.visitUtf8=Pf,Tf.prototype.visitBinary=Pf,Tf.prototype.visitFixedSizeBinary=Cf,Tf.prototype.visitDate=Cf,Tf.prototype.visitTimestamp=Cf,Tf.prototype.visitTime=Cf,Tf.prototype.visitDecimal=Cf,Tf.prototype.visitList=kf,Tf.prototype.visitStruct=zf,Tf.prototype.visitUnion=function(t){const{type:e,length:n,typeIds:i,valueOffsets:r}=t;if(If.call(this,i),e.mode===$o.Sparse)return zf.call(this,t);if(e.mode===$o.Dense){if(t.offset<=0)return If.call(this,r),zf.call(this,t);{const o=i.reduce(((t,e)=>Math.max(t,e)),i[0]),s=new Int32Array(o+1),a=new Int32Array(o+1).fill(-1),u=new Int32Array(n),l=Ns(-r[0],n,r);for(let t,e,r=-1;++r<n;)-1===(e=a[t=i[r]])&&(e=a[t]=l[t]),u[r]=l[r]-e,++s[t];If.call(this,u);for(let i,r=-1,c=e.children.length;++r<c;)if(i=t.children[r]){const t=e.typeIds[r],o=Math.min(n,s[t]);this.visit(i.slice(a[t],o))}}}return this},Tf.prototype.visitInterval=Cf,Tf.prototype.visitFixedSizeList=kf,Tf.prototype.visitMap=kf;class Df extends Bc{constructor(t){super(),this._position=0,this._started=!1,this._sink=new Lc,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,as(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!==typeof t.autoDestroy||t.autoDestroy,this._writeLegacyIpcFormat="boolean"===typeof t.writeLegacyIpcFormat&&t.writeLegacyIpcFormat}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}toString(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sink.toString(t)}toUint8Array(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sink.toUint8Array(t)}writeAll(t){return us(t)?t.then((t=>this.writeAll(t))):cs(t)?Bf(this,t):Mf(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._sink,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var n;return t===this._sink||t instanceof Lc?this._sink=t:(this._sink=new Lc,t&&(as(n=t)&&ss(n.abort)&&ss(n.getWriter)&&!ms(n))?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&(t=>as(t)&&ss(t.end)&&ss(t.write)&&os(t.writable)&&!ms(t))(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,e&&Yl(e,this._schema)||(null==e?(this._position=0,this._schema=null):(this._started=!0,this._schema=e,this._writeSchema(e))),this}write(t){let e=null;if(!this._sink)throw new Error("RecordBatchWriter is closed");if(null==t)return this.finish()&&void 0;if(t instanceof ic&&!(e=t.schema))return this.finish()&&void 0;if(t instanceof Kl&&!(e=t.schema))return this.finish()&&void 0;if(e&&!Yl(e,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,e)}t instanceof Kl?t instanceof tc||this._writeRecordBatch(t):t instanceof ic?this.writeAll(t.batches):ls(t)&&this.writeAll(t)}_writeMessage(t){const e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-1,n=Rh.encode(t),i=n.byteLength,r=this._writeLegacyIpcFormat?4:8,o=i+r+e&~e,s=o-i-r;return t.headerType===Yo.RecordBatch?this._recordBatchBlocks.push(new Pc(o,t.bodyLength,this._position)):t.headerType===Yo.DictionaryBatch&&this._dictionaryBlocks.push(new Pc(o,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(o-r)),i>0&&this._write(n),this._writePadding(s)}_write(t){if(this._started){const e=Ms(t);e&&e.byteLength>0&&(this._sink.write(e),this._position+=e.byteLength)}return this}_writeSchema(t){return this._writeMessage(Rh.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(sf)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:e,nodes:n,bufferRegions:i,buffers:r}=Tf.assemble(t),o=new Vh(t.numRows,n,i),s=Rh.from(o,e);return this._writeDictionaries(t)._writeMessage(s)._writeBodyBuffers(r)}_writeDictionaryBatch(t,e){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0));const{byteLength:i,nodes:r,bufferRegions:o,buffers:s}=Tf.assemble(new Pl([t])),a=new Vh(t.length,r,o),u=new Uh(a,e,n),l=Rh.from(u,i);return this._writeMessage(l)._writeBodyBuffers(s)}_writeBodyBuffers(t){let e,n,i;for(let r=-1,o=t.length;++r<o;)(e=t[r])&&(n=e.byteLength)>0&&(this._write(e),(i=(n+7&-8)-n)>0&&this._writePadding(i));return this}_writeDictionaries(t){for(let[e,n]of t.dictionaries){let t=this._dictionaryDeltaOffsets.get(e)||0;if(0===t||(n=null===n||void 0===n?void 0:n.slice(t)).length>0)for(const i of n.data)this._writeDictionaryBatch(i,e,t>0),t+=i.length}return this}}class Of extends Df{static writeAll(t,e){const n=new Of(e);return us(t)?t.then((t=>n.writeAll(t))):cs(t)?Bf(n,t):Mf(n,t)}}class Ff extends Df{static writeAll(t){const e=new Ff;return us(t)?t.then((t=>e.writeAll(t))):cs(t)?Bf(e,t):Mf(e,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){const e=Ic.encode(new Ic(t,Uo.V4,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(e)._write(Int32Array.of(e.byteLength))._writeMagic()}}function Mf(t,e){let n=e;e instanceof ic&&(n=e.batches,t.reset(void 0,e.schema));for(const i of n)t.write(i);return t.finish()}function Bf(t,e){var n,i,r,o;return gs(this,void 0,void 0,(function*(){try{for(n=As(e);!(i=yield n.next()).done;){const e=i.value;t.write(e)}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=n.return)&&(yield o.call(n))}finally{if(r)throw r.error}}return t.finish()}))}function Ef(t){const e=hf.from(t);return us(e)?e.then((t=>Ef(t))):e.isAsync()?e.readAll().then((t=>new ic(t))):new ic(e.readAll())}function Lf(t){return("stream"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"stream")?Of:Ff).writeAll(t).toUint8Array(!0)}var Nf,jf=function(){function t(t,e,n,i){var r=this;this.getCell=function(t,e){var n=t<r.headerRows&&e<r.headerColumns,i=t>=r.headerRows&&e<r.headerColumns,o=t<r.headerRows&&e>=r.headerColumns;if(n){var s=["blank"];return e>0&&s.push("level"+t),{type:"blank",classNames:s.join(" "),content:""}}if(o)return{type:"columns",classNames:(s=["col_heading","level"+t,"col"+(u=e-r.headerColumns)]).join(" "),content:r.getContent(r.columnsTable,u,t)};if(i){s=["row_heading","level"+e,"row"+(a=t-r.headerRows)];return{type:"index",id:"T_".concat(r.uuid,"level").concat(e,"_row").concat(a),classNames:s.join(" "),content:r.getContent(r.indexTable,a,e)}}s=["data","row"+(a=t-r.headerRows),"col"+(u=e-r.headerColumns)];var a,u,l=r.styler?r.getContent(r.styler.displayValuesTable,a,u):r.getContent(r.dataTable,a,u);return{type:"data",id:"T_".concat(r.uuid,"row").concat(a,"_col").concat(u),classNames:s.join(" "),content:l}},this.getContent=function(t,e,n){var i=t.getChildAt(n);return null===i?"":r.getColumnTypeId(t,n)===Xo.Timestamp?r.nanosToDate(i.get(e)):i.get(e)},this.dataTable=Ef(t),this.indexTable=Ef(e),this.columnsTable=Ef(n),this.styler=i?{caption:i.caption,displayValuesTable:Ef(i.displayValues),styles:i.styles,uuid:i.uuid}:void 0}return Object.defineProperty(t.prototype,"rows",{get:function(){return this.indexTable.numRows+this.columnsTable.numCols},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.indexTable.numCols+this.columnsTable.numRows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerRows",{get:function(){return this.rows-this.dataRows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"headerColumns",{get:function(){return this.columns-this.dataColumns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataRows",{get:function(){return this.dataTable.numRows},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataColumns",{get:function(){return this.dataTable.numCols},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uuid",{get:function(){return this.styler&&this.styler.uuid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"caption",{get:function(){return this.styler&&this.styler.caption},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return this.styler&&this.styler.styles},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"table",{get:function(){return this.dataTable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.indexTable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columnTable",{get:function(){return this.columnsTable},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return{data:Lf(this.dataTable),index:Lf(this.indexTable),columns:Lf(this.columnsTable)}},t.prototype.getColumnTypeId=function(t,e){return t.schema.fields[e].type.typeId},t.prototype.nanosToDate=function(t){return new Date(t/1e6)},t}(),Rf=function(){return Rf=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Rf.apply(this,arguments)};!function(t){t.COMPONENT_READY="streamlit:componentReady",t.SET_COMPONENT_VALUE="streamlit:setComponentValue",t.SET_FRAME_HEIGHT="streamlit:setFrameHeight"}(Nf||(Nf={}));var Vf=function(){function t(){}return t.API_VERSION=1,t.RENDER_EVENT="streamlit:render",t.events=new EventTarget,t.registeredMessageListener=!1,t.setComponentReady=function(){t.registeredMessageListener||(window.addEventListener("message",t.onMessageEvent),t.registeredMessageListener=!0),t.sendBackMsg(Nf.COMPONENT_READY,{apiVersion:t.API_VERSION})},t.setFrameHeight=function(e){void 0===e&&(e=document.body.scrollHeight),e!==t.lastFrameHeight&&(t.lastFrameHeight=e,t.sendBackMsg(Nf.SET_FRAME_HEIGHT,{height:e}))},t.setComponentValue=function(e){var n;e instanceof jf?(n="dataframe",e=e.serialize()):!function(t){var e=!1;try{e=t instanceof BigInt64Array||t instanceof BigUint64Array}catch(n){}return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array||e}(e)?e instanceof ArrayBuffer?(n="bytes",e=new Uint8Array(e)):n="json":(n="bytes",e=new Uint8Array(e.buffer)),t.sendBackMsg(Nf.SET_COMPONENT_VALUE,{value:e,dataType:n})},t.onMessageEvent=function(e){if(e.data.type===t.RENDER_EVENT)t.onRenderMessage(e.data)},t.onRenderMessage=function(e){var n=e.args;null==n&&(console.error("Got null args in onRenderMessage. This should never happen"),n={});var i=e.dfs&&e.dfs.length>0?t.argsDataframeToObject(e.dfs):{};n=Rf(Rf({},n),i);var r=Boolean(e.disabled),o=e.theme;o&&Uf(o);var s={disabled:r,args:n,theme:o},a=new CustomEvent(t.RENDER_EVENT,{detail:s});t.events.dispatchEvent(a)},t.argsDataframeToObject=function(e){var n=e.map((function(e){var n=e.key,i=e.value;return[n,t.toArrowTable(i)]}));return Object.fromEntries(n)},t.toArrowTable=function(t){var e,n=(e=t.data).data,i=e.index,r=e.columns,o=e.styler;return new jf(n,i,r,o)},t.sendBackMsg=function(t,e){window.parent.postMessage(Rf({isStreamlitMessage:!0,type:t},e),"*")},t}(),Uf=function(t){var e=document.createElement("style");document.head.appendChild(e),e.innerHTML="\n    :root {\n      --primary-color: ".concat(t.primaryColor,";\n      --background-color: ").concat(t.backgroundColor,";\n      --secondary-background-color: ").concat(t.secondaryBackgroundColor,";\n      --text-color: ").concat(t.textColor,";\n      --font: ").concat(t.font,";\n    }\n\n    body {\n      background-color: var(--background-color);\n      color: var(--text-color);\n    }\n  ")};var $f=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();!function(t){function e(){return null!==t&&t.apply(this,arguments)||this}$f(e,t),e.prototype.componentDidMount=function(){Vf.setFrameHeight()},e.prototype.componentDidUpdate=function(){Vf.setFrameHeight()}}(Ko.PureComponent);const Wf=document.body.appendChild(document.createElement("div"));Wf.className="app";const qf=document.body.appendChild(document.createElement("div"));let Gf;qf.className="actions";let Hf=!1,Yf=600;const Xf={spaceSize:4096,backgroundColor:"#151515",pointSize:4,pointColor:"#4B5BBF",pointGreyoutOpacity:.1,linkWidth:.01,linkColor:"#696969",linkArrows:!1,linkGreyoutOpacity:0,curvedLinks:!0,renderHoveredPointRing:!0,hoveredPointRingColor:"#4B5BBF",enableDrag:!0,simulationLinkDistance:1,simulationLinkSpring:2,simulationRepulsion:.2,simulationGravity:.1,simulationDecay:1e5,fitViewOnInit:!0,onClick:(t,e,n)=>{if(Hf=!0,console.log("clicking  ",Hf),void 0!==t){Gf.selectPointByIndex(t);var i=Gf.getAdjacentIndices(t)||[];const e={node:t,neighbor:i};Vf.setComponentValue(e),null===i||void 0===i||i.push(t),Gf.selectPointsByIndices(i),Gf.zoomToPointByIndex(t),Gf.fitViewByPointIndices(i)}else console.log("unselecting index"),Gf.unselectPoints();console.log("Clicked point index: ",t)}};Gf=new class{constructor(t,e){this.config=new di,this.graph=new Mi(this.config),this.requestAnimationFrameId=0,this.isRightClickMouse=!1,this.store=new mo,this.zoomInstance=new Ro(this.store,this.config),this.dragInstance=new Vo(this.store,this.config),this._findHoveredPointExecutionCount=0,this._isMouseOnCanvas=!1,this._isFirstRenderAfterInit=!0,this._hasPointPositionsChanged=!1,this._hasPointColorsChanged=!1,this._hasPointSizesChanged=!1,this._hasLinksChanged=!1,this._hasLinkColorsChanged=!1,this._hasLinkWidthsChanged=!1,this._hasLinkArrowsChanged=!1,this._hasPointClustersChanged=!1,this._hasClusterPositionsChanged=!1,this._hasPointClusterForceChanged=!1,e&&this.config.init(e),this.store.div=t;const n=document.createElement("canvas");n.style.width="100%",n.style.height="100%",this.store.div.appendChild(n),this.addAttribution();const i=n.clientWidth,r=n.clientHeight;n.width=i*this.config.pixelRatio,n.height=r*this.config.pixelRatio,this.canvas=n,this.reglInstance=Pn({canvas:this.canvas,attributes:{antialias:!1,preserveDrawingBuffer:!0},extensions:["OES_texture_float","ANGLE_instanced_arrays"]}),this.store.adjustSpaceSize(this.config.spaceSize,this.reglInstance.limits.maxTextureSize),this.store.updateScreenSize(i,r),this.canvasD3Selection=mt(this.canvas),this.canvasD3Selection.on("mouseenter.cosmos",(()=>{this._isMouseOnCanvas=!0})).on("mousemove.cosmos",(()=>{this._isMouseOnCanvas=!0})).on("mouseleave.cosmos",(()=>{this._isMouseOnCanvas=!1})),mt(document).on("keydown.cosmos",(t=>{"Space"===t.code&&(this.store.isSpaceKeyPressed=!0)})).on("keyup.cosmos",(t=>{"Space"===t.code&&(this.store.isSpaceKeyPressed=!1)})),this.zoomInstance.behavior.on("start.detect",(t=>{this.currentEvent=t})).on("zoom.detect",(t=>{!!t.sourceEvent&&this.updateMousePosition(t.sourceEvent),this.currentEvent=t})).on("end.detect",(t=>{this.currentEvent=t})),this.dragInstance.behavior.on("start.detect",(t=>{this.currentEvent=t,this.updateCanvasCursor()})).on("drag.detect",(t=>{this.dragInstance.isActive&&this.updateMousePosition(t),this.currentEvent=t})).on("end.detect",(t=>{this.currentEvent=t,this.updateCanvasCursor()})),this.canvasD3Selection.call(this.dragInstance.behavior).call(this.zoomInstance.behavior).on("click",this.onClick.bind(this)).on("mousemove",this.onMouseMove.bind(this)).on("contextmenu",this.onRightClickMouse.bind(this)),(this.config.disableZoom||!this.config.enableDrag)&&this.updateZoomDragBehaviors(),this.setZoomLevel(this.config.initialZoomLevel??1),this.store.maxPointSize=(this.reglInstance.limits.pointSizeDims[1]??64)/this.config.pixelRatio,this.points=new Tr(this.reglInstance,this.config,this.store,this.graph),this.lines=new Ar(this.reglInstance,this.config,this.store,this.graph,this.points),this.config.disableSimulation||(this.forceGravity=new wi(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceCenter=new xi(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceManyBody=this.config.useQuadtree?new Pi(this.reglInstance,this.config,this.store,this.graph,this.points):new Ii(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceLinkIncoming=new Si(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceLinkOutgoing=new Si(this.reglInstance,this.config,this.store,this.graph,this.points),this.forceMouse=new ki(this.reglInstance,this.config,this.store,this.graph,this.points),this.clusters=new zi(this.reglInstance,this.config,this.store,this.graph,this.points)),this.store.backgroundColor=ci(this.config.backgroundColor),this.config.hoveredPointRingColor&&this.store.setHoveredPointRingColor(this.config.hoveredPointRingColor),this.config.focusedPointRingColor&&this.store.setFocusedPointRingColor(this.config.focusedPointRingColor),void 0!==this.config.focusedPointIndex&&this.store.setFocusedPoint(this.config.focusedPointIndex),this.config.showFPSMonitor&&(this.fpsMonitor=new Fi(this.canvas)),void 0!==this.config.randomSeed&&this.store.addRandomSeed(this.config.randomSeed)}get progress(){return this.store.simulationProgress}get isSimulationRunning(){return this.store.isSimulationRunning}get maxPointSize(){return this.store.maxPointSize}setConfig(t){var e;const n={...this.config};this.config.init(t),n.pointColor!==this.config.pointColor&&(this.graph.updatePointColor(),this.points.updateColor()),n.pointSize!==this.config.pointSize&&(this.graph.updatePointSize(),this.points.updateSize()),n.linkColor!==this.config.linkColor&&(this.graph.updateLinkColor(),this.lines.updateColor()),n.linkWidth!==this.config.linkWidth&&(this.graph.updateLinkWidth(),this.lines.updateWidth()),n.linkArrows!==this.config.linkArrows&&(this.graph.updateArrows(),this.lines.updateArrow()),(n.curvedLinkSegments!==this.config.curvedLinkSegments||n.curvedLinks!==this.config.curvedLinks)&&this.lines.updateCurveLineGeometry(),n.backgroundColor!==this.config.backgroundColor&&(this.store.backgroundColor=ci(this.config.backgroundColor)),n.hoveredPointRingColor!==this.config.hoveredPointRingColor&&this.store.setHoveredPointRingColor(this.config.hoveredPointRingColor),n.focusedPointRingColor!==this.config.focusedPointRingColor&&this.store.setFocusedPointRingColor(this.config.focusedPointRingColor),n.focusedPointIndex!==this.config.focusedPointIndex&&this.store.setFocusedPoint(this.config.focusedPointIndex),(n.spaceSize!==this.config.spaceSize||n.simulationRepulsionQuadtreeLevels!==this.config.simulationRepulsionQuadtreeLevels)&&(this.store.adjustSpaceSize(this.config.spaceSize,this.reglInstance.limits.maxTextureSize),this.resizeCanvas(!0),this.update(this.store.isSimulationRunning?this.store.alpha:0)),n.showFPSMonitor!==this.config.showFPSMonitor&&(this.config.showFPSMonitor?this.fpsMonitor=new Fi(this.canvas):(null==(e=this.fpsMonitor)||e.destroy(),this.fpsMonitor=void 0)),n.pixelRatio!==this.config.pixelRatio&&(this.store.maxPointSize=(this.reglInstance.limits.pointSizeDims[1]??64)/this.config.pixelRatio),(n.disableZoom!==this.config.disableZoom||n.enableDrag!==this.config.enableDrag)&&this.updateZoomDragBehaviors()}setPointPositions(t){this.graph.inputPointPositions=t,this._hasPointPositionsChanged=!0}setPointColors(t){this.graph.inputPointColors=t,this._hasPointColorsChanged=!0}setPointSizes(t){this.graph.inputPointSizes=t,this._hasPointSizesChanged=!0}setLinks(t){this.graph.inputLinks=t,this._hasLinksChanged=!0}setLinkColors(t){this.graph.inputLinkColors=t,this._hasLinkColorsChanged=!0}setLinkWidths(t){this.graph.inputLinkWidths=t,this._hasLinkWidthsChanged=!0}setLinkArrows(t){this.graph.linkArrowsBoolean=t,this._hasLinkArrowsChanged=!0}setLinkStrength(t){this.graph.inputLinkStrength=t}setPointClusters(t){this.graph.inputPointClusters=t,this._hasPointClustersChanged=!0}setClusterPositions(t){this.graph.inputClusterPositions=t,this._hasClusterPositionsChanged=!0}setPointClusterStrength(t){this.graph.inputClusterStrength=t,this._hasPointClusterForceChanged=!0}render(t){this.graph.update();const{fitViewOnInit:e,fitViewDelay:n,fitViewPadding:i,fitViewDuration:r,fitViewByPointsInRect:o,initialZoomLevel:s}=this.config;if(!this.graph.pointsNumber&&!this.graph.linksNumber)return this.stopFrames(),mt(this.canvas).style("cursor",null),void this.reglInstance.clear({color:this.store.backgroundColor,depth:1,stencil:0});this._isFirstRenderAfterInit&&e&&void 0===s&&(this._fitViewOnInitTimeoutID=window.setTimeout((()=>{o?this.setZoomTransformByPointPositions(o,r,void 0,i):this.fitView(r,i)}),n)),this._isFirstRenderAfterInit=!1,this.update(t)}zoomToPointByIndex(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:700,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{store:{screenSize:r}}=this,o=hi(this.reglInstance,this.points.currentPositionFbo);if(void 0===t)return;const s=o[4*t+0],a=o[4*t+1];if(void 0===s||void 0===a)return;const u=this.zoomInstance.getDistanceToPoint([s,a]),l=i?n:Math.max(this.getZoomLevel(),n);if(u<Math.min(r[0],r[1]))this.setZoomTransformByPointPositions([s,a],e,l);else{const t=this.zoomInstance.getTransform([[s,a]],l),n=this.zoomInstance.getMiddlePointTransform([s,a]);this.canvasD3Selection.transition().ease(gn).duration(e/2).call(this.zoomInstance.behavior.transform,n).transition().ease(xn).duration(e/2).call(this.zoomInstance.behavior.transform,t)}}zoom(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.setZoomLevel(t,e)}setZoomLevel(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===e?this.canvasD3Selection.call(this.zoomInstance.behavior.scaleTo,t):this.canvasD3Selection.transition().duration(e).call(this.zoomInstance.behavior.scaleTo,t)}getZoomLevel(){return this.zoomInstance.eventTransform.k}getPointPositions(){if(void 0===this.graph.pointsNumber)return[];const t=[],e=hi(this.reglInstance,this.points.currentPositionFbo);t.length=2*this.graph.pointsNumber;for(let n=0;n<this.graph.pointsNumber;n+=1){const i=e[4*n+0],r=e[4*n+1];void 0!==i&&void 0!==r&&(t[2*n]=i,t[2*n+1]=r)}return t}getClusterPositions(){if(void 0===this.graph.pointClusters||void 0===this.clusters)return[];const t=[],e=hi(this.reglInstance,this.clusters.centermassFbo);t.length=e.length/2;for(let n=0;n<t.length/2;n+=1){const i=e[4*n+0],r=e[4*n+1],o=e[4*n+2];void 0!==i&&void 0!==r&&void 0!==o&&(t[2*n]=i/o,t[2*n+1]=r/o)}return t}fitView(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;this.setZoomTransformByPointPositions(this.getPointPositions(),t,void 0,e)}fitViewByPointIndices(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;const i=this.getPointPositions(),r=new Array(2*t.length);for(const[o,s]of t.entries())r[2*o]=i[2*s],r[2*o+1]=i[2*s+1];this.setZoomTransformByPointPositions(r,e,void 0,n)}fitViewByPointPositions(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;this.setZoomTransformByPointPositions(t,e,void 0,n)}getPointsInRange(t){const e=this.store.screenSize[1];return this.store.selectedArea=[[t[0][0],e-t[1][1]],[t[1][0],e-t[0][1]]],this.points.findPointsOnAreaSelection(),hi(this.reglInstance,this.points.selectedFbo).map(((t,e)=>e%4===0&&0!==t?e/4:-1)).filter((t=>-1!==t))}selectPointsInRange(t){if(t){const e=this.store.screenSize[1];this.store.selectedArea=[[t[0][0],e-t[1][1]],[t[1][0],e-t[0][1]]],this.points.findPointsOnAreaSelection();const n=hi(this.reglInstance,this.points.selectedFbo);this.store.selectedIndices=n.map(((t,e)=>e%4===0&&0!==t?e/4:-1)).filter((t=>-1!==t))}else this.store.selectedIndices=null;this.points.updateGreyoutStatus()}selectPointByIndex(t){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){const e=this.graph.getAdjacentIndices(t)??[];this.selectPointsByIndices([t,...e])}else this.selectPointsByIndices([t])}selectPointsByIndices(t){t?0===t.length?this.store.selectedIndices=new Float32Array:this.store.selectedIndices=new Float32Array(t.filter((t=>void 0!==t))):this.store.selectedIndices=null,this.points.updateGreyoutStatus()}unselectPoints(){this.store.selectedIndices=null,this.points.updateGreyoutStatus()}getSelectedIndices(){const{selectedIndices:t}=this.store;return t?Array.from(t):null}getAdjacentIndices(t){return this.graph.getAdjacentIndices(t)}setFocusedPointByIndex(t){void 0===this.config.focusedPointIndex&&(void 0===t?this.store.setFocusedPoint():this.store.setFocusedPoint(t))}spaceToScreenPosition(t){return this.zoomInstance.convertSpaceToScreenPosition(t)}screenToSpacePosition(t){return this.zoomInstance.convertScreenToSpacePosition(t)}spaceToScreenRadius(t){return this.zoomInstance.convertSpaceToScreenRadius(t)}getPointRadiusByIndex(t){var e;return null==(e=this.graph.pointSizes)?void 0:e[t]}trackPointPositionsByIndices(t){this.points.trackPointsByIndices(t)}getTrackedPointPositionsMap(){return this.points.getTrackedPositionsMap()}getSampledPointPositionsMap(){return this.points.getSampledPointPositionsMap()}getScaleX(){return this.points.scaleX}getScaleY(){return this.points.scaleY}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;var e,n;this.graph.pointsNumber&&(this.store.isSimulationRunning=!0,this.store.alpha=t,this.store.simulationProgress=0,null==(n=(e=this.config).onSimulationStart)||n.call(e),this.stopFrames(),this.frame())}pause(){var t,e;this.store.isSimulationRunning=!1,null==(e=(t=this.config).onSimulationPause)||e.call(t)}restart(){var t,e;this.store.isSimulationRunning=!0,null==(e=(t=this.config).onSimulationRestart)||e.call(t)}step(){this.store.isSimulationRunning=!1,this.stopFrames(),this.frame()}destroy(){var t,e;window.clearTimeout(this._fitViewOnInitTimeoutID),this.stopFrames(),this.reglInstance.destroy(),this.reglInstance.clear({color:this.store.backgroundColor,depth:1,stencil:0}),mt(this.canvas).style("cursor",null),null==(t=this.fpsMonitor)||t.destroy(),null==(e=document.getElementById("gl-bench-style"))||e.remove()}create(){var t,e,n,i,r;this._hasPointPositionsChanged&&this.points.updatePositions(),this._hasPointColorsChanged&&this.points.updateColor(),this._hasPointSizesChanged&&this.points.updateSize(),(this._hasLinksChanged||this._hasPointPositionsChanged)&&this.lines.updatePointsBuffer(),this._hasLinkColorsChanged&&this.lines.updateColor(),this._hasLinkWidthsChanged&&this.lines.updateWidth(),this._hasLinkArrowsChanged&&this.lines.updateArrow(),this.lines.updateCurveLineGeometry(),null==(t=this.forceManyBody)||t.create(),null==(e=this.forceLinkIncoming)||e.create(_i.INCOMING),null==(n=this.forceLinkOutgoing)||n.create(_i.OUTGOING),null==(i=this.forceCenter)||i.create(),(this._hasPointClustersChanged||this._hasClusterPositionsChanged||this._hasPointClusterForceChanged)&&(null==(r=this.clusters)||r.create()),this._hasPointPositionsChanged=!1,this._hasPointColorsChanged=!1,this._hasPointSizesChanged=!1,this._hasLinksChanged=!1,this._hasLinkColorsChanged=!1,this._hasLinkWidthsChanged=!1,this._hasLinkArrowsChanged=!1,this._hasPointClustersChanged=!1,this._hasClusterPositionsChanged=!1,this._hasPointClusterForceChanged=!1}flatten(t){return t.flat()}pair(t){const e=new Array(t.length/2);for(let n=0;n<t.length/2;n++)e[n]=[t[2*n],t[2*n+1]];return e}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.store.alpha;const{graph:e}=this;this.store.pointsTextureSize=Math.ceil(Math.sqrt(e.pointsNumber??0)),this.store.linksTextureSize=Math.ceil(Math.sqrt(2*(e.linksNumber??0))),this.create(),this.initPrograms(),this.store.setFocusedPoint(this.config.focusedPointIndex),this.store.hoveredPoint=void 0,this.start(t)}initPrograms(){var t,e,n,i,r,o,s;this.points.initPrograms(),this.lines.initPrograms(),null==(t=this.forceGravity)||t.initPrograms(),null==(e=this.forceLinkIncoming)||e.initPrograms(),null==(n=this.forceLinkOutgoing)||n.initPrograms(),null==(i=this.forceMouse)||i.initPrograms(),null==(r=this.forceManyBody)||r.initPrograms(),null==(o=this.forceCenter)||o.initPrograms(),null==(s=this.clusters)||s.initPrograms()}frame(){const{config:{simulationGravity:t,simulationCenter:e,renderLinks:n,disableSimulation:i},store:{alpha:r,isSimulationRunning:o}}=this;r<po&&o&&this.end(),this.store.pointsTextureSize&&(this.requestAnimationFrameId=window.requestAnimationFrame((r=>{var s,a,u,l,c,h,f,d,p,m,y,v,b;null==(s=this.fpsMonitor)||s.begin(),this.resizeCanvas(),this.dragInstance.isActive||this.findHoveredPoint(),i||(this.isRightClickMouse&&(o||this.start(.1),null==(a=this.forceMouse)||a.run(),this.points.updatePosition()),o&&!(this.zoomInstance.isRunning&&!this.config.enableSimulationDuringZoom)&&(t&&(null==(u=this.forceGravity)||u.run(),this.points.updatePosition()),e&&(null==(l=this.forceCenter)||l.run(),this.points.updatePosition()),null==(c=this.forceManyBody)||c.run(),this.points.updatePosition(),this.store.linksTextureSize&&(null==(h=this.forceLinkIncoming)||h.run(),this.points.updatePosition(),null==(f=this.forceLinkOutgoing)||f.run(),this.points.updatePosition()),(this.graph.pointClusters||this.graph.clusterPositions)&&(null==(d=this.clusters)||d.run(),this.points.updatePosition()),this.store.alpha+=this.store.addAlpha(this.config.simulationDecay??Yn.decay),this.isRightClickMouse&&(this.store.alpha=Math.max(this.store.alpha,.1)),this.store.simulationProgress=Math.sqrt(Math.min(1,po/this.store.alpha)),null==(v=(y=this.config).onSimulationTick)||v.call(y,this.store.alpha,null==(p=this.store.hoveredPoint)?void 0:p.index,null==(m=this.store.hoveredPoint)?void 0:m.position)),this.points.trackPoints()),this.reglInstance.clear({color:this.store.backgroundColor,depth:1,stencil:0}),n&&this.store.linksTextureSize&&this.lines.draw(),this.points.draw(),this.dragInstance.isActive&&(this.points.drag(),this.points.drag()),null==(b=this.fpsMonitor)||b.end(r),this.currentEvent=void 0,this.frame()})))}stopFrames(){this.requestAnimationFrameId&&window.cancelAnimationFrame(this.requestAnimationFrameId)}end(){var t,e;this.store.isSimulationRunning=!1,this.store.simulationProgress=1,null==(e=(t=this.config).onSimulationEnd)||e.call(t)}onClick(t){var e,n,i,r;null==(r=(i=this.config).onClick)||r.call(i,null==(e=this.store.hoveredPoint)?void 0:e.index,null==(n=this.store.hoveredPoint)?void 0:n.position,t)}updateMousePosition(t){if(!t)return;const e=t.offsetX??t.x,n=t.offsetY??t.y;void 0===e||void 0===n||(this.store.mousePosition=this.zoomInstance.convertScreenToSpacePosition([e,n]),this.store.screenMousePosition=[e,this.store.screenSize[1]-n])}onMouseMove(t){var e,n,i,r;this.currentEvent=t,this.updateMousePosition(t),this.isRightClickMouse=3===t.which,null==(r=(i=this.config).onMouseMove)||r.call(i,null==(e=this.store.hoveredPoint)?void 0:e.index,null==(n=this.store.hoveredPoint)?void 0:n.position,this.currentEvent)}onRightClickMouse(t){t.preventDefault()}resizeCanvas(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const e=this.canvas.width,n=this.canvas.height,i=this.canvas.clientWidth,r=this.canvas.clientHeight;if(t||e!==i*this.config.pixelRatio||n!==r*this.config.pixelRatio){const[t,e]=this.store.screenSize,{k:n}=this.zoomInstance.eventTransform,o=this.zoomInstance.convertScreenToSpacePosition([t/2,e/2]);this.store.updateScreenSize(i,r),this.canvas.width=i*this.config.pixelRatio,this.canvas.height=r*this.config.pixelRatio,this.reglInstance.poll(),this.canvasD3Selection.call(this.zoomInstance.behavior.transform,this.zoomInstance.getTransform([o],n)),this.points.updateSampledPointsGrid()}}setZoomTransformByPointPositions(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.resizeCanvas();const r=this.zoomInstance.getTransform(this.pair(t),n,i);this.canvasD3Selection.transition().ease(wn).duration(e).call(this.zoomInstance.behavior.transform,r)}updateZoomDragBehaviors(){this.config.enableDrag?this.canvasD3Selection.call(this.dragInstance.behavior):this.canvasD3Selection.call(this.dragInstance.behavior).on(".drag",null),this.config.disableZoom?this.canvasD3Selection.call(this.zoomInstance.behavior).on("wheel.zoom",null):this.canvasD3Selection.call(this.zoomInstance.behavior)}findHoveredPoint(){var t,e,n,i,r;if(!this._isMouseOnCanvas)return;if(this._findHoveredPointExecutionCount<2)return void(this._findHoveredPointExecutionCount+=1);this._findHoveredPointExecutionCount=0,this.points.findHoveredPoint();let o=!1,s=!1;const a=hi(this.reglInstance,this.points.hoveredFbo);if(a[1]){const e=a[0];(null==(t=this.store.hoveredPoint)?void 0:t.index)!==e&&(o=!0);const n=a[2],i=a[3];this.store.hoveredPoint={index:e,position:[n,i]}}else this.store.hoveredPoint&&(s=!0),this.store.hoveredPoint=void 0;o&&this.store.hoveredPoint&&(null==(n=(e=this.config).onPointMouseOver)||n.call(e,this.store.hoveredPoint.index,this.store.hoveredPoint.position,this.currentEvent)),s&&(null==(r=(i=this.config).onPointMouseOut)||r.call(i,this.currentEvent)),this.updateCanvasCursor()}updateCanvasCursor(){const{hoveredPointCursor:t}=this.config;this.dragInstance.isActive?mt(this.canvas).style("cursor","grabbing"):this.store.hoveredPoint?!this.config.enableDrag||this.store.isSpaceKeyPressed?mt(this.canvas).style("cursor",t):mt(this.canvas).style("cursor","grab"):mt(this.canvas).style("cursor",null)}addAttribution(){var t;if(this.config.disableAttribution)return;this.attributionDivElement=document.createElement("div"),this.attributionDivElement.style.cssText="\n      cursor: pointer;\n      user-select: none;\n      position: absolute;\n      margin: 0 0.6rem 0.6rem 0;\n      line-height: 0;\n      bottom: 0;\n      right: 0;\n      color: var(--cosmos-attribution-color);\n    ",this.attributionDivElement.onclick=()=>{var t;return null==(t=window.open("https://cosmograph.app/","_blank"))?void 0:t.focus()};const e=(new DOMParser).parseFromString('<svg clip-rule="evenodd" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" viewBox="0 0 151 11" xmlns="http://www.w3.org/2000/svg" xmlns:bx="https://boxy-svg.com" width="151px" height="11px"><defs/><clipPath id="a"><path clip-rule="evenodd" d="m0 0h163v11h-163z"/></clipPath><g transform="scale(.920956 1)"><path d="m0 0h163v11h-163z" fill="none"/><g clip-path="url(#a)"><g fill="currentColor" transform="matrix(1.08583 0 0 1 -14.1352 -16.2014)"><g fill-rule="nonzero"><path d="m.22 0h.096l.182-.486h-.064l-.16.44h-.012l-.16-.44h-.064z" transform="matrix(12 0 0 12 12.5618 24.8014)"/><path d="m.118-.57c.03 0 .052-.022.052-.052s-.022-.052-.052-.052-.052.022-.052.052.022.052.052.052zm-.03.57h.06v-.486h-.06z" transform="matrix(12 0 0 12 18.5138 24.8014)"/><path d="m.281.014c.118 0 .193-.052.193-.144s-.078-.124-.177-.141l-.046-.008c-.069-.012-.112-.032-.112-.086s.047-.083.121-.083.128.029.141.106l.056-.012c-.018-.095-.087-.146-.197-.146s-.181.051-.181.135.07.123.163.139l.046.008c.076.013.126.03.126.088s-.053.092-.133.092-.153-.034-.168-.14l-.059.011c.018.129.109.181.227.181z" transform="matrix(12 0 0 12 20.8658 24.8014)"/><path d="m.275.01c.104 0 .154-.048.178-.1h.012v.09h.058v-.486h-.06v.243c0 .133-.075.199-.175.199-.089 0-.147-.044-.147-.15v-.292h-.06v.296c0 .134.089.2.194.2z" transform="matrix(12 0 0 12 26.7218 24.8014)"/><path d="m.237.014c.1 0 .144-.045.17-.09h.01v.007c0 .043.026.069.067.069h.064v-.052h-.047c-.018 0-.028-.01-.028-.03v-.236c0-.114-.071-.182-.193-.182-.121 0-.187.068-.21.153l.058.017c.017-.07.066-.116.152-.116.087 0 .133.047.133.125v.039h-.178c-.101 0-.18.048-.18.145s.079.151.182.151zm.004-.054c-.074 0-.126-.035-.126-.098 0-.062.052-.092.121-.092h.177v.012c0 .113-.069.178-.172.178z" transform="matrix(12 0 0 12 33.5738 24.8014)"/><path d="m.088-.7h.06v.7h-.06z" transform="matrix(12 0 0 12 39.9818 24.8014)"/><path d="m.118-.57c.03 0 .052-.022.052-.052s-.022-.052-.052-.052-.052.022-.052.052.022.052.052.052zm-.03.57h.06v-.486h-.06z" transform="matrix(12 0 0 12 42.3338 24.8014)"/><path d="m.064 0h.396v-.054h-.336v-.01l.328-.34v-.082h-.378v.054h.317v.01l-.327.34z" transform="matrix(12 0 0 12 44.6858 24.8014)"/><path d="m.312.014c.129 0 .186-.071.217-.137l-.054-.024c-.027.06-.072.107-.163.107-.107 0-.184-.069-.188-.19h.414v-.032c0-.148-.097-.238-.233-.238-.14 0-.241.102-.241.251v.012c0 .149.098.251.248.251zm-.187-.296c.014-.105.083-.164.18-.164.098 0 .167.059.172.164z" transform="matrix(12 0 0 12 50.1818 24.8014)"/><path d="m.298.014c.107 0 .162-.05.19-.103h.012v.089h.058v-.7h-.06v.299h-.012c-.026-.049-.081-.099-.188-.099-.131 0-.234.097-.234.251v.012c0 .155.104.251.234.251zm.014-.054c-.11 0-.186-.075-.186-.199v-.008c0-.124.076-.199.186-.199s.186.075.186.199v.008c0 .124-.076.199-.186.199z" transform="matrix(12 0 0 12 56.8778 24.8014)"/><path d="m.168 0h.105l.125-.446h.012l.125.446h.105l.11-.486h-.062l-.096.446h-.012l-.125-.446h-.102l-.125.446h-.012l-.096-.446h-.062z" transform="matrix(12 0 0 12 66.7658 24.8014)"/><path d="m.118-.57c.03 0 .052-.022.052-.052s-.022-.052-.052-.052-.052.022-.052.052.022.052.052.052zm-.03.57h.06v-.486h-.06z" transform="matrix(12 0 0 12 75.9818 24.8014)"/><path d="m.264 0h.126v-.054h-.114c-.022 0-.03-.01-.03-.03v-.348h.17v-.054h-.17v-.182h-.06v.182h-.156v.054h.156v.356c0 .048.026.076.078.076z" transform="matrix(12 0 0 12 78.3338 24.8014)"/><path d="m.088 0h.06v-.243c0-.133.075-.198.175-.198.089 0 .147.043.147.149v.292h.06v-.296c0-.134-.089-.199-.194-.199-.104 0-.152.047-.176.094h-.012v-.299h-.06z" transform="matrix(12 0 0 12 83.3978 24.8014)"/><path d="m.334.014c.162 0 .251-.098.251-.255v-.013h-.064v.015c0 .115-.059.195-.187.195-.13 0-.206-.082-.206-.225v-.162c0-.143.076-.225.206-.225.128 0 .187.08.187.195v.007h.064v-.005c0-.157-.089-.255-.251-.255-.164 0-.27.098-.27.285v.158c0 .187.106.285.27.285z" transform="matrix(12 0 0 12 92.8778 24.8014)"/><path d="m.31.014c.148 0 .246-.101.246-.251v-.012c0-.15-.098-.251-.246-.251s-.246.101-.246.251v.012c0 .15.098.251.246.251zm0-.054c-.114 0-.186-.079-.186-.199v-.008c0-.12.072-.199.186-.199s.186.079.186.199v.008c0 .12-.072.199-.186.199z" transform="matrix(12 0 0 12 100.09 24.8014)"/><path d="m.281.014c.118 0 .193-.052.193-.144s-.078-.124-.177-.141l-.046-.008c-.069-.012-.112-.032-.112-.086s.047-.083.121-.083.128.029.141.106l.056-.012c-.018-.095-.087-.146-.197-.146s-.181.051-.181.135.07.123.163.139l.046.008c.076.013.126.03.126.088s-.053.092-.133.092-.153-.034-.168-.14l-.059.011c.018.129.109.181.227.181z" transform="matrix(12 0 0 12 107.05 24.8014)"/><path d="m.088 0h.06v-.295c0-.096.059-.147.136-.147.076 0 .12.046.12.115v.327h.06v-.295c0-.096.059-.147.136-.147.076 0 .12.046.12.115v.327h.06v-.333c0-.097-.067-.163-.166-.163-.087 0-.132.041-.154.092h-.012c-.022-.05-.07-.092-.148-.092-.082 0-.122.038-.142.074h-.012v-.064h-.058z" transform="matrix(12 0 0 12 112.906 24.8014)"/><path d="m.31.014c.148 0 .246-.101.246-.251v-.012c0-.15-.098-.251-.246-.251s-.246.101-.246.251v.012c0 .15.098.251.246.251zm0-.054c-.114 0-.186-.079-.186-.199v-.008c0-.12.072-.199.186-.199s.186.079.186.199v.008c0 .12-.072.199-.186.199z" transform="matrix(12 0 0 12 122.77 24.8014)"/><path d="m.064-.241c0 .152.103.247.234.247.107 0 .162-.05.188-.099h.012v.209c0 .02-.009.03-.031.03h-.32v.054h.332c.052 0 .077-.028.077-.076v-.61h-.056v.089h-.012c-.028-.053-.083-.103-.19-.103-.13 0-.234.094-.234.247zm.248.193c-.11 0-.186-.073-.186-.195v-.008c0-.122.076-.195.186-.195s.186.073.186.195v.008c0 .122-.076.195-.186.195z" transform="matrix(12 0 0 12 129.73 24.8014)"/><path d="m.088 0h.06v-.304c0-.088.047-.128.121-.128h.064v-.056h-.057c-.065 0-.1.019-.118.063h-.012v-.061h-.058z" transform="matrix(12 0 0 12 136.978 24.8014)"/><path d="m.237.014c.1 0 .144-.045.17-.09h.01v.007c0 .043.026.069.067.069h.064v-.052h-.047c-.018 0-.028-.01-.028-.03v-.236c0-.114-.071-.182-.193-.182-.121 0-.187.068-.21.153l.058.017c.017-.07.066-.116.152-.116.087 0 .133.047.133.125v.039h-.178c-.101 0-.18.048-.18.145s.079.151.182.151zm.004-.054c-.074 0-.126-.035-.126-.098 0-.062.052-.092.121-.092h.177v.012c0 .113-.069.178-.172.178z" transform="matrix(12 0 0 12 140.698 24.8014)"/><path d="m.088.2h.06v-.285h.012c.026.049.081.099.188.099.131 0 .234-.097.234-.251v-.012c0-.155-.104-.251-.234-.251-.107 0-.162.05-.19.103h-.012v-.089h-.058zm.246-.24c-.11 0-.186-.075-.186-.199v-.008c0-.124.076-.199.186-.199s.186.075.186.199v.008c0 .124-.076.199-.186.199z" transform="matrix(12 0 0 12 147.106 24.8014)"/><path d="m.088 0h.06v-.243c0-.133.075-.198.175-.198.089 0 .147.043.147.149v.292h.06v-.296c0-.134-.089-.199-.194-.199-.104 0-.152.047-.176.094h-.012v-.299h-.06z" transform="matrix(12 0 0 12 154.378 24.8014)"/></g><path d="m92.878 26.001h68.844v.6h-68.844z"/></g></g></g></svg>',"image/svg+xml").firstChild;this.attributionDivElement.appendChild(e),null==(t=this.store.div)||t.appendChild(this.attributionDivElement)}}(Wf,Xf);let Zf=!1;const Kf=qf.appendChild(document.createElement("button"));Kf.textContent="Pause",Kf.addEventListener("click",(function(){Zf?td():Jf()}));const Qf=qf.appendChild(document.createElement("button"));function Jf(){Zf=!0,Kf.textContent="Start",Gf.pause()}function td(){Zf=!1,Kf.textContent="Pause",Gf.start()}Qf.textContent="fitView",Qf.addEventListener("click",(function(){Gf.fitView()})),Vf.events.addEventListener(Vf.RENDER_EVENT,(function(t){const e=t.detail;console.log("receving data",e);const n=e.args.nodes,i=e.args.links,r=e.args.colors,o=e.args.configs,s=o.simulation;Yf=o.frameHeight||600,Object.assign(Xf,o),Gf.setPointPositions(n),Gf.setLinks(i),Gf.setPointColors(r),Gf.render(),Gf.setConfig(Xf),Jf(),!1!==s&&(console.log("starting simulation"),td()),setTimeout((()=>{Gf.fitView(250,.1)}),800),Vf.setFrameHeight(Yf)})),Vf.setComponentReady(),Vf.setFrameHeight(Yf)})();
//# sourceMappingURL=main.2bd4c3be.js.map